fch2py not found. Interface with fch is disabled. Install MOKIT if you need that.
Warning: lo/auto_pair not found. Orbital localization is disabled. Install MOKIT if you need that.
Warning: pyphf not found. SUHF is disabled. Install ExSCF if you need that.
#INFO: **** input file is /home/wsr/pyAutoMR/examples/39-CASSCFsymm.py ****
from pyscf import lib
from automr import guess, autocas

lib.num_threads(4)

xyz = 'N 0.0 0.0 0.0; N  0.0 0.0 1.9' #sys.argv[1]
#fch = 'n2.fchk' #sys.argv[2]
bas = 'cc-pvdz'

mf = guess.from_frag(xyz, bas, [[0],[1]], [0,0], [3,-3], cycle=50)
mf = guess.check_stab(mf)

mf2 = autocas.cas(mf, symmetry='D2h')

#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='yoga', release='5.10.16.3-microsoft-standard-WSL2', version='#1 SMP Fri Apr 2 22:23:49 UTC 2021', machine='x86_64', processor='x86_64')  Threads 4
Python 3.6.15 (default, Sep 23 2021, 15:41:43) [GCC]
numpy 1.17.3  scipy 1.3.3
Date: Thu Jan 27 18:31:10 2022
PySCF version 2.0.1
PySCF path  /home/wsr/pyscf
GIT HEAD (branch master) f1ec3c1786b236cf63c5d16e85dd579d6567f9b3

[ENV] PYSCF_EXT_PATH /home/wsr/gvb:
[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 14
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 N      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 N      0.000000000000   0.000000000000   1.900000000000 AA    0.000000000000   0.000000000000   3.590479636674 Bohr

nuclear repulsion = 13.6472017553053
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:         0.27
**** generating fragment guess ****
fragments: [('N', [0.0, 0.0, 0.0])] [('N', [0.0, 0.0, 1.9])]
converged SCF energy = -54.3911145621998  <S^2> = 3.7540306  2S+1 = 4.0020148
converged SCF energy = -54.3911145621998  <S^2> = 3.7540306  2S+1 = 4.0020148
       na   nb
atom1   5    2
atom2   2    5
Frag guess orb alpha
             #0      #1      #2      #3      #4      #5     
  0 N 1s       1.002                                        
  0 N 2s               0.546                                
  0 N 3s               0.535                                
  0 N 2px                              0.630  -0.256        
  0 N 2py                      0.575   0.170   0.324        
  0 N 2pz                     -0.363   0.197   0.542        
  0 N 3px                              0.423  -0.172        
  0 N 3py                      0.387   0.114   0.217        
  0 N 3pz                     -0.244   0.132   0.364        
  1 N 1s                                               1.000
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                       0.637        
  0 N 2s                                       1.566        
  0 N 3s                                      -1.560        
  0 N 2px              0.235  -0.921                        
  0 N 2py                             -0.950                
  0 N 2pz             -0.923  -0.239                        
  0 N 3px             -0.266   1.042                        
  0 N 3py                              1.075                
  0 N 3pz              1.044   0.271                        
  0 N 3dyz                                             0.979
  0 N 3dz^2                                            0.142
  0 N 3dxz                                            -0.144
  1 N 2s       0.445                                        
  1 N 3s       0.633                                        
             #12     #13     #14     #15     #16     #17    
  0 N 3dxy             0.940  -0.295  -0.168                
  0 N 3dyz     0.152                  -0.121                
  0 N 3dz^2                   -0.607   0.777                
  0 N 3dxz     0.979          -0.120                        
 0 N 3dx2-y2   0.108   0.330   0.726   0.594                
  1 N 2px                                      0.357  -0.122
  1 N 2py                                      0.249   0.187
  1 N 2pz                                              0.374
  1 N 3px                                      0.575  -0.196
  1 N 3py                                      0.401   0.301
  1 N 3pz                                              0.603
             #18     #19     #20     #21     #22     #23    
  1 N 1s                                       0.640        
  1 N 2s                                       1.597        
  1 N 3s                                      -1.523        
  1 N 2px     -0.217   0.847   0.675   0.111                
  1 N 2py      0.304  -0.667   0.855  -0.103                
  1 N 2pz     -0.223  -0.151           1.078                
  1 N 3px     -0.351  -0.731  -0.582                        
  1 N 3py      0.490   0.575  -0.737                        
  1 N 3pz     -0.359   0.130          -0.930                
  1 N 3dxy                                            -0.682
  1 N 3dyz                                             0.686
  1 N 3dxz                                            -0.226
 1 N 3dx2-y2                                          -0.118
             #24     #25     #26     #27    
  1 N 3dxy    -0.154  -0.415           0.583
  1 N 3dyz     0.161  -0.260           0.660
  1 N 3dz^2                    0.998        
  1 N 3dxz     0.974                        
 1 N 3dx2-y2           0.870           0.473
Frag guess orb beta
             #0      #1      #2      #3      #4      #5     
  0 N 1s       1.000                                        
  0 N 2s               0.445                                
  0 N 3s               0.633                                
  1 N 1s                       1.002                        
  1 N 2s                               0.546                
  1 N 3s                               0.535                
  1 N 2px                                      0.605   0.310
  1 N 2py                                     -0.288   0.592
  1 N 2pz                                     -0.126   0.133
  1 N 3px                                      0.406   0.208
  1 N 3py                                     -0.194   0.398
             #6      #7      #8      #9      #10     #11    
  0 N 2px             -0.212   0.371           0.796  -0.726
  0 N 2py              0.369   0.224                  -0.129
  0 N 2pz                              0.424   0.737   0.801
  0 N 3px             -0.342   0.598  -0.130  -0.687   0.626
  0 N 3py              0.594   0.361                   0.111
  0 N 3pz             -0.146           0.683  -0.636  -0.691
  1 N 2py     -0.175                                        
  1 N 2pz      0.656                                        
  1 N 3py     -0.118                                        
  1 N 3pz      0.441                                        
             #12     #13     #14     #15     #16     #17    
  0 N 1s               0.640                                
  0 N 2s               1.597                                
  0 N 3s              -1.523                                
  0 N 2px     -0.160                                        
  0 N 2py      1.077                                        
  0 N 3px      0.138                                        
  0 N 3py     -0.929                                        
  0 N 3dxy                                             0.775
  0 N 3dyz                     0.332   0.922  -0.194        
  0 N 3dz^2                            0.197   0.978        
  0 N 3dxz                     0.942  -0.326                
 0 N 3dx2-y2                                          -0.631
             #18     #19     #20     #21     #22     #23    
  0 N 3dxy     0.628                                        
 0 N 3dx2-y2   0.772                                        
  1 N 1s                                       0.637        
  1 N 2s                                       1.566        
  1 N 3s                                      -1.560        
  1 N 2px             -0.847   0.166  -0.407                
  1 N 2py              0.439   0.270  -0.803                
  1 N 2pz                     -0.900  -0.316                
  1 N 3px              0.958  -0.188   0.461                
  1 N 3py             -0.497  -0.305   0.908                
  1 N 3pz                      1.018   0.357                
  1 N 3dxy                                            -0.179
  1 N 3dyz                                             0.905
  1 N 3dxz                                            -0.374
             #24     #25     #26     #27    
  1 N 3dxy             0.953  -0.236        
  1 N 3dyz     0.390   0.157                
  1 N 3dz^2                            0.999
  1 N 3dxz     0.918  -0.132                
 1 N 3dx2-y2           0.224   0.968        


******** <class 'pyscf.scf.uhf.UHF'> ********
method = UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/wsr/pyAutoMR/examples/tmpnzczth70
max_memory 4000 MB (current use 74 MB)
number electrons alpha = 7  beta = 7
Set gradient conv threshold to 3.16228e-05
init E= -108.900143275272
  alpha nocc = 7  HOMO = -0.476464499402214  LUMO = 0.166732176142526
  beta  nocc = 7  HOMO = -0.476464499402215  LUMO = 0.166732176142524
cycle= 1 E= -108.762288631731  delta_E= 0.138  |g|= 0.0527  |ddm|= 0.373
  alpha nocc = 7  HOMO = -0.530330642057185  LUMO = 0.162348570448286
  beta  nocc = 7  HOMO = -0.530330642057184  LUMO = 0.162348570448286
cycle= 2 E= -108.765642733546  delta_E= -0.00335  |g|= 0.0253  |ddm|= 0.0587
  alpha nocc = 7  HOMO = -0.529049671912867  LUMO = 0.159261512802589
  beta  nocc = 7  HOMO = -0.529049671912869  LUMO = 0.159261512802593
cycle= 3 E= -108.767085606679  delta_E= -0.00144  |g|= 0.0126  |ddm|= 0.0548
  alpha nocc = 7  HOMO = -0.528710372834685  LUMO = 0.156378931797936
  beta  nocc = 7  HOMO = -0.52871037283468  LUMO = 0.156378931797929
cycle= 4 E= -108.767469881852  delta_E= -0.000384  |g|= 0.00324  |ddm|= 0.0393
  alpha nocc = 7  HOMO = -0.527321353128727  LUMO = 0.156905650680723
  beta  nocc = 7  HOMO = -0.52732135312873  LUMO = 0.156905650680732
cycle= 5 E= -108.767488344339  delta_E= -1.85e-05  |g|= 0.000626  |ddm|= 0.0078
  alpha nocc = 7  HOMO = -0.527670443529383  LUMO = 0.156831110667583
  beta  nocc = 7  HOMO = -0.527670443529379  LUMO = 0.156831110667579
cycle= 6 E= -108.767488867958  delta_E= -5.24e-07  |g|= 0.000143  |ddm|= 0.00108
  alpha nocc = 7  HOMO = -0.527603375860155  LUMO = 0.156896336092538
  beta  nocc = 7  HOMO = -0.527603375860158  LUMO = 0.156896336092542
cycle= 7 E= -108.767488893983  delta_E= -2.6e-08  |g|= 4.93e-05  |ddm|= 0.000239
  alpha nocc = 7  HOMO = -0.527650705153183  LUMO = 0.156872500788271
  beta  nocc = 7  HOMO = -0.527650705153181  LUMO = 0.156872500788271
cycle= 8 E= -108.767488898007  delta_E= -4.02e-09  |g|= 1.06e-05  |ddm|= 9.2e-05
  alpha nocc = 7  HOMO = -0.527658756971631  LUMO = 0.156874706934978
  beta  nocc = 7  HOMO = -0.527658756971636  LUMO = 0.156874706934976
cycle= 9 E= -108.76748889822  delta_E= -2.14e-10  |g|= 1.78e-06  |ddm|= 2.85e-05
  alpha nocc = 7  HOMO = -0.527658437248191  LUMO = 0.156874663133352
  beta  nocc = 7  HOMO = -0.527658437248189  LUMO = 0.156874663133352
Extra cycle  E= -108.767488898223  delta_E= -2.27e-12  |g|= 6.81e-07  |ddm|= 2.47e-06
converged SCF energy = -108.767488898223  <S^2> = 2.6423741  2S+1 = 3.4013963
time for guess: 0.119
**** checking UHF/UKS internal stability ...
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 2.36  e= [2.251294]  max|de|= 2.25  lindep= 0.69
davidson 1 2  |r|= 1.23  e= [1.337185]  max|de|= -0.914  lindep= 0.854
davidson 2 3  |r|= 0.349  e= [0.746039]  max|de|= -0.591  lindep= 0.99
davidson 3 4  |r|= 0.31  e= [0.599626]  max|de|= -0.146  lindep= 0.955
davidson 4 5  |r|= 0.126  e= [0.547809]  max|de|= -0.0518  lindep= 0.987
davidson 5 6  |r|= 0.0489  e= [0.541019]  max|de|= -0.00679  lindep= 0.94
davidson 6 7  |r|= 0.0307  e= [0.539492]  max|de|= -0.00153  lindep= 0.916
davidson 7 8  |r|= 0.0241  e= [0.538631]  max|de|= -0.000861  lindep= 0.939
davidson 8 9  |r|= 0.0453  e= [0.537536]  max|de|= -0.00109  lindep= 0.958
davidson 9 10  |r|= 0.0297  e= [0.53616]  max|de|= -0.00138  lindep= 0.955
davidson 10 11  |r|= 0.0291  e= [0.535363]  max|de|= -0.000797  lindep= 0.946
davidson 11 12  |r|= 0.042  e= [0.534617]  max|de|= -0.000746  lindep= 0.873
davidson 12 1  |r|= 0.042  e= [0.534617]  max|de|= -6.66e-16  lindep= 0.999
davidson 13 2  |r|= 0.0222  e= [0.534247]  max|de|= -0.00037  lindep= 0.835
davidson 14 3  |r|= 0.0145  e= [0.534004]  max|de|= -0.000242  lindep= 0.956
davidson 15 4  |r|= 0.0148  e= [0.533811]  max|de|= -0.000194  lindep= 0.905
davidson 16 5  |r|= 0.0102  e= [0.533698]  max|de|= -0.000113  lindep= 0.932
root 0 converged  |r|= 0.00764  e= 0.5336394847227246  max|de|= -5.86e-05
converged 17 6  |r|= 0.00764  e= [0.533639]  max|de|= -5.86e-05
UHF/UKS wavefunction is stable in the internal stability analysis
UNO ON: [ 2.        2.        1.999103  1.997838  1.550306  1.174501  1.174501  0.825499  0.825499  0.449694  0.002162  0.000897  0.        0.        0.
  0.        0.        0.        0.        0.        0.        0.       -0.       -0.       -0.       -0.       -0.       -0.      ]
nacto, nacta, nactb: 6 3 3
Converting <class 'pyscf.scf.uhf.UHF'> to RHF
UNO in active space
             #0      #1      #2      #3      #4      #5     
  0 N 3s                                               0.184
  0 N 2px             -0.373  -0.266  -0.160  -0.481        
  0 N 2py              0.266  -0.373  -0.481   0.160        
  0 N 2pz     -0.442                                   0.565
  0 N 3px             -0.255  -0.182  -0.106  -0.319        
  0 N 3py              0.182  -0.255  -0.319   0.106        
  0 N 3pz     -0.295                                   0.390
  1 N 3s                                              -0.184
  1 N 2px             -0.373  -0.266   0.160   0.481        
  1 N 2py              0.266  -0.373   0.481  -0.160        
  1 N 2pz      0.442                                   0.565
  1 N 3px             -0.255  -0.182   0.106   0.319        
  1 N 3py              0.182  -0.255   0.319  -0.106        
  1 N 3pz      0.295                                   0.390

******** <class 'pyscf.mcscf.mc1step_symm.SymAdaptedCASSCF'> ********
CAS (3e+3e, 6o), ncore = 4, nvir = 18
max_cycle_macro = 200
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 1e-08
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /home/wsr/pyAutoMR/examples/tmpnzczth70
max_memory 1000 MB (current use 75 MB)
internal_rotation = False
******** <class 'pyscf.fci.direct_spin1_symm.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-08
davidson only = True
linear dependence = 1e-10
level shift = 0.001
max iter space = 12
max_memory 1000 MB
nroots = 1
pspace_size = 0
spin = 0
CI wfn symmetry = None

WARN: mc1step_symm symmetrizes input orbitals

Active space CI wfn symmetry = Ag
CASCI E = -108.799475958848  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter 1 (12 JK  4 micro), CASSCF E = -108.800824508572  dE = -0.0013485497  S^2 = 0.0000001
               |grad[o]|=0.0392  |grad[c]|= 0.001663964026957427  |ddm|=0.0464
macro iter 2 (6 JK  2 micro), CASSCF E = -108.800824782618  dE = -2.740455e-07  S^2 = 0.0000000
               |grad[o]|=0.000654  |grad[c]|= 2.21381378461122e-05  |ddm|=0.000234
macro iter 3 (1 JK  1 micro), CASSCF E = -108.800824782796  dE = -1.7772095e-10  S^2 = 0.0000000
               |grad[o]|=1.74e-05  |grad[c]|= 8.539874955974103e-06  |ddm|=2.9e-05
1-step CASSCF converged in 3 macro (19 JK 7 micro) steps
CASSCF canonicalization
Natural occ [1.733016 1.391517 1.391519 0.608475 0.608476 0.266997]
Natural orbital (expansion on meta-Lowdin AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 N 1s      -0.00133   0.00000   0.00000   0.00000   0.00000
  0 N 2s      -0.01193   0.00000   0.00000   0.00000   0.00000
  0 N 3s       0.01739   0.00000   0.00000   0.00000   0.00000
  0 N 2px      0.00000   0.70631   0.00000   0.00000   0.70705
  0 N 2py     -0.00000   0.00000   0.70631   0.70705  -0.00000
  0 N 2pz     -0.70628  -0.00000  -0.00000   0.00000  -0.00000
  0 N 3px     -0.00000   0.03089  -0.00000  -0.00000   0.00685
  0 N 3py     -0.00000   0.00000   0.03089   0.00685  -0.00000
  0 N 3pz     -0.01652   0.00000  -0.00000   0.00000   0.00000
  0 N 3dxy     0.00000   0.00000  -0.00000   0.00000  -0.00000
  0 N 3dyz    -0.00000   0.00000   0.01326   0.00517  -0.00000
  0 N 3dz^2   -0.02129   0.00000   0.00000   0.00000   0.00000
  0 N 3dxz    -0.00000   0.01326  -0.00000  -0.00000   0.00517
 0 N 3dx2-y2   0.00000   0.00000   0.00000  -0.00000   0.00000
  1 N 1s      -0.00133   0.00000   0.00000   0.00000   0.00000
  1 N 2s      -0.01193  -0.00000   0.00000   0.00000   0.00000
  1 N 3s       0.01739  -0.00000  -0.00000  -0.00000   0.00000
  1 N 2px      0.00000   0.70631   0.00000   0.00000  -0.70705
  1 N 2py     -0.00000   0.00000   0.70631  -0.70705   0.00000
  1 N 2pz      0.70628  -0.00000   0.00000   0.00000   0.00000
  1 N 3px     -0.00000   0.03089  -0.00000  -0.00000  -0.00685
  1 N 3py      0.00000  -0.00000   0.03089  -0.00685   0.00000
  1 N 3pz      0.01652   0.00000   0.00000   0.00000  -0.00000
  1 N 3dxy     0.00000   0.00000  -0.00000   0.00000   0.00000
  1 N 3dyz     0.00000   0.00000  -0.01326   0.00517  -0.00000
  1 N 3dz^2   -0.02129   0.00000  -0.00000  -0.00000   0.00000
  1 N 3dxz     0.00000  -0.01326   0.00000   0.00000   0.00517
 1 N 3dx2-y2   0.00000  -0.00000  -0.00000  -0.00000  -0.00000
               #6       
  0 N 1s      -0.00005
  0 N 2s       0.14317
  0 N 3s       0.01456
  0 N 2px     -0.00000
  0 N 2py     -0.00000
  0 N 2pz      0.69230
  0 N 3px      0.00000
  0 N 3py      0.00000
  0 N 3pz     -0.00216
  0 N 3dxy    -0.00000
  0 N 3dyz     0.00000
  0 N 3dz^2    0.00155
  0 N 3dxz     0.00000
 0 N 3dx2-y2  -0.00000
  1 N 1s       0.00005
  1 N 2s      -0.14317
  1 N 3s      -0.01456
  1 N 2px     -0.00000
  1 N 2py     -0.00000
  1 N 2pz      0.69230
  1 N 3px      0.00000
  1 N 3py      0.00000
  1 N 3pz     -0.00216
  1 N 3dxy    -0.00000
  1 N 3dyz    -0.00000
  1 N 3dz^2   -0.00155
  1 N 3dxz    -0.00000
 1 N 3dx2-y2   0.00000
<CAS-nat-orb|mo-hf>  5  5    0.99930050
<CAS-nat-orb|mo-hf>  6  6   -0.81455585
<CAS-nat-orb|mo-hf>  6  7   -0.57998658
<CAS-nat-orb|mo-hf>  7  6    0.57998658
<CAS-nat-orb|mo-hf>  7  7   -0.81455586
<CAS-nat-orb|mo-hf>  8  8   -0.94900818
<CAS-nat-orb|mo-hf>  9  9   -0.94900825
<CAS-nat-orb|mo-hf>  10  10    0.99954886
CASSCF energy = -108.800824782796
CASCI E = -108.800824782796  E(CI) = -9.66807609934691  S^2 = 0.0000000
Natrual Orbs
             #0      #1      #2      #3      #4      #5     
  0 N 3s                                               0.184
  0 N 2px             -0.373  -0.266  -0.160  -0.481        
  0 N 2py              0.266  -0.373  -0.481   0.160        
  0 N 2pz     -0.442                                   0.565
  0 N 3px             -0.255  -0.182  -0.106  -0.319        
  0 N 3py              0.182  -0.255  -0.319   0.106        
  0 N 3pz     -0.295                                   0.390
  1 N 3s                                              -0.184
  1 N 2px             -0.373  -0.266   0.160   0.481        
  1 N 2py              0.266  -0.373   0.481  -0.160        
  1 N 2pz      0.442                                   0.565
  1 N 3px             -0.255  -0.182   0.106   0.319        
  1 N 3py              0.182  -0.255   0.319  -0.106        
  1 N 3pz      0.295                                   0.390
***** CI components ROOT 0 ******
 c**2   Gaussian-type vector
 0.406423  111000 
 0.117314  101010 
 0.117314  110100 
 0.047997  100110 
 0.040416  1baab0 
 0.040416  1abba0 
 0.025725  011001 
 0.016044  1baba0 
 0.016044  1abab0 
 0.014108  010101 
 0.014108  001011 
 0.011759  000111 
 0.010349  ab10ba 
 0.010349  ba10ab 
 0.010349  b1aa0b 
 0.010349  a1bb0a 
 c**2     ORCA-type vector
 0.406423  222000 
 0.117314  202020 
 0.117314  220200 
 0.112920  211110 
 0.047997  200220 
 0.025725  022002 
 0.020698  112011 
 0.020698  121101 
 0.014108  020202 
 0.014108  002022 
 0.011759  000222 
