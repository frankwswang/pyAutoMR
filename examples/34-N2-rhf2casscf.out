#INFO: **** input file is /share/home/srwang/pyAutoMR/examples/34-N2-rhf2casscf.py ****
from pyscf import lib
#from pyphf import util, guess
import guess, autocas, cidump

lib.num_threads(4)

xyz = 'N 0.0 0.0 0.0; N  0.0 0.0 1.0' #sys.argv[1]
#fch = 'n2.fchk' #sys.argv[2]
bas = 'cc-pvdz'

mf = guess.gen(xyz, bas, 0, 0)
#guess.check_stab(mf)

mf2 = autocas.cas(mf)
cidump.dump(mf2)

#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='xn01', release='3.10.0-1127.el7.x86_64', version='#1 SMP Tue Feb 18 16:39:12 EST 2020', machine='x86_64', processor='x86_64')  Threads 4
Python 3.7.4 (default, Aug 13 2019, 20:35:49) 
[GCC 7.3.0]
numpy 1.17.2  scipy 1.4.1
Date: Mon Jun 28 21:19:23 2021
PySCF version 1.7.6a1
PySCF path  /share/home/srwang/pyscf/pyscf
GIT HEAD      ref: refs/heads/master
GIT master branch  80f71dfe77ac5f9caae26788acf76446987635bd

[CONFIG] conf_file /share/home/srwang/.pyscf_conf.py
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 14
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 N      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 N      0.000000000000   0.000000000000   1.000000000000 AA    0.000000000000   0.000000000000   1.889726124565 Bohr

nuclear repulsion = 25.92968333508
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:         0.45


******** <class 'pyscf.scf.uhf.UHF'> ********
method = UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/tmpo1pespn0
max_memory 4000 MB (current use 77 MB)
number electrons alpha = 7  beta = 7
Set gradient conv threshold to 3.16228e-05
init E= -109.61478689215
  alpha nocc = 7  HOMO = -0.336428140621994  LUMO = 0.17467334374441
  beta  nocc = 7  HOMO = -0.336714739018985  LUMO = 0.172494301161526
cycle= 1 E= -108.904880014795  delta_E= 0.71  |g|= 0.233  |ddm|= 1.29
  alpha nocc = 7  HOMO = -0.669230029626957  LUMO = 0.18949415602277
  beta  nocc = 7  HOMO = -0.667681006521139  LUMO = 0.189754781635444
cycle= 2 E= -108.928474943897  delta_E= -0.0236  |g|= 0.0538  |ddm|= 0.191
  alpha nocc = 7  HOMO = -0.627321566262797  LUMO = 0.233622751407841
  beta  nocc = 7  HOMO = -0.626606798345333  LUMO = 0.233682338322246
cycle= 3 E= -108.929788237688  delta_E= -0.00131  |g|= 0.00875  |ddm|= 0.043
  alpha nocc = 7  HOMO = -0.634092466548873  LUMO = 0.230199640720315
  beta  nocc = 7  HOMO = -0.633939557016633  LUMO = 0.230164994403081
cycle= 4 E= -108.929838011582  delta_E= -4.98e-05  |g|= 0.000734  |ddm|= 0.0117
  alpha nocc = 7  HOMO = -0.633563074273877  LUMO = 0.230669717688168
  beta  nocc = 7  HOMO = -0.633517151666934  LUMO = 0.23065514443041
cycle= 5 E= -108.92983836929  delta_E= -3.58e-07  |g|= 0.000135  |ddm|= 0.000916
  alpha nocc = 7  HOMO = -0.633584589464488  LUMO = 0.230665624975561
  beta  nocc = 7  HOMO = -0.633576802618515  LUMO = 0.230662545466003
cycle= 6 E= -108.929838385334  delta_E= -1.6e-08  |g|= 1.82e-05  |ddm|= 0.000233
  alpha nocc = 7  HOMO = -0.633578392814275  LUMO = 0.230666899804039
  beta  nocc = 7  HOMO = -0.633577600315601  LUMO = 0.230666546758028
cycle= 7 E= -108.929838385604  delta_E= -2.7e-10  |g|= 2.51e-06  |ddm|= 7.42e-05
  alpha nocc = 7  HOMO = -0.633578721524861  LUMO = 0.23066584656641
  beta  nocc = 7  HOMO = -0.633578418821173  LUMO = 0.230665708737946
Extra cycle  E= -108.929838385609  delta_E= -4.46e-12  |g|= 8.63e-07  |ddm|= 4.14e-06
converged SCF energy = -108.929838385609  <S^2> = 8.4554586e-13  2S+1 = 1


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 150
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/tmpi74v_kmv
max_memory 4000 MB (current use 89 MB)
Set gradient conv threshold to 3.16228e-05
init E= -109.118668097606
  HOMO = -0.340727259681487  LUMO = 0.206373767449904
cycle= 1 E= -108.464842159941  delta_E= 0.654  |g|= 0.0415  |ddm|= 2.45
  HOMO = -0.569455327021911  LUMO = 0.317424869188746
cycle= 2 E= -108.464954245982  delta_E= -0.000112  |g|= 0.00401  |ddm|= 0.0403
  HOMO = -0.569968863561364  LUMO = 0.317280920982998
cycle= 3 E= -108.464957678335  delta_E= -3.43e-06  |g|= 0.000534  |ddm|= 0.00897
  HOMO = -0.570059394705286  LUMO = 0.317260695150181
cycle= 4 E= -108.464957764796  delta_E= -8.65e-08  |g|= 1.11e-07  |ddm|= 0.00169
  HOMO = -0.570059385497507  LUMO = 0.317260697508445
cycle= 5 E= -108.464957764796  delta_E= -2.84e-14  |g|= 7.29e-12  |ddm|= 2.17e-07
  HOMO = -0.570059385505936  LUMO = 0.317260697500125
Extra cycle  E= -108.464957764796  delta_E= -5.68e-14  |g|= 1.43e-12  |ddm|= 1.7e-11
converged SCF energy = -108.464957764796
7 (28, 28) (10, 10) (28, 10)
SVD [0.997158 0.996035 0.996035]
MOs after projection
             #0      #1      #2      #3      #4      #5     
  0 N 1s                              -0.180                
  0 N 2s                              -0.586                
  0 N 3s                      -0.348  -0.782                
  0 N 2px      0.430                          -0.575  -0.278
  0 N 2py              0.430                   0.278  -0.575
  0 N 2pz                      0.452  -0.869                
  0 N 3px      0.230                          -0.293  -0.142
  0 N 3py              0.230                   0.142  -0.293
  0 N 3pz                      0.202  -0.376                
  0 N 3dz^2                            0.108                
  1 N 1s                               0.180                
  1 N 2s                               0.586                
  1 N 3s                      -0.348   0.782                
  1 N 2px      0.430                           0.575   0.278
  1 N 2py              0.430                  -0.278   0.575
  1 N 2pz                     -0.452  -0.869                
  1 N 3px      0.230                           0.293   0.142
  1 N 3py              0.230                  -0.142   0.293
  1 N 3pz                     -0.202  -0.376                
  1 N 3dz^2                           -0.108                

PM orbital localization begins: using mulliken population
natom=2
niter=    1, sum_change=      0.0000000
Localization converged successfully.
Localization time(sec):0

PM orbital localization begins: using mulliken population
natom=2
niter=    1, sum_change=      0.0000000
Localization converged successfully.
Localization time(sec):0
MOs after PM localization
             #0      #1      #2      #3      #4      #5     
  0 N 1s                              -0.180                
  0 N 2s                              -0.586                
  0 N 3s              -0.348          -0.782                
  0 N 2px      0.403           0.164          -0.600   0.218
  0 N 2py      0.164          -0.403          -0.218  -0.600
  0 N 2pz              0.452          -0.869                
  0 N 3px      0.216                          -0.306   0.111
  0 N 3py                     -0.216          -0.111  -0.306
  0 N 3pz              0.202          -0.376                
  0 N 3dz^2                            0.108                
  1 N 1s                               0.180                
  1 N 2s                               0.586                
  1 N 3s              -0.348           0.782                
  1 N 2px      0.403           0.164           0.600  -0.218
  1 N 2py      0.164          -0.403           0.218   0.600
  1 N 2pz             -0.452          -0.869                
  1 N 3px      0.216                           0.306  -0.111
  1 N 3py                     -0.216           0.111   0.306
  1 N 3pz             -0.202          -0.376                
  1 N 3dz^2                           -0.108                

Information of subroutine pair_by_tdm1:
There are   4 core orbitals.
There are   3 occupied LMOs.
There are   0 singly occupied MOs.
There are   7 alpha MOs.
There are   3 unoccupied LMOs.
In occ LMO subspace, Modified f(Boys)=   12.283224
In vir LMO subspace, Modified f(Boys)=   12.283223
Max transition dipole**2=    0.91073
    7   10
sum_tdm=         2.21679
sum_tdm=         2.21679
sum_tdm=         2.21679
Final pairs:
   1   8   6    0.39605
   2   9   5    0.91001
   3  10   7    0.91073
max_sum=         2.21679
Information of subroutine pair_by_tdm1 printing done.
MOs after pairing
             #0      #1      #2      #3      #4      #5     
  0 N 1s                              -0.180                
  0 N 2s                              -0.586                
  0 N 3s                      -0.348  -0.782                
  0 N 2px      0.164   0.403                  -0.600   0.218
  0 N 2py     -0.403   0.164                  -0.218  -0.600
  0 N 2pz                      0.452  -0.869                
  0 N 3px              0.216                  -0.306   0.111
  0 N 3py     -0.216                          -0.111  -0.306
  0 N 3pz                      0.202  -0.376                
  0 N 3dz^2                            0.108                
  1 N 1s                               0.180                
  1 N 2s                               0.586                
  1 N 3s                      -0.348   0.782                
  1 N 2px      0.164   0.403                   0.600  -0.218
  1 N 2py     -0.403   0.164                   0.218   0.600
  1 N 2pz                     -0.452  -0.869                
  1 N 3px              0.216                   0.306  -0.111
  1 N 3py     -0.216                           0.111   0.306
  1 N 3pz                     -0.202  -0.376                
  1 N 3dz^2                           -0.108                

******** <class 'pyscf.mcscf.mc1step.CASSCF'> ********
CAS (3e+3e, 6o), ncore = 4, nvir = 18
max_cycle_macro = 200
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 0
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /share/home/srwang/pyAutoMR/examples/tmpo1pespn0
max_memory 1000 MB (current use 101 MB)
internal_rotation = False
******** <class 'pyscf.fci.direct_spin1.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-08
davidson only = False
linear dependence = 1e-10
level shift = 0.001
max iter space = 12
max_memory 1000 MB
nroots = 1
pspace_size = 400
spin = 0
CASCI E = -109.021277781914  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter 1 (21 JK  4 micro), CASSCF E = -109.03452476511  dE = -0.013246983  S^2 = 0.0000000
               |grad[o]|=0.0762  |grad[c]|= 0.057030399175817266  |ddm|=0.00408
macro iter 2 (21 JK  4 micro), CASSCF E = -109.042709676353  dE = -0.0081849112  S^2 = 0.0000000
               |grad[o]|=0.0482  |grad[c]|= 0.042365318393247815  |ddm|=0.00246
macro iter 3 (17 JK  4 micro), CASSCF E = -109.044204435171  dE = -0.0014947588  S^2 = 0.0000000
               |grad[o]|=0.024  |grad[c]|= 0.03083320555374466  |ddm|=0.00239
macro iter 4 (10 JK  4 micro), CASSCF E = -109.044400509631  dE = -0.00019607446  S^2 = 0.0000000
               |grad[o]|=0.0195  |grad[c]|= 0.0012904979935507422  |ddm|=0.000263
macro iter 5 (6 JK  2 micro), CASSCF E = -109.044401899444  dE = -1.3898132e-06  S^2 = 0.0000000
               |grad[o]|=0.000733  |grad[c]|= 9.616107379565264e-05  |ddm|=2.49e-05
macro iter 6 (3 JK  1 micro), CASSCF E = -109.044401900055  dE = -6.1091043e-10  S^2 = 0.0000000
               |grad[o]|=3.27e-05  |grad[c]|= 8.761656271639056e-06  |ddm|=1.46e-06
1-step CASSCF converged in 6 macro (78 JK 19 micro) steps
CASSCF canonicalization
Natural occ [1.987781 1.957147 1.957147 0.042794 0.042794 0.012335]
Natural orbital (expansion on AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 N 1s      -0.01592  -0.00000   0.00000  -0.00000   0.00000
  0 N 2s       0.18651  -0.00000   0.00000  -0.00000   0.00000
  0 N 3s      -0.10633  -0.00000   0.00000  -0.00000  -0.00000
  0 N 2px      0.00000  -0.00306   0.44660  -0.72921  -0.00541
  0 N 2py      0.00000  -0.44660  -0.00306   0.00541  -0.72921
  0 N 2pz      0.48144   0.00000  -0.00000   0.00000  -0.00000
  0 N 3px      0.00000  -0.00153   0.22359  -0.19921  -0.00148
  0 N 3py      0.00000  -0.22359  -0.00153   0.00148  -0.19921
  0 N 3pz      0.15521   0.00000  -0.00000  -0.00000  -0.00000
  0 N 3dxy     0.00000   0.00000   0.00000   0.00000  -0.00000
  0 N 3dyz     0.00000  -0.04645  -0.00032   0.00031  -0.04229
  0 N 3dz^2    0.03858   0.00000   0.00000  -0.00000  -0.00000
  0 N 3dxz    -0.00000  -0.00032   0.04645  -0.04229  -0.00031
 0 N 3dx2-y2  -0.00000   0.00000  -0.00000  -0.00000  -0.00000
  1 N 1s      -0.01592  -0.00000   0.00000   0.00000  -0.00000
  1 N 2s       0.18651  -0.00000   0.00000   0.00000  -0.00000
  1 N 3s      -0.10633  -0.00000   0.00000   0.00000   0.00000
  1 N 2px      0.00000  -0.00306   0.44660   0.72921   0.00541
  1 N 2py      0.00000  -0.44660  -0.00306  -0.00541   0.72921
  1 N 2pz     -0.48144  -0.00000   0.00000   0.00000  -0.00000
  1 N 3px      0.00000  -0.00153   0.22359   0.19921   0.00148
  1 N 3py      0.00000  -0.22359  -0.00153  -0.00148   0.19921
  1 N 3pz     -0.15521  -0.00000   0.00000  -0.00000  -0.00000
  1 N 3dxy     0.00000   0.00000   0.00000  -0.00000   0.00000
  1 N 3dyz    -0.00000   0.04645   0.00032   0.00031  -0.04229
  1 N 3dz^2    0.03858   0.00000   0.00000   0.00000   0.00000
  1 N 3dxz     0.00000   0.00032  -0.04645  -0.04229  -0.00031
 1 N 3dx2-y2  -0.00000   0.00000  -0.00000   0.00000   0.00000
               #6       
  0 N 1s      -0.27298
  0 N 2s      -0.76243
  0 N 3s      -0.46502
  0 N 2px     -0.00000
  0 N 2py      0.00000
  0 N 2pz     -1.05009
  0 N 3px      0.00000
  0 N 3py     -0.00000
  0 N 3pz     -0.19749
  0 N 3dxy     0.00000
  0 N 3dyz     0.00000
  0 N 3dz^2   -0.05167
  0 N 3dxz    -0.00000
 0 N 3dx2-y2  -0.00000
  1 N 1s       0.27298
  1 N 2s       0.76243
  1 N 3s       0.46502
  1 N 2px      0.00000
  1 N 2py     -0.00000
  1 N 2pz     -1.05009
  1 N 3px     -0.00000
  1 N 3py      0.00000
  1 N 3pz     -0.19749
  1 N 3dxy    -0.00000
  1 N 3dyz     0.00000
  1 N 3dz^2    0.05167
  1 N 3dxz    -0.00000
 1 N 3dx2-y2   0.00000
<CAS-nat-orb|mo-hf>  5  3    0.74586366
<CAS-nat-orb|mo-hf>  5  7    0.66590661
<CAS-nat-orb|mo-hf>  6  5    0.92323660
<CAS-nat-orb|mo-hf>  7  6    0.92311065
<CAS-nat-orb|mo-hf>  8  9    0.92811242
<CAS-nat-orb|mo-hf>  9  10    0.92828317
<CAS-nat-orb|mo-hf>  10  8    0.98468320
CASSCF energy = -109.044401900055
CASCI E = -109.044401900055  E(CI) = -14.4654792470716  S^2 = 0.0000000
Natrual Orbs
             #0      #1      #2      #3      #4      #5     
  0 N 1s                              -0.180                
  0 N 2s                              -0.586                
  0 N 3s                      -0.348  -0.782                
  0 N 2px      0.164   0.403                  -0.600   0.218
  0 N 2py     -0.403   0.164                  -0.218  -0.600
  0 N 2pz                      0.452  -0.869                
  0 N 3px              0.216                  -0.306   0.111
  0 N 3py     -0.216                          -0.111  -0.306
  0 N 3pz                      0.202  -0.376                
  0 N 3dz^2                            0.108                
  1 N 1s                               0.180                
  1 N 2s                               0.586                
  1 N 3s                      -0.348   0.782                
  1 N 2px      0.164   0.403                   0.600  -0.218
  1 N 2py     -0.403   0.164                   0.218   0.600
  1 N 2pz                     -0.452  -0.869                
  1 N 3px              0.216                   0.306  -0.111
  1 N 3py     -0.216                           0.111   0.306
  1 N 3pz                     -0.202  -0.376                
  1 N 3dz^2                           -0.108                
***** CI components ******
 c**2   Gaussian-type vector
 0.952320  111000 
 0.010746  110100 
 0.010746  101010 
 c**2     ORCA-type vector
 0.952320  222000 
 0.010746  220200 
 0.010746  202020 
