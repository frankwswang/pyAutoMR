#INFO: **** input file is /share/home/srwang/pyAutoMR/examples/guess/N2-RKS.py ****
from pyscf import gto, dft
from automr import guess, dump_mat
import numpy as np
#mf=guess.from_fch_simp("v2.fchk", xc='pbe0')

#mf2.verbose=9
#mf2.stability()
for r in np.arange(1.5, 3.0, 0.1):
    mol = gto.Mole(atom='''N 0.0 0.0 0.0; N 0.0 0.0 %f'''%r, basis='def2-svp', verbose=5).build()
    mf = dft.RKS(mol)
    mf.xc = 'pbe0'
    mf.kernel()
    dump_mat.dump_mo(mol, mf.mo_coeff[:,:12])
    print(mf.mo_energy[:12])
    
    mf2 = guess.check_stab(mf, newton=True, res=True)
    dump_mat.dump_mo(mol, mf2.mo_coeff[:,:12])
    print(mf2.mo_energy[:12])
    print('scan %.2f, %.6f' % (r, mf2.e_tot))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='xc06n05', release='3.10.0-1127.el7.x86_64', version='#1 SMP Tue Feb 18 16:39:12 EST 2020', machine='x86_64', processor='x86_64')  Threads 48
Python 3.7.4 (default, Aug 13 2019, 20:35:49) 
[GCC 7.3.0]
numpy 1.17.2  scipy 1.4.1
Date: Thu Sep 16 17:41:35 2021
PySCF version 1.7.6a1
PySCF path  /share/home/srwang/pyscf/pyscf
GIT ORIG_HEAD 80f71dfe77ac5f9caae26788acf76446987635bd
GIT HEAD      ref: refs/heads/master
GIT master branch  80f71dfe77ac5f9caae26788acf76446987635bd

[ENV] PYSCF_EXT_PATH /share/home/srwang/pyscf_ext/fciqmc:
[CONFIG] conf_file /share/home/srwang/.pyscf_conf.py
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 2
[INPUT] num. electrons = 14
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 N      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 N      0.000000000000   0.000000000000   1.500000000000 AA    0.000000000000   0.000000000000   2.834589186848 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] N
[INPUT] 0    0    [5    /1   ]  1712.8415853      -0.0053934125305
                                257.64812677      -0.040221581118
                                58.458245853      -0.1793114499
                                16.198367905      -0.46376317823
                                5.0052600809      -0.44171422662
[INPUT] 0    0    [1    /1   ]  0.58731856571        1
[INPUT] 0    0    [1    /1   ]  0.18764592253        1
[INPUT] 1    0    [3    /1   ]  13.571470233      -0.040072398852
                                2.9257372874      -0.21807045028
                                0.79927750754     -0.51294466049
[INPUT] 1    0    [1    /1   ]  0.21954348034        1
[INPUT] 2    0    [1    /1   ]  1                    1

nuclear repulsion = 17.28645555672
number of shells = 12
number of NR pGTOs = 48
number of NR cGTOs = 28
basis = def2-svp
ecp = {}
CPU time:         0.81


******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmppgmk4mpo
max_memory 4000 MB (current use 108 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2aaf78ea5830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2aaf78ea5cb0>
Set gradient conv threshold to 3.16228e-05
atom N rad-grids = 75, ang-grids = [ 50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  86  86  86  86  86  86  86  86  86 266 266 266 266 266 266 266
 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266]
tot grids = 28092
Drop grids 3898
    CPU time for setting up grids      0.44 sec, wall time      0.01 sec
nelec by numeric integration = 13.992294148295112
    CPU time for vxc      0.97 sec, wall time      0.02 sec
E1 = -182.74871854756117  Ecoul = 69.96765439124276  Exc = -13.283384575915647
init E= -108.777993175514
cond(S) = 125.99786978685691
    CPU time for initialize scf      2.95 sec, wall time      0.09 sec
  HOMO = -0.295651681132545  LUMO = -0.1179109740193
  mo_energy =
[-14.388014 -14.388007  -0.900274  -0.585189  -0.324788  -0.295652  -0.295652  -0.117911  -0.117911   0.156802   0.567951   0.672341   0.736996   0.736996
   0.817249   0.817249   0.831282   0.910504   1.855011   1.855011   2.078969   2.078969   2.089954   2.206757   2.206758   2.574075   2.574075   3.125624]
nelec by numeric integration = 13.999999092346599
    CPU time for vxc      1.04 sec, wall time      0.02 sec
E1 = -180.90004340805768  Ecoul = 67.61075946605236  Exc = -13.086420287729203
cycle= 1 E= -109.089248673015  delta_E= -0.311  |g|= 0.248  |ddm|=  1.6
    CPU time for cycle= 1      1.32 sec, wall time      0.03 sec
  HOMO = -0.432009501366511  LUMO = -0.193120523366472
  mo_energy =
[-14.675513 -14.675444  -1.003914  -0.694003  -0.463291  -0.43201   -0.43201   -0.193121  -0.193121   0.057657   0.502124   0.612536   0.645008   0.645008
   0.741106   0.741106   0.747529   0.846005   1.749022   1.749022   1.969836   1.969837   1.980361   2.101486   2.101487   2.472148   2.472148   3.023238]
nelec by numeric integration = 13.999999018839848
    CPU time for vxc      0.85 sec, wall time      0.02 sec
E1 = -182.27808983798627  Ecoul = 69.16871060652832  Exc = -13.276899118341232
cycle= 2 E= -109.099822793079  delta_E= -0.0106  |g|= 0.134  |ddm|= 0.376
    CPU time for cycle= 2      1.06 sec, wall time      0.02 sec
  HOMO = -0.384211525853034  LUMO = -0.14441251462162
  mo_energy =
[-14.556362 -14.556303  -0.943416  -0.650225  -0.416154  -0.384212  -0.384212  -0.144413  -0.144413   0.116016   0.531919   0.64009    0.685097   0.685097
   0.775296   0.775296   0.784235   0.876493   1.798936   1.798936   2.017433   2.017434   2.033907   2.148879   2.14888    2.521805   2.521805   3.073887]
nelec by numeric integration = 13.99999904571777
    CPU time for vxc      0.89 sec, wall time      0.02 sec
E1 = -181.77597003289472  Ecoul = 68.59029453250668  Exc = -13.205366005988086
cycle= 3 E= -109.104585949656  delta_E= -0.00476  |g|= 0.0033  |ddm|= 0.144
    CPU time for cycle= 3      1.13 sec, wall time      0.02 sec
  HOMO = -0.385334909404392  LUMO = -0.145545809763825
  mo_energy =
[-14.559755 -14.559695  -0.944662  -0.651383  -0.417623  -0.385335  -0.385335  -0.145546  -0.145546   0.114753   0.531237   0.639265   0.684235   0.684235
   0.774482   0.774482   0.783335   0.875797   1.797796   1.797796   2.016352   2.016352   2.032685   2.147799   2.1478     2.520676   2.520676   3.072693]
nelec by numeric integration = 13.999999045120234
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -181.78807326605232  Ecoul = 68.60419970093041  Exc = -13.207170938779996
cycle= 4 E= -109.104588947182  delta_E= -3e-06  |g|= 0.000452  |ddm|= 0.00401
    CPU time for cycle= 4      1.00 sec, wall time      0.02 sec
  HOMO = -0.385265910130416  LUMO = -0.145443289232391
  mo_energy =
[-14.559485 -14.559425  -0.94462   -0.651244  -0.417508  -0.385266  -0.385266  -0.145443  -0.145443   0.11485    0.531307   0.639377   0.684304   0.684304
   0.774554   0.774554   0.783385   0.875838   1.79788    1.79788    2.016427   2.016427   2.032786   2.147878   2.147879   2.520774   2.520774   3.072798]
nelec by numeric integration = 13.999999045164271
    CPU time for vxc      0.80 sec, wall time      0.02 sec
E1 = -181.78707474163107  Ecoul = 68.60302475906147  Exc = -13.206994563828438
cycle= 5 E= -109.104588989678  delta_E= -4.25e-08  |g|= 4.49e-05  |ddm|= 0.00052
    CPU time for cycle= 5      0.99 sec, wall time      0.02 sec
  HOMO = -0.385281589252073  LUMO = -0.145459702435854
  mo_energy =
[-14.559523 -14.559463  -0.944638  -0.651256  -0.417523  -0.385282  -0.385282  -0.14546   -0.14546    0.114834   0.531296   0.639367   0.684288   0.684288
   0.774541   0.774541   0.783372   0.875827   1.797864   1.797864   2.016408   2.016409   2.032769   2.14786    2.147861   2.520757   2.520757   3.072782]
nelec by numeric integration = 13.999999045156427
    CPU time for vxc      0.80 sec, wall time      0.02 sec
E1 = -181.78722999010913  Ecoul = 68.60320169343954  Exc = -13.20701625026822
cycle= 6 E= -109.104588990218  delta_E= -5.4e-10  |g|= 3.76e-07  |ddm|= 4.24e-05
    CPU time for cycle= 6      0.98 sec, wall time      0.02 sec
  HOMO = -0.385281720017112  LUMO = -0.145459848655352
  mo_energy =
[-14.559523 -14.559463  -0.944638  -0.651257  -0.417524  -0.385282  -0.385282  -0.14546   -0.14546    0.114834   0.531296   0.639367   0.684288   0.684288
   0.774541   0.774541   0.783372   0.875827   1.797863   1.797863   2.016408   2.016409   2.032769   2.14786    2.147861   2.520757   2.520757   3.072782]
nelec by numeric integration = 13.999999045156365
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -181.7872314919084  Ecoul = 68.60320341606418  Exc = -13.207016471093748
Extra cycle  E= -109.104588990218  delta_E= -1.71e-13  |g|= 1.54e-07  |ddm|= 5.27e-07
    CPU time for scf_cycle     10.39 sec, wall time      0.25 sec
    CPU time for SCF     10.40 sec, wall time      0.25 sec
converged SCF energy = -109.104588990218
             #0      #1      #2      #3      #4      #5     
  0 N 1s       0.700   0.700   0.204  -0.221                
  0 N 2s                       0.433  -0.485   0.137        
  0 N 3s                       0.199  -0.355   0.205        
  0 N 2px                                              0.360
  0 N 2py                                              0.247
  0 N 2pz                     -0.144  -0.116   0.456        
  0 N 3px                                             -0.249
  0 N 3py                                             -0.171
  0 N 3pz                                     -0.248        
  1 N 1s      -0.700   0.700   0.204   0.221                
  1 N 2s                       0.433   0.485   0.137        
  1 N 3s                       0.199   0.355   0.205        
  1 N 2px                                              0.360
  1 N 2py                                              0.247
  1 N 2pz                      0.144  -0.116  -0.456        
  1 N 3px                                             -0.249
  1 N 3py                                             -0.171
  1 N 3pz                                      0.248        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                               0.115   0.213   0.156
  0 N 2s                               0.299   1.149   0.900
  0 N 3s                               0.631  -1.018  -0.997
  0 N 2px     -0.247  -0.436   0.237                        
  0 N 2py      0.360  -0.237  -0.436                        
  0 N 2pz                             -0.520   0.114   0.478
  0 N 3px      0.171   0.359  -0.195                        
  0 N 3py     -0.249   0.195   0.359                        
  0 N 3pz                              0.789           0.383
  1 N 1s                              -0.115   0.213  -0.156
  1 N 2s                              -0.299   1.149  -0.900
  1 N 3s                              -0.631  -1.018   0.997
  1 N 2px     -0.247   0.436  -0.237                        
  1 N 2py      0.360   0.237   0.436                        
  1 N 2pz                             -0.520  -0.114   0.478
  1 N 3px      0.171  -0.359   0.195                        
  1 N 3py     -0.249  -0.195  -0.359                        
  1 N 3pz                              0.789           0.383
[-14.559523 -14.559463  -0.944638  -0.651257  -0.417524  -0.385282  -0.385282  -0.14546   -0.14546    0.114834   0.531296   0.639367]
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 13.999999045156361
    CPU time for vxc      0.80 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 3.95  e= [3.474053]  max|de|= 3.47  lindep= 0.992
davidson 1 2  |r|=  2.8  e= [3.390136]  max|de|= -0.0839  lindep= 0.184
davidson 2 3  |r|= 3.41  e= [2.396851]  max|de|= -0.993  lindep= 0.492
davidson 3 4  |r|= 2.13  e= [1.804921]  max|de|= -0.592  lindep= 0.794
davidson 4 5  |r|= 2.28  e= [1.796449]  max|de|= -0.00847  lindep= 0.19
davidson 5 6  |r|= 1.15  e= [1.626057]  max|de|= -0.17  lindep= 0.282
davidson 6 7  |r|= 1.64  e= [1.563872]  max|de|= -0.0622  lindep= 0.247
davidson 7 8  |r|= 0.848  e= [1.462777]  max|de|= -0.101  lindep= 0.378
davidson 8 9  |r|= 0.356  e= [1.357763]  max|de|= -0.105  lindep= 0.45
davidson 9 10  |r|= 1.22  e= [0.901981]  max|de|= -0.456  lindep= 0.45
Large |r| detected, restore to previous x0
davidson 10 1  |r|= 0.356  e= [1.357763]  max|de|= 0.456  lindep= 0.985
davidson 11 2  |r|= 1.59  e= [1.011096]  max|de|= -0.347  lindep= 0.985
Large |r| detected, restore to previous x0
davidson 12 1  |r|= 0.356  e= [1.357763]  max|de|= 0.347  lindep= 0.985
davidson 13 2  |r|= 1.59  e= [1.011096]  max|de|= -0.347  lindep= 0.985
Large |r| detected, restore to previous x0
davidson 14 1  |r|= 0.356  e= [1.357763]  max|de|= 0.347  lindep= 0.985
davidson 15 2  |r|= 1.59  e= [1.011096]  max|de|= -0.347  lindep= 0.985
Large |r| detected, restore to previous x0
davidson 16 1  |r|= 0.356  e= [1.357763]  max|de|= 0.347  lindep= 0.985
davidson 17 2  |r|= 1.59  e= [1.011096]  max|de|= -0.347  lindep= 0.985
Large |r| detected, restore to previous x0
davidson 18 1  |r|= 0.356  e= [1.357763]  max|de|= 0.347  lindep= 0.985
davidson 19 2  |r|= 1.59  e= [1.011096]  max|de|= -0.347  lindep= 0.985
Large |r| detected, restore to previous x0
davidson 20 1  |r|= 0.356  e= [1.357763]  max|de|= 0.347  lindep= 0.985
davidson 21 2  |r|= 1.59  e= [1.011096]  max|de|= -0.347  lindep= 0.985
Large |r| detected, restore to previous x0
davidson 22 1  |r|= 0.356  e= [1.357763]  max|de|= 0.347  lindep= 0.985
davidson 23 2  |r|= 1.59  e= [1.011096]  max|de|= -0.347  lindep= 0.985
Large |r| detected, restore to previous x0
davidson 24 1  |r|= 0.356  e= [1.357763]  max|de|= 0.347  lindep= 0.985
davidson 25 2  |r|= 1.59  e= [1.011096]  max|de|= -0.347  lindep= 0.985
Large |r| detected, restore to previous x0
davidson 26 1  |r|= 0.356  e= [1.357763]  max|de|= 0.347  lindep= 0.985
davidson 27 2  |r|= 1.59  e= [1.011096]  max|de|= -0.347  lindep= 0.985
Large |r| detected, restore to previous x0
davidson 28 1  |r|= 0.356  e= [1.357763]  max|de|= 0.347  lindep= 0.985
davidson 29 2  |r|= 1.59  e= [1.011096]  max|de|= -0.347  lindep= 0.985
Large |r| detected, restore to previous x0
davidson 30 1  |r|= 0.356  e= [1.357763]  max|de|= 0.347  lindep= 0.985
davidson 31 2  |r|= 1.59  e= [1.011096]  max|de|= -0.347  lindep= 0.985
Large |r| detected, restore to previous x0
davidson 32 1  |r|= 0.356  e= [1.357763]  max|de|= 0.347  lindep= 0.985
davidson 33 2  |r|= 1.59  e= [1.011096]  max|de|= -0.347  lindep= 0.985
Large |r| detected, restore to previous x0
davidson 34 1  |r|= 0.356  e= [1.357763]  max|de|= 0.347  lindep= 0.985
davidson 35 2  |r|= 1.59  e= [1.011096]  max|de|= -0.347  lindep= 0.985
Large |r| detected, restore to previous x0
davidson 36 1  |r|= 0.356  e= [1.357763]  max|de|= 0.347  lindep= 0.985
davidson 37 2  |r|= 1.59  e= [1.011096]  max|de|= -0.347  lindep= 0.985
Large |r| detected, restore to previous x0
davidson 38 1  |r|= 0.356  e= [1.357763]  max|de|= 0.347  lindep= 0.985
davidson 39 2  |r|= 1.59  e= [1.011096]  max|de|= -0.347  lindep= 0.985
Large |r| detected, restore to previous x0
davidson 40 1  |r|= 0.356  e= [1.357763]  max|de|= 0.347  lindep= 0.985
davidson 41 2  |r|= 1.59  e= [1.011096]  max|de|= -0.347  lindep= 0.985
Large |r| detected, restore to previous x0
davidson 42 1  |r|= 0.356  e= [1.357763]  max|de|= 0.347  lindep= 0.985
davidson 43 2  |r|= 1.59  e= [1.011096]  max|de|= -0.347  lindep= 0.985
Large |r| detected, restore to previous x0
davidson 44 1  |r|= 0.356  e= [1.357763]  max|de|= 0.347  lindep= 0.985
davidson 45 2  |r|= 1.59  e= [1.011096]  max|de|= -0.347  lindep= 0.985
Large |r| detected, restore to previous x0
davidson 46 1  |r|= 0.356  e= [1.357763]  max|de|= 0.347  lindep= 0.985
davidson 47 2  |r|= 1.59  e= [1.011096]  max|de|= -0.347  lindep= 0.985
Large |r| detected, restore to previous x0
davidson 48 1  |r|= 0.356  e= [1.357763]  max|de|= 0.347  lindep= 0.985
davidson 49 2  |r|= 1.59  e= [1.011096]  max|de|= -0.347  lindep= 0.985
Large |r| detected, restore to previous x0
RHF/RKS wavefunction is stable in the internal stability analysis
             #0      #1      #2      #3      #4      #5     
  0 N 1s       0.700   0.700   0.204  -0.221                
  0 N 2s                       0.433  -0.485   0.137        
  0 N 3s                       0.199  -0.355   0.205        
  0 N 2px                                              0.360
  0 N 2py                                              0.247
  0 N 2pz                     -0.144  -0.116   0.456        
  0 N 3px                                             -0.249
  0 N 3py                                             -0.171
  0 N 3pz                                     -0.248        
  1 N 1s      -0.700   0.700   0.204   0.221                
  1 N 2s                       0.433   0.485   0.137        
  1 N 3s                       0.199   0.355   0.205        
  1 N 2px                                              0.360
  1 N 2py                                              0.247
  1 N 2pz                      0.144  -0.116  -0.456        
  1 N 3px                                             -0.249
  1 N 3py                                             -0.171
  1 N 3pz                                      0.248        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                               0.115   0.213   0.156
  0 N 2s                               0.299   1.149   0.900
  0 N 3s                               0.631  -1.018  -0.997
  0 N 2px     -0.247  -0.436   0.237                        
  0 N 2py      0.360  -0.237  -0.436                        
  0 N 2pz                             -0.520   0.114   0.478
  0 N 3px      0.171   0.359  -0.195                        
  0 N 3py     -0.249   0.195   0.359                        
  0 N 3pz                              0.789           0.383
  1 N 1s                              -0.115   0.213  -0.156
  1 N 2s                              -0.299   1.149  -0.900
  1 N 3s                              -0.631  -1.018   0.997
  1 N 2px     -0.247   0.436  -0.237                        
  1 N 2py      0.360   0.237   0.436                        
  1 N 2pz                             -0.520  -0.114   0.478
  1 N 3px      0.171  -0.359   0.195                        
  1 N 3py     -0.249  -0.195  -0.359                        
  1 N 3pz                              0.789           0.383
[-14.559523 -14.559463  -0.944638  -0.651257  -0.417524  -0.385282  -0.385282  -0.14546   -0.14546    0.114834   0.531296   0.639367]
scan 1.50, -109.104589
#INFO: **** input file is /share/home/srwang/pyAutoMR/examples/guess/N2-RKS.py ****
from pyscf import gto, dft
from automr import guess, dump_mat
import numpy as np
#mf=guess.from_fch_simp("v2.fchk", xc='pbe0')

#mf2.verbose=9
#mf2.stability()
for r in np.arange(1.5, 3.0, 0.1):
    mol = gto.Mole(atom='''N 0.0 0.0 0.0; N 0.0 0.0 %f'''%r, basis='def2-svp', verbose=5).build()
    mf = dft.RKS(mol)
    mf.xc = 'pbe0'
    mf.kernel()
    dump_mat.dump_mo(mol, mf.mo_coeff[:,:12])
    print(mf.mo_energy[:12])
    
    mf2 = guess.check_stab(mf, newton=True, res=True)
    dump_mat.dump_mo(mol, mf2.mo_coeff[:,:12])
    print(mf2.mo_energy[:12])
    print('scan %.2f, %.6f' % (r, mf2.e_tot))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='xc06n05', release='3.10.0-1127.el7.x86_64', version='#1 SMP Tue Feb 18 16:39:12 EST 2020', machine='x86_64', processor='x86_64')  Threads 48
Python 3.7.4 (default, Aug 13 2019, 20:35:49) 
[GCC 7.3.0]
numpy 1.17.2  scipy 1.4.1
Date: Thu Sep 16 17:41:36 2021
PySCF version 1.7.6a1
PySCF path  /share/home/srwang/pyscf/pyscf
GIT ORIG_HEAD 80f71dfe77ac5f9caae26788acf76446987635bd
GIT HEAD      ref: refs/heads/master
GIT master branch  80f71dfe77ac5f9caae26788acf76446987635bd

[ENV] PYSCF_EXT_PATH /share/home/srwang/pyscf_ext/fciqmc:
[CONFIG] conf_file /share/home/srwang/.pyscf_conf.py
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 2
[INPUT] num. electrons = 14
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 N      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 N      0.000000000000   0.000000000000   1.600000000000 AA    0.000000000000   0.000000000000   3.023561799304 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] N
[INPUT] 0    0    [5    /1   ]  1712.8415853      -0.0053934125305
                                257.64812677      -0.040221581118
                                58.458245853      -0.1793114499
                                16.198367905      -0.46376317823
                                5.0052600809      -0.44171422662
[INPUT] 0    0    [1    /1   ]  0.58731856571        1
[INPUT] 0    0    [1    /1   ]  0.18764592253        1
[INPUT] 1    0    [3    /1   ]  13.571470233      -0.040072398852
                                2.9257372874      -0.21807045028
                                0.79927750754     -0.51294466049
[INPUT] 1    0    [1    /1   ]  0.21954348034        1
[INPUT] 2    0    [1    /1   ]  1                    1

nuclear repulsion = 16.206052084425
number of shells = 12
number of NR pGTOs = 48
number of NR cGTOs = 28
basis = def2-svp
ecp = {}
CPU time:        25.05


******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpve_taqx3
max_memory 4000 MB (current use 247 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2aaf78ea5830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2aaf78ea5cb0>
Set gradient conv threshold to 3.16228e-05
atom N rad-grids = 75, ang-grids = [ 50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  86  86  86  86  86  86  86  86  86 266 266 266 266 266 266 266
 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266]
tot grids = 28092
Drop grids 3880
    CPU time for setting up grids      0.25 sec, wall time      0.01 sec
nelec by numeric integration = 13.992318306688405
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -180.63452937779363  Ecoul = 68.97666926941137  Exc = -13.242751772699226
init E= -108.694559796656
cond(S) = 91.4174222410485
    CPU time for initialize scf      1.75 sec, wall time      0.04 sec
  HOMO = -0.276865573431526  LUMO = -0.131382072047745
  mo_energy =
[-14.38415  -14.384123  -0.85701   -0.598618  -0.313091  -0.276866  -0.276866  -0.131382  -0.131382   0.092568   0.572763   0.66653    0.733712   0.733712
   0.819449   0.819449   0.875799   0.910832   1.915479   1.915479   1.988429   2.10501    2.105011   2.18852    2.188521   2.472799   2.472799   3.039194]
nelec by numeric integration = 13.999999594851417
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -178.68643333436444  Ecoul = 66.48347342720335  Exc = -13.027732308696294
cycle= 1 E= -109.024640131432  delta_E= -0.33  |g|= 0.257  |ddm|= 1.57
    CPU time for cycle= 1      1.03 sec, wall time      0.02 sec
  HOMO = -0.416941320022573  LUMO = -0.213545455590695
  mo_energy =
[-14.689679 -14.68962   -0.967093  -0.715139  -0.457096  -0.416941  -0.416941  -0.213545  -0.213545  -0.013828   0.503787   0.601947   0.636508   0.636508
   0.738017   0.738017   0.780814   0.842418   1.804075   1.804075   1.8734     1.991277   1.991278   2.078017   2.078018   2.364354   2.364354   2.929655]
nelec by numeric integration = 13.999999594876877
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -180.11901387153046  Ecoul = 68.10768839367792  Exc = -13.2308915916475
cycle= 2 E= -109.036164985075  delta_E= -0.0115  |g|= 0.139  |ddm|= 0.405
    CPU time for cycle= 2      0.99 sec, wall time      0.02 sec
  HOMO = -0.368064897552831  LUMO = -0.162721125464407
  mo_energy =
[-14.563968 -14.563917  -0.907917  -0.668256  -0.40751   -0.368065  -0.368065  -0.162721  -0.162721   0.046652   0.53424    0.630774   0.678418   0.678418
   0.773814   0.773814   0.821624   0.873886   1.854864   1.854864   1.927557   2.040391   2.040393   2.127087   2.127088   2.415564   2.415564   2.981795]
nelec by numeric integration = 13.999999592519622
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -179.60013978623905  Ecoul = 67.50794397919569  Exc = -13.155217358838517
cycle= 3 E= -109.041361081457  delta_E= -0.0052  |g|= 0.0031  |ddm|= 0.152
    CPU time for cycle= 3      0.98 sec, wall time      0.02 sec
  HOMO = -0.369063862090425  LUMO = -0.163704951822151
  mo_energy =
[-14.567003 -14.566952  -0.909018  -0.669257  -0.408776  -0.369064  -0.369064  -0.163705  -0.163705   0.045543   0.533668   0.630119   0.677664   0.677664
   0.773113   0.773113   0.820788   0.873287   1.853892   1.853892   1.926532   2.039448   2.039449   2.126147   2.126149   2.414609   2.414609   2.980801]
nelec by numeric integration = 13.999999592401434
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -179.61088343691102  Ecoul = 67.52031331430668  Exc = -13.156845636121215
cycle= 4 E= -109.041363674301  delta_E= -2.59e-06  |g|= 0.000339  |ddm|= 0.00363
    CPU time for cycle= 4      0.98 sec, wall time      0.02 sec
  HOMO = -0.369029911737454  LUMO = -0.163648566686549
  mo_energy =
[-14.566843 -14.566791  -0.909008  -0.669172  -0.408711  -0.36903   -0.36903   -0.163649  -0.163649   0.045593   0.53371    0.630192   0.677699   0.677699
   0.773152   0.773152   0.820807   0.873302   1.853934   1.853934   1.926584   2.039485   2.039486   2.126187   2.126188   2.414659   2.414659   2.980855]
nelec by numeric integration = 13.999999592377035
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -179.61032388646956  Ecoul = 67.51964639419937  Exc = -13.156738288886176
cycle= 5 E= -109.041363696731  delta_E= -2.24e-08  |g|= 3.28e-05  |ddm|= 0.000332
    CPU time for cycle= 5      0.98 sec, wall time      0.02 sec
  HOMO = -0.369041074687002  LUMO = -0.163661127111125
  mo_energy =
[-14.566869 -14.566818  -0.90902   -0.669181  -0.408722  -0.369041  -0.369041  -0.163661  -0.163661   0.04558    0.533701   0.630184   0.677686   0.677686
   0.773141   0.773141   0.820796   0.873294   1.853921   1.853921   1.926571   2.039471   2.039472   2.126172   2.126174   2.414646   2.414646   2.980843]
nelec by numeric integration = 13.999999592376135
    CPU time for vxc      0.80 sec, wall time      0.02 sec
E1 = -179.61043808431677  Ecoul = 67.51977702728345  Exc = -13.156754724420566
cycle= 6 E= -109.041363697029  delta_E= -2.98e-10  |g|= 4.93e-07  |ddm|= 3.18e-05
    CPU time for cycle= 6      0.98 sec, wall time      0.02 sec
  HOMO = -0.369041261588611  LUMO = -0.163661330064631
  mo_energy =
[-14.56687  -14.566819  -0.90902   -0.669181  -0.408723  -0.369041  -0.369041  -0.163661  -0.163661   0.04558    0.533701   0.630184   0.677686   0.677686
   0.773141   0.773141   0.820796   0.873294   1.853921   1.853921   1.926571   2.039471   2.039472   2.126172   2.126174   2.414646   2.414646   2.980843]
nelec by numeric integration = 13.999999592376161
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -179.61044010974078  Ecoul = 67.51977936143619  Exc = -13.156755033149265
Extra cycle  E= -109.041363697029  delta_E= 2.84e-14  |g|= 2.14e-07  |ddm|= 6.38e-07
    CPU time for scf_cycle      8.66 sec, wall time      0.18 sec
    CPU time for SCF      8.68 sec, wall time      0.18 sec
converged SCF energy = -109.041363697029
             #0      #1      #2      #3      #4      #5     
  0 N 1s      -0.700   0.700   0.205   0.223                
  0 N 2s                       0.437   0.491  -0.133        
  0 N 3s                       0.218   0.342  -0.178        
  0 N 2px                                              0.257
  0 N 2py                                              0.354
  0 N 2pz                     -0.122          -0.454        
  0 N 3px                                             -0.183
  0 N 3py                                             -0.252
  0 N 3pz                                      0.260        
  1 N 1s       0.700   0.700   0.205  -0.223                
  1 N 2s                       0.437  -0.491  -0.133        
  1 N 3s                       0.218  -0.342  -0.178        
  1 N 2px                                              0.257
  1 N 2py                                              0.354
  1 N 2pz                      0.122           0.454        
  1 N 3px                                             -0.183
  1 N 3py                                             -0.252
  1 N 3pz                                     -0.260        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                               0.100   0.214  -0.160
  0 N 2s                               0.260   1.138  -0.902
  0 N 3s                               0.422  -1.026   0.944
  0 N 2px      0.354   0.340   0.359                        
  0 N 2py     -0.257   0.359  -0.340                        
  0 N 2pz                             -0.527   0.126  -0.463
  0 N 3px     -0.252  -0.269  -0.284                        
  0 N 3py      0.183  -0.284   0.269                        
  0 N 3pz                              0.649   0.147  -0.423
  1 N 1s                              -0.100   0.214   0.160
  1 N 2s                              -0.260   1.138   0.902
  1 N 3s                              -0.422  -1.026  -0.944
  1 N 2px      0.354  -0.340  -0.359                        
  1 N 2py     -0.257  -0.359   0.340                        
  1 N 2pz                             -0.527  -0.126  -0.463
  1 N 3px     -0.252   0.269   0.284                        
  1 N 3py      0.183   0.284  -0.269                        
  1 N 3pz                              0.649  -0.147  -0.423
[-14.56687  -14.566819  -0.90902   -0.669181  -0.408723  -0.369041  -0.369041  -0.163661  -0.163661   0.04558    0.533701   0.630184]
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 13.999999592376161
    CPU time for vxc      0.80 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 4.44  e= [3.815319]  max|de|= 3.82  lindep= 0.997
davidson 1 2  |r|= 2.92  e= [3.03596]  max|de|= -0.779  lindep= 0.961
davidson 2 3  |r|= 2.78  e= [2.454694]  max|de|= -0.581  lindep= 0.511
davidson 3 4  |r|= 2.62  e= [1.743359]  max|de|= -0.711  lindep= 0.712
davidson 4 5  |r|= 1.61  e= [1.581018]  max|de|= -0.162  lindep= 0.892
davidson 5 6  |r|= 0.681  e= [1.341006]  max|de|= -0.24  lindep= 0.494
davidson 6 7  |r|= 1.58  e= [1.329913]  max|de|= -0.0111  lindep= 0.221
davidson 7 8  |r|= 1.36  e= [0.990661]  max|de|= -0.339  lindep= 0.409
davidson 8 9  |r|= 0.402  e= [0.707263]  max|de|= -0.283  lindep= 0.419
davidson 9 10  |r|= 0.219  e= [0.687017]  max|de|= -0.0202  lindep= 0.513
davidson 10 11  |r|= 0.142  e= [0.676733]  max|de|= -0.0103  lindep= 0.456
davidson 11 12  |r|= 0.278  e= [0.44108]  max|de|= -0.236  lindep= 0.88
davidson 12 1  |r|= 0.278  e= [0.44108]  max|de|= -2.22e-16  lindep= 0.969
davidson 13 2  |r|= 0.0711  e= [0.430942]  max|de|= -0.0101  lindep= 0.995
davidson 14 3  |r|= 0.0604  e= [0.43069]  max|de|= -0.000252  lindep= 0.747
davidson 15 4  |r|= 0.00888  e= [0.430134]  max|de|= -0.000556  lindep= 0.802
root 0 converged  |r|= 0.00949  e= 0.4300654859536799  max|de|= -6.83e-05
converged 16 5  |r|= 0.00949  e= [0.430065]  max|de|= -6.83e-05
RHF/RKS wavefunction is stable in the internal stability analysis
             #0      #1      #2      #3      #4      #5     
  0 N 1s      -0.700   0.700   0.205   0.223                
  0 N 2s                       0.437   0.491  -0.133        
  0 N 3s                       0.218   0.342  -0.178        
  0 N 2px                                              0.257
  0 N 2py                                              0.354
  0 N 2pz                     -0.122          -0.454        
  0 N 3px                                             -0.183
  0 N 3py                                             -0.252
  0 N 3pz                                      0.260        
  1 N 1s       0.700   0.700   0.205  -0.223                
  1 N 2s                       0.437  -0.491  -0.133        
  1 N 3s                       0.218  -0.342  -0.178        
  1 N 2px                                              0.257
  1 N 2py                                              0.354
  1 N 2pz                      0.122           0.454        
  1 N 3px                                             -0.183
  1 N 3py                                             -0.252
  1 N 3pz                                     -0.260        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                               0.100   0.214  -0.160
  0 N 2s                               0.260   1.138  -0.902
  0 N 3s                               0.422  -1.026   0.944
  0 N 2px      0.354   0.340   0.359                        
  0 N 2py     -0.257   0.359  -0.340                        
  0 N 2pz                             -0.527   0.126  -0.463
  0 N 3px     -0.252  -0.269  -0.284                        
  0 N 3py      0.183  -0.284   0.269                        
  0 N 3pz                              0.649   0.147  -0.423
  1 N 1s                              -0.100   0.214   0.160
  1 N 2s                              -0.260   1.138   0.902
  1 N 3s                              -0.422  -1.026  -0.944
  1 N 2px      0.354  -0.340  -0.359                        
  1 N 2py     -0.257  -0.359   0.340                        
  1 N 2pz                             -0.527  -0.126  -0.463
  1 N 3px     -0.252   0.269   0.284                        
  1 N 3py      0.183   0.284  -0.269                        
  1 N 3pz                              0.649  -0.147  -0.423
[-14.56687  -14.566819  -0.90902   -0.669181  -0.408723  -0.369041  -0.369041  -0.163661  -0.163661   0.04558    0.533701   0.630184]
scan 1.60, -109.041364
#INFO: **** input file is /share/home/srwang/pyAutoMR/examples/guess/N2-RKS.py ****
from pyscf import gto, dft
from automr import guess, dump_mat
import numpy as np
#mf=guess.from_fch_simp("v2.fchk", xc='pbe0')

#mf2.verbose=9
#mf2.stability()
for r in np.arange(1.5, 3.0, 0.1):
    mol = gto.Mole(atom='''N 0.0 0.0 0.0; N 0.0 0.0 %f'''%r, basis='def2-svp', verbose=5).build()
    mf = dft.RKS(mol)
    mf.xc = 'pbe0'
    mf.kernel()
    dump_mat.dump_mo(mol, mf.mo_coeff[:,:12])
    print(mf.mo_energy[:12])
    
    mf2 = guess.check_stab(mf, newton=True, res=True)
    dump_mat.dump_mo(mol, mf2.mo_coeff[:,:12])
    print(mf2.mo_energy[:12])
    print('scan %.2f, %.6f' % (r, mf2.e_tot))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='xc06n05', release='3.10.0-1127.el7.x86_64', version='#1 SMP Tue Feb 18 16:39:12 EST 2020', machine='x86_64', processor='x86_64')  Threads 48
Python 3.7.4 (default, Aug 13 2019, 20:35:49) 
[GCC 7.3.0]
numpy 1.17.2  scipy 1.4.1
Date: Thu Sep 16 17:41:36 2021
PySCF version 1.7.6a1
PySCF path  /share/home/srwang/pyscf/pyscf
GIT ORIG_HEAD 80f71dfe77ac5f9caae26788acf76446987635bd
GIT HEAD      ref: refs/heads/master
GIT master branch  80f71dfe77ac5f9caae26788acf76446987635bd

[ENV] PYSCF_EXT_PATH /share/home/srwang/pyscf_ext/fciqmc:
[CONFIG] conf_file /share/home/srwang/.pyscf_conf.py
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 2
[INPUT] num. electrons = 14
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 N      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 N      0.000000000000   0.000000000000   1.700000000000 AA    0.000000000000   0.000000000000   3.212534411761 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] N
[INPUT] 0    0    [5    /1   ]  1712.8415853      -0.0053934125305
                                257.64812677      -0.040221581118
                                58.458245853      -0.1793114499
                                16.198367905      -0.46376317823
                                5.0052600809      -0.44171422662
[INPUT] 0    0    [1    /1   ]  0.58731856571        1
[INPUT] 0    0    [1    /1   ]  0.18764592253        1
[INPUT] 1    0    [3    /1   ]  13.571470233      -0.040072398852
                                2.9257372874      -0.21807045028
                                0.79927750754     -0.51294466049
[INPUT] 1    0    [1    /1   ]  0.21954348034        1
[INPUT] 2    0    [1    /1   ]  1                    1

nuclear repulsion = 15.2527549029882
number of shells = 12
number of NR pGTOs = 48
number of NR cGTOs = 28
basis = def2-svp
ecp = {}
CPU time:        41.33


******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmp_aor9h3k
max_memory 4000 MB (current use 220 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2aaf78ea5830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2aaf78ea5cb0>
Set gradient conv threshold to 3.16228e-05
atom N rad-grids = 75, ang-grids = [ 50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  86  86  86  86  86  86  86  86  86 266 266 266 266 266 266 266
 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266]
tot grids = 28092
Drop grids 3854
    CPU time for setting up grids      0.35 sec, wall time      0.01 sec
nelec by numeric integration = 13.992331774489369
    CPU time for vxc      2.24 sec, wall time      0.05 sec
E1 = -178.7571607036877  Ecoul = 68.08336265031225  Exc = -13.211161124225658
init E= -108.632204274613
cond(S) = 68.48824573867579
    CPU time for initialize scf      3.39 sec, wall time      0.07 sec
  HOMO = -0.261934690979948  LUMO = -0.142639957147364
  mo_energy =
[-14.381686 -14.38166   -0.822425  -0.611325  -0.302361  -0.261935  -0.261935  -0.14264   -0.14264    0.040311   0.57557    0.661677   0.728116   0.728116
   0.821537   0.821537   0.908533   0.917021   1.934137   1.976791   1.976791   2.123286   2.123289   2.175735   2.175738   2.387214   2.387214   2.931743]
nelec by numeric integration = 14.00000070519627
    CPU time for vxc      1.00 sec, wall time      0.02 sec
E1 = -176.74621118130966  Ecoul = 65.50892118412553  Exc = -12.981196622487833
cycle= 1 E= -108.965731716684  delta_E= -0.334  |g|= 0.26  |ddm|= 1.56
    CPU time for cycle= 1      1.31 sec, wall time      0.03 sec
  HOMO = -0.403390384271634  LUMO = -0.22901834092612
  mo_energy =
[-14.698907 -14.698878  -0.935335  -0.732716  -0.448764  -0.40339   -0.40339   -0.229018  -0.229018  -0.068549   0.504377   0.593537   0.628234   0.628234
   0.736621   0.736621   0.805358   0.845464   1.817676   1.86266    1.86266    2.007211   2.007214   2.062434   2.062438   2.275525   2.275525   2.818572]
nelec by numeric integration = 14.000000871038775
    CPU time for vxc      0.83 sec, wall time      0.02 sec
E1 = -178.20535458556046  Ecoul = 67.16827046515563  Exc = -13.193462585838725
cycle= 2 E= -108.977791803255  delta_E= -0.0121  |g|= 0.141  |ddm|= 0.426
    CPU time for cycle= 2      1.03 sec, wall time      0.02 sec
  HOMO = -0.354327722123363  LUMO = -0.17727764859717
  mo_energy =
[-14.569304 -14.56928   -0.878386  -0.683861  -0.398032  -0.354328  -0.354328  -0.177278  -0.177278  -0.007994   0.53516    0.623276   0.670819   0.670819
   0.773337   0.773337   0.849165   0.87774    1.870919   1.913444   1.913444   2.056885   2.056889   2.112136   2.11214    2.327022   2.327022   2.870983]
nelec by numeric integration = 14.000000807603357
    CPU time for vxc      0.83 sec, wall time      0.02 sec
E1 = -177.67910154096316  Ecoul = 66.55793449908656  Exc = -13.11483603774353
cycle= 3 E= -108.983248176632  delta_E= -0.00546  |g|= 0.00276  |ddm|= 0.157
    CPU time for cycle= 3      1.01 sec, wall time      0.02 sec
  HOMO = -0.355174621539021  LUMO = -0.178097517529679
  mo_energy =
[-14.571933 -14.571909  -0.879298  -0.68471   -0.399087  -0.355175  -0.355175  -0.178098  -0.178098  -0.008902   0.534699   0.622763   0.670202   0.670202
   0.772761   0.772761   0.84843    0.877244   1.870106   1.912653   1.912653   2.056105   2.056109   2.111361   2.111364   2.326253   2.326253   2.870191]
nelec by numeric integration = 14.000000808438148
    CPU time for vxc      0.97 sec, wall time      0.02 sec
E1 = -177.6883151296397  Ecoul = 66.56858134285939  Exc = -13.116271344260143
cycle= 4 E= -108.983250228052  delta_E= -2.05e-06  |g|= 0.000281  |ddm|= 0.0033
    CPU time for cycle= 4      1.75 sec, wall time      0.04 sec
  HOMO = -0.355156733001375  LUMO = -0.178064141750036
  mo_energy =
[-14.571828 -14.571803  -0.8793    -0.684654  -0.399049  -0.355157  -0.355157  -0.178064  -0.178064  -0.008875   0.534726   0.622815   0.670219   0.670219
   0.772783   0.772783   0.848434   0.877247   1.870133   1.912676   1.912676   2.056125   2.056128   2.111381   2.111384   2.32628    2.32628    2.870219]
nelec by numeric integration = 14.000000808391768
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -177.68796982451383  Ecoul = 66.56816368921605  Exc = -13.116199010625111
cycle= 5 E= -108.983250242935  delta_E= -1.49e-08  |g|= 2.19e-05  |ddm|= 0.000232
    CPU time for cycle= 5      0.99 sec, wall time      0.02 sec
  HOMO = -0.355163808622909  LUMO = -0.178072884613534
  mo_energy =
[-14.571843 -14.571819  -0.879307  -0.684661  -0.399056  -0.355164  -0.355164  -0.178073  -0.178073  -0.008884   0.534719   0.622808   0.670209   0.670209
   0.772775   0.772775   0.848426   0.87724    1.870124   1.912666   1.912666   2.056114   2.056118   2.111371   2.111374   2.32627    2.32627    2.87021 ]
nelec by numeric integration = 14.000000808398646
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -177.6880446079641  Ecoul = 66.56824941840674  Exc = -13.11620995650239
cycle= 6 E= -108.983250243071  delta_E= -1.37e-10  |g|= 5.49e-07  |ddm|= 2.12e-05
    CPU time for cycle= 6      1.00 sec, wall time      0.02 sec
  HOMO = -0.355164023857294  LUMO = -0.178073104835225
  mo_energy =
[-14.571844 -14.57182   -0.879307  -0.684661  -0.399056  -0.355164  -0.355164  -0.178073  -0.178073  -0.008884   0.534719   0.622808   0.670209   0.670209
   0.772775   0.772775   0.848426   0.87724    1.870124   1.912666   1.912666   2.056114   2.056117   2.111371   2.111374   2.32627    2.32627    2.87021 ]
nelec by numeric integration = 14.000000808398907
    CPU time for vxc      0.83 sec, wall time      0.02 sec
E1 = -177.68804688655644  Ecoul = 66.56825205331907  Exc = -13.116210312822497
Extra cycle  E= -108.983250243072  delta_E= -1.14e-13  |g|= 2.47e-07  |ddm|= 6.98e-07
    CPU time for scf_cycle     11.48 sec, wall time      0.24 sec
    CPU time for SCF     11.51 sec, wall time      0.24 sec
converged SCF energy = -108.983250243072
             #0      #1      #2      #3      #4      #5     
  0 N 1s       0.700   0.700   0.207  -0.225                
  0 N 2s                       0.441  -0.495   0.127        
  0 N 3s                       0.235  -0.331   0.152        
  0 N 2px                                              0.390
  0 N 2py                                             -0.201
  0 N 2pz                     -0.102           0.451        
  0 N 3px                                             -0.283
  0 N 3py                                              0.146
  0 N 3pz                                     -0.270        
  1 N 1s      -0.700   0.700   0.207   0.225                
  1 N 2s                       0.441   0.495   0.127        
  1 N 3s                       0.235   0.331   0.152        
  1 N 2px                                              0.390
  1 N 2py                                             -0.201
  1 N 2pz                      0.102          -0.451        
  1 N 3px                                             -0.283
  1 N 3py                                              0.146
  1 N 3pz                                      0.270        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                       0.215   0.164
  0 N 2s                               0.226   1.129   0.914
  0 N 3s                               0.291  -1.031  -0.946
  0 N 2px      0.201   0.207  -0.446                        
  0 N 2py      0.390  -0.446  -0.207                        
  0 N 2pz                             -0.528   0.130   0.447
  0 N 3px     -0.146  -0.159   0.343                        
  0 N 3py     -0.283   0.343   0.159                        
  0 N 3pz                              0.560   0.176   0.423
  1 N 1s                                       0.215  -0.164
  1 N 2s                              -0.226   1.129  -0.914
  1 N 3s                              -0.291  -1.031   0.946
  1 N 2px      0.201  -0.207   0.446                        
  1 N 2py      0.390   0.446   0.207                        
  1 N 2pz                             -0.528  -0.130   0.447
  1 N 3px     -0.146   0.159  -0.343                        
  1 N 3py     -0.283  -0.343  -0.159                        
  1 N 3pz                              0.560  -0.176   0.423
[-14.571844 -14.57182   -0.879307  -0.684661  -0.399056  -0.355164  -0.355164  -0.178073  -0.178073  -0.008884   0.534719   0.622808]
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 14.000000808398907
    CPU time for vxc      0.79 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 3.63  e= [2.376056]  max|de|= 2.38  lindep= 0.978
davidson 1 2  |r|= 2.87  e= [1.651127]  max|de|= -0.725  lindep= 0.495
davidson 2 3  |r|= 1.73  e= [1.257146]  max|de|= -0.394  lindep= 0.793
davidson 3 4  |r|= 1.44  e= [1.229746]  max|de|= -0.0274  lindep= 0.256
davidson 4 5  |r|= 0.748  e= [0.99478]  max|de|= -0.235  lindep= 0.323
davidson 5 6  |r|= 0.685  e= [0.821654]  max|de|= -0.173  lindep= 0.605
davidson 6 7  |r|= 0.763  e= [0.486427]  max|de|= -0.335  lindep= 0.613
davidson 7 8  |r|= 0.246  e= [0.363371]  max|de|= -0.123  lindep= 0.651
davidson 8 9  |r|= 0.14  e= [0.338172]  max|de|= -0.0252  lindep= 0.856
davidson 9 10  |r|= 0.125  e= [0.326843]  max|de|= -0.0113  lindep= 0.622
davidson 10 11  |r|= 0.0502  e= [0.321928]  max|de|= -0.00491  lindep= 0.767
davidson 11 12  |r|= 0.0129  e= [0.321426]  max|de|= -0.000503  lindep= 0.837
davidson 12 1  |r|= 0.0129  e= [0.321426]  max|de|= -1.33e-15  lindep=    1
root 0 converged  |r|= 0.00476  e= 0.32139844152172325  max|de|= -2.72e-05
converged 13 2  |r|= 0.00476  e= [0.321398]  max|de|= -2.72e-05
RHF/RKS wavefunction is stable in the internal stability analysis
             #0      #1      #2      #3      #4      #5     
  0 N 1s       0.700   0.700   0.207  -0.225                
  0 N 2s                       0.441  -0.495   0.127        
  0 N 3s                       0.235  -0.331   0.152        
  0 N 2px                                              0.390
  0 N 2py                                             -0.201
  0 N 2pz                     -0.102           0.451        
  0 N 3px                                             -0.283
  0 N 3py                                              0.146
  0 N 3pz                                     -0.270        
  1 N 1s      -0.700   0.700   0.207   0.225                
  1 N 2s                       0.441   0.495   0.127        
  1 N 3s                       0.235   0.331   0.152        
  1 N 2px                                              0.390
  1 N 2py                                             -0.201
  1 N 2pz                      0.102          -0.451        
  1 N 3px                                             -0.283
  1 N 3py                                              0.146
  1 N 3pz                                      0.270        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                       0.215   0.164
  0 N 2s                               0.226   1.129   0.914
  0 N 3s                               0.291  -1.031  -0.946
  0 N 2px      0.201   0.207  -0.446                        
  0 N 2py      0.390  -0.446  -0.207                        
  0 N 2pz                             -0.528   0.130   0.447
  0 N 3px     -0.146  -0.159   0.343                        
  0 N 3py     -0.283   0.343   0.159                        
  0 N 3pz                              0.560   0.176   0.423
  1 N 1s                                       0.215  -0.164
  1 N 2s                              -0.226   1.129  -0.914
  1 N 3s                              -0.291  -1.031   0.946
  1 N 2px      0.201  -0.207   0.446                        
  1 N 2py      0.390   0.446   0.207                        
  1 N 2pz                             -0.528  -0.130   0.447
  1 N 3px     -0.146   0.159  -0.343                        
  1 N 3py     -0.283  -0.343  -0.159                        
  1 N 3pz                              0.560  -0.176   0.423
[-14.571844 -14.57182   -0.879307  -0.684661  -0.399056  -0.355164  -0.355164  -0.178073  -0.178073  -0.008884   0.534719   0.622808]
scan 1.70, -108.983250
#INFO: **** input file is /share/home/srwang/pyAutoMR/examples/guess/N2-RKS.py ****
from pyscf import gto, dft
from automr import guess, dump_mat
import numpy as np
#mf=guess.from_fch_simp("v2.fchk", xc='pbe0')

#mf2.verbose=9
#mf2.stability()
for r in np.arange(1.5, 3.0, 0.1):
    mol = gto.Mole(atom='''N 0.0 0.0 0.0; N 0.0 0.0 %f'''%r, basis='def2-svp', verbose=5).build()
    mf = dft.RKS(mol)
    mf.xc = 'pbe0'
    mf.kernel()
    dump_mat.dump_mo(mol, mf.mo_coeff[:,:12])
    print(mf.mo_energy[:12])
    
    mf2 = guess.check_stab(mf, newton=True, res=True)
    dump_mat.dump_mo(mol, mf2.mo_coeff[:,:12])
    print(mf2.mo_energy[:12])
    print('scan %.2f, %.6f' % (r, mf2.e_tot))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='xc06n05', release='3.10.0-1127.el7.x86_64', version='#1 SMP Tue Feb 18 16:39:12 EST 2020', machine='x86_64', processor='x86_64')  Threads 48
Python 3.7.4 (default, Aug 13 2019, 20:35:49) 
[GCC 7.3.0]
numpy 1.17.2  scipy 1.4.1
Date: Thu Sep 16 17:41:36 2021
PySCF version 1.7.6a1
PySCF path  /share/home/srwang/pyscf/pyscf
GIT ORIG_HEAD 80f71dfe77ac5f9caae26788acf76446987635bd
GIT HEAD      ref: refs/heads/master
GIT master branch  80f71dfe77ac5f9caae26788acf76446987635bd

[ENV] PYSCF_EXT_PATH /share/home/srwang/pyscf_ext/fciqmc:
[CONFIG] conf_file /share/home/srwang/.pyscf_conf.py
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 2
[INPUT] num. electrons = 14
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 N      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 N      0.000000000000   0.000000000000   1.800000000000 AA    0.000000000000   0.000000000000   3.401507024217 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] N
[INPUT] 0    0    [5    /1   ]  1712.8415853      -0.0053934125305
                                257.64812677      -0.040221581118
                                58.458245853      -0.1793114499
                                16.198367905      -0.46376317823
                                5.0052600809      -0.44171422662
[INPUT] 0    0    [1    /1   ]  0.58731856571        1
[INPUT] 0    0    [1    /1   ]  0.18764592253        1
[INPUT] 1    0    [3    /1   ]  13.571470233      -0.040072398852
                                2.9257372874      -0.21807045028
                                0.79927750754     -0.51294466049
[INPUT] 1    0    [1    /1   ]  0.21954348034        1
[INPUT] 2    0    [1    /1   ]  1                    1

nuclear repulsion = 14.4053796306
number of shells = 12
number of NR pGTOs = 48
number of NR cGTOs = 28
basis = def2-svp
ecp = {}
CPU time:        64.34


******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmp074bzvkj
max_memory 4000 MB (current use 257 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2aaf78ea5830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2aaf78ea5cb0>
Set gradient conv threshold to 3.16228e-05
atom N rad-grids = 75, ang-grids = [ 50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  86  86  86  86  86  86  86  86  86 266 266 266 266 266 266 266
 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266]
tot grids = 28092
Drop grids 3830
    CPU time for setting up grids      0.24 sec, wall time      0.01 sec
nelec by numeric integration = 13.992333703848473
    CPU time for vxc      0.80 sec, wall time      0.02 sec
E1 = -177.08057157584298  Ecoul = 67.27598867048282  Exc = -13.186851183740275
init E= -108.5860544585
cond(S) = 52.826617742526345
    CPU time for initialize scf      1.80 sec, wall time      0.04 sec
  HOMO = -0.249996003466726  LUMO = -0.152038917655603
  mo_energy =
[-14.380144 -14.380128  -0.794889  -0.623018  -0.292422  -0.249996  -0.249996  -0.152039  -0.152039  -0.001933   0.576478   0.65742    0.721964   0.721964
   0.823182   0.823182   0.922206   0.927327   1.92699    2.030952   2.030952   2.135542   2.135545   2.167203   2.167206   2.318261   2.318261   2.813414]
nelec by numeric integration = 14.000001868719059
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -175.03134939140946  Ecoul = 64.65744406381498  Exc = -12.944344538835342
cycle= 1 E= -108.91287023583  delta_E= -0.327  |g|= 0.261  |ddm|= 1.55
    CPU time for cycle= 1      1.10 sec, wall time      0.02 sec
  HOMO = -0.391462736831526  LUMO = -0.240788007906916
  mo_energy =
[-14.704555 -14.704553  -0.908769  -0.747047  -0.438975  -0.391463  -0.391463  -0.240788  -0.240788  -0.110449   0.503644   0.586681   0.621202   0.621202
   0.736026   0.736026   0.813802   0.853266   1.811092   1.91572    1.91572    2.018522   2.018526   2.052621   2.052625   2.205395   2.205395   2.699099]
nelec by numeric integration = 14.000002171223628
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -176.50118965944222  Ecoul = 66.33407723401243  Exc = -13.163469673435134
cycle= 2 E= -108.925202468265  delta_E= -0.0123  |g|= 0.143  |ddm|= 0.439
    CPU time for cycle= 2      0.99 sec, wall time      0.02 sec
  HOMO = -0.34266651357992  LUMO = -0.188874662974889
  mo_energy =
[-14.572813 -14.57281   -0.854176  -0.697068  -0.388028  -0.342667  -0.342667  -0.188875  -0.188875  -0.050856   0.534635   0.617106   0.663705   0.663705
   0.773224   0.773224   0.859488   0.886154   1.862831   1.96609    1.96609    2.068206   2.06821    2.102353   2.102356   2.25648    2.25648    2.751012]
nelec by numeric integration = 14.000002060961407
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -175.9723280867386  Ecoul = 65.71865232999224  Exc = -13.082540674951021
cycle= 3 E= -108.930836801097  delta_E= -0.00563  |g|= 0.00233  |ddm|= 0.161
    CPU time for cycle= 3      0.99 sec, wall time      0.02 sec
  HOMO = -0.343343319746894  LUMO = -0.189520937092938
  mo_energy =
[-14.575006 -14.575004  -0.854872  -0.697765  -0.388869  -0.343343  -0.343343  -0.189521  -0.189521  -0.051536   0.534281   0.616706   0.663241   0.663241
   0.772779   0.772779   0.858904   0.885778   1.862228   1.965489   1.965489   2.067605   2.067609   2.101756   2.10176    2.255904   2.255904   2.750427]
nelec by numeric integration = 14.000002062295671
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -175.9799025287858  Ecoul = 65.72745679949317  Exc = -13.083772212595294
cycle= 4 E= -108.930838311288  delta_E= -1.51e-06  |g|= 0.000293  |ddm|= 0.00302
    CPU time for cycle= 4      0.99 sec, wall time      0.02 sec
  HOMO = -0.343330746245957  LUMO = -0.189494784235985
  mo_energy =
[-14.574918 -14.574916  -0.854878  -0.69772   -0.388841  -0.343331  -0.343331  -0.189495  -0.189495  -0.051517   0.534304   0.616755   0.663252   0.663252
   0.772797   0.772797   0.858901   0.885775   1.862247   1.965505   1.965505   2.06762    2.067623   2.101771   2.101775   2.255924   2.255924   2.750446]
nelec by numeric integration = 14.000002062276671
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -175.9796212606533  Ecoul = 65.72711218951756  Exc = -13.083708886813126
cycle= 5 E= -108.930838327349  delta_E= -1.61e-08  |g|= 1.41e-05  |ddm|= 0.000206
    CPU time for cycle= 5      0.99 sec, wall time      0.02 sec
  HOMO = -0.34333474874383  LUMO = -0.18950043781229
  mo_energy =
[-14.574925 -14.574923  -0.854883  -0.697723  -0.388846  -0.343335  -0.343335  -0.1895    -0.1895    -0.051523   0.534299   0.61675    0.663245   0.663245
   0.772791   0.772791   0.858895   0.88577    1.862241   1.965498   1.965498   2.067612   2.067616   2.101763   2.101767   2.255917   2.255917   2.750439]
nelec by numeric integration = 14.000002062284327
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -175.97966454727208  Ecoul = 65.72716156090917  Exc = -13.083714971640779
cycle= 6 E= -108.930838327404  delta_E= -5.48e-11  |g|= 5.32e-07  |ddm|= 1.29e-05
    CPU time for cycle= 6      0.99 sec, wall time      0.02 sec
  HOMO = -0.343334976568413  LUMO = -0.189500650507104
  mo_energy =
[-14.574926 -14.574924  -0.854883  -0.697723  -0.388846  -0.343335  -0.343335  -0.189501  -0.189501  -0.051523   0.534299   0.616749   0.663245   0.663245
   0.772791   0.772791   0.858895   0.88577    1.86224    1.965498   1.965498   2.067612   2.067616   2.101763   2.101767   2.255917   2.255917   2.750439]
nelec by numeric integration = 14.000002062284775
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -175.97966688968478  Ecoul = 65.72716427244177  Exc = -13.083715340760815
Extra cycle  E= -108.930838327404  delta_E= -1.42e-13  |g|= 2.54e-07  |ddm|= 6.99e-07
    CPU time for scf_cycle      8.83 sec, wall time      0.18 sec
    CPU time for SCF      8.85 sec, wall time      0.18 sec
converged SCF energy = -108.930838327404
             #0      #1      #2      #3      #4      #5     
  0 N 1s       0.701  -0.700   0.208  -0.226                
  0 N 2s                       0.445  -0.497   0.120        
  0 N 3s                       0.248  -0.321   0.128        
  0 N 2px                                              0.424
  0 N 2py                                              0.121
  0 N 2pz                                      0.447        
  0 N 3px                                             -0.312
  0 N 3pz                                     -0.280        
  1 N 1s       0.700   0.700   0.208   0.226                
  1 N 2s                       0.445   0.497   0.120        
  1 N 3s                       0.248   0.321   0.128        
  1 N 2px                                              0.424
  1 N 2py                                              0.121
  1 N 2pz                                     -0.447        
  1 N 3px                                             -0.312
  1 N 3pz                                      0.280        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                       0.216   0.168
  0 N 2s                              -0.196   1.125   0.931
  0 N 3s                              -0.206  -1.036  -0.966
  0 N 2px     -0.121  -0.389  -0.297                        
  0 N 2py      0.424   0.297  -0.389                        
  0 N 2pz                              0.526   0.125   0.431
  0 N 3px              0.293   0.224                        
  0 N 3py     -0.312  -0.224   0.293                        
  0 N 3pz                             -0.501   0.188   0.408
  1 N 1s                                       0.216  -0.168
  1 N 2s                               0.196   1.125  -0.931
  1 N 3s                               0.206  -1.036   0.966
  1 N 2px     -0.121   0.389   0.297                        
  1 N 2py      0.424  -0.297   0.389                        
  1 N 2pz                              0.526  -0.125   0.431
  1 N 3px             -0.293  -0.224                        
  1 N 3py     -0.312   0.224  -0.293                        
  1 N 3pz                             -0.501  -0.188   0.408
[-14.574926 -14.574924  -0.854883  -0.697723  -0.388846  -0.343335  -0.343335  -0.189501  -0.189501  -0.051523   0.534299   0.616749]
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 14.000002062284771
    CPU time for vxc      0.80 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 2.89  e= [1.549612]  max|de|= 1.55  lindep= 0.938
davidson 1 2  |r|= 2.34  e= [1.26069]  max|de|= -0.289  lindep= 0.456
davidson 2 3  |r|= 1.54  e= [1.068764]  max|de|= -0.192  lindep= 0.827
davidson 3 4  |r|= 0.306  e= [0.868426]  max|de|= -0.2  lindep= 0.945
davidson 4 5  |r|= 0.396  e= [0.499572]  max|de|= -0.369  lindep= 0.692
davidson 5 6  |r|= 0.253  e= [0.465425]  max|de|= -0.0341  lindep= 0.649
davidson 6 7  |r|= 0.591  e= [0.319444]  max|de|= -0.146  lindep= 0.671
davidson 7 8  |r|= 0.173  e= [0.237627]  max|de|= -0.0818  lindep= 0.92
davidson 8 9  |r|= 0.032  e= [0.232822]  max|de|= -0.0048  lindep= 0.643
davidson 9 10  |r|= 0.0221  e= [0.232184]  max|de|= -0.000638  lindep= 0.714
davidson 10 11  |r|= 0.00752  e= [0.232048]  max|de|= -0.000137  lindep= 0.703
root 0 converged  |r|= 0.00161  e= 0.23203516243279357  max|de|= -1.24e-05
converged 11 12  |r|= 0.00161  e= [0.232035]  max|de|= -1.24e-05
RHF/RKS wavefunction is stable in the internal stability analysis
             #0      #1      #2      #3      #4      #5     
  0 N 1s       0.701  -0.700   0.208  -0.226                
  0 N 2s                       0.445  -0.497   0.120        
  0 N 3s                       0.248  -0.321   0.128        
  0 N 2px                                              0.424
  0 N 2py                                              0.121
  0 N 2pz                                      0.447        
  0 N 3px                                             -0.312
  0 N 3pz                                     -0.280        
  1 N 1s       0.700   0.700   0.208   0.226                
  1 N 2s                       0.445   0.497   0.120        
  1 N 3s                       0.248   0.321   0.128        
  1 N 2px                                              0.424
  1 N 2py                                              0.121
  1 N 2pz                                     -0.447        
  1 N 3px                                             -0.312
  1 N 3pz                                      0.280        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                       0.216   0.168
  0 N 2s                              -0.196   1.125   0.931
  0 N 3s                              -0.206  -1.036  -0.966
  0 N 2px     -0.121  -0.389  -0.297                        
  0 N 2py      0.424   0.297  -0.389                        
  0 N 2pz                              0.526   0.125   0.431
  0 N 3px              0.293   0.224                        
  0 N 3py     -0.312  -0.224   0.293                        
  0 N 3pz                             -0.501   0.188   0.408
  1 N 1s                                       0.216  -0.168
  1 N 2s                               0.196   1.125  -0.931
  1 N 3s                               0.206  -1.036   0.966
  1 N 2px     -0.121   0.389   0.297                        
  1 N 2py      0.424  -0.297   0.389                        
  1 N 2pz                              0.526  -0.125   0.431
  1 N 3px             -0.293  -0.224                        
  1 N 3py     -0.312   0.224  -0.293                        
  1 N 3pz                             -0.501  -0.188   0.408
[-14.574926 -14.574924  -0.854883  -0.697723  -0.388846  -0.343335  -0.343335  -0.189501  -0.189501  -0.051523   0.534299   0.616749]
scan 1.80, -108.930838
#INFO: **** input file is /share/home/srwang/pyAutoMR/examples/guess/N2-RKS.py ****
from pyscf import gto, dft
from automr import guess, dump_mat
import numpy as np
#mf=guess.from_fch_simp("v2.fchk", xc='pbe0')

#mf2.verbose=9
#mf2.stability()
for r in np.arange(1.5, 3.0, 0.1):
    mol = gto.Mole(atom='''N 0.0 0.0 0.0; N 0.0 0.0 %f'''%r, basis='def2-svp', verbose=5).build()
    mf = dft.RKS(mol)
    mf.xc = 'pbe0'
    mf.kernel()
    dump_mat.dump_mo(mol, mf.mo_coeff[:,:12])
    print(mf.mo_energy[:12])
    
    mf2 = guess.check_stab(mf, newton=True, res=True)
    dump_mat.dump_mo(mol, mf2.mo_coeff[:,:12])
    print(mf2.mo_energy[:12])
    print('scan %.2f, %.6f' % (r, mf2.e_tot))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='xc06n05', release='3.10.0-1127.el7.x86_64', version='#1 SMP Tue Feb 18 16:39:12 EST 2020', machine='x86_64', processor='x86_64')  Threads 48
Python 3.7.4 (default, Aug 13 2019, 20:35:49) 
[GCC 7.3.0]
numpy 1.17.2  scipy 1.4.1
Date: Thu Sep 16 17:41:37 2021
PySCF version 1.7.6a1
PySCF path  /share/home/srwang/pyscf/pyscf
GIT ORIG_HEAD 80f71dfe77ac5f9caae26788acf76446987635bd
GIT HEAD      ref: refs/heads/master
GIT master branch  80f71dfe77ac5f9caae26788acf76446987635bd

[ENV] PYSCF_EXT_PATH /share/home/srwang/pyscf_ext/fciqmc:
[CONFIG] conf_file /share/home/srwang/.pyscf_conf.py
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 2
[INPUT] num. electrons = 14
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 N      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 N      0.000000000000   0.000000000000   1.900000000000 AA    0.000000000000   0.000000000000   3.590479636674 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] N
[INPUT] 0    0    [5    /1   ]  1712.8415853      -0.0053934125305
                                257.64812677      -0.040221581118
                                58.458245853      -0.1793114499
                                16.198367905      -0.46376317823
                                5.0052600809      -0.44171422662
[INPUT] 0    0    [1    /1   ]  0.58731856571        1
[INPUT] 0    0    [1    /1   ]  0.18764592253        1
[INPUT] 1    0    [3    /1   ]  13.571470233      -0.040072398852
                                2.9257372874      -0.21807045028
                                0.79927750754     -0.51294466049
[INPUT] 1    0    [1    /1   ]  0.21954348034        1
[INPUT] 2    0    [1    /1   ]  1                    1

nuclear repulsion = 13.6472017553053
number of shells = 12
number of NR pGTOs = 48
number of NR cGTOs = 28
basis = def2-svp
ecp = {}
CPU time:        79.01


******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpnagnvxen
max_memory 4000 MB (current use 257 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2aaf78ea5830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2aaf78ea5cb0>
Set gradient conv threshold to 3.16228e-05
atom N rad-grids = 75, ang-grids = [ 50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  86  86  86  86  86  86  86  86  86 266 266 266 266 266 266 266
 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266]
tot grids = 28092
Drop grids 3780
    CPU time for setting up grids      0.24 sec, wall time      0.01 sec
nelec by numeric integration = 13.992326285998406
    CPU time for vxc      0.80 sec, wall time      0.02 sec
E1 = -175.57539666732896  Ecoul = 66.54432997779769  Exc = -13.168313096610664
init E= -108.552178030837
cond(S) = 41.84254192033272
    CPU time for initialize scf      1.71 sec, wall time      0.04 sec
  HOMO = -0.240395822061226  LUMO = -0.15987542968061
  mo_energy =
[-14.379204 -14.379196  -0.773025  -0.633527  -0.283186  -0.240396  -0.240396  -0.159875  -0.159875  -0.03608    0.575605   0.653498   0.716363   0.716363
   0.824107   0.824107   0.915322   0.940548   1.956094   2.073939   2.073939   2.143414   2.143415   2.16179    2.161792   2.265339   2.265339   2.694744]
nelec by numeric integration = 14.000002050563321
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -173.50454974511507  Ecoul = 63.90677182716572  Exc = -12.915294421398514
cycle= 1 E= -108.865870584043  delta_E= -0.314  |g|= 0.261  |ddm|= 1.55
    CPU time for cycle= 1      1.02 sec, wall time      0.02 sec
  HOMO = -0.381096212382844  LUMO = -0.249781046973967
  mo_energy =
[-14.70755  -14.707535  -0.887023  -0.758524  -0.428378  -0.381096  -0.381096  -0.249781  -0.249781  -0.142746   0.501571   0.580942   0.615935   0.615935
   0.735585   0.735585   0.804683   0.864485   1.841237   1.958601   1.958601   2.0263     2.026302   2.046846   2.046848   2.152487   2.152487   2.580833]
nelec by numeric integration = 14.00000227780744
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -174.97694746852423  Ecoul = 65.59126348684737  Exc = -13.13982753787673
cycle= 2 E= -108.878309764248  delta_E= -0.0124  |g|= 0.144  |ddm|= 0.448
    CPU time for cycle= 2      0.99 sec, wall time      0.02 sec
  HOMO = -0.332760998572679  LUMO = -0.198135121495803
  mo_energy =
[-14.574811 -14.574791  -0.834523  -0.70804   -0.377849  -0.332761  -0.332761  -0.198135  -0.198135  -0.084557   0.532702   0.611873   0.6579     0.6579
   0.772985   0.772985   0.851059   0.897819   1.891571   2.008379   2.008379   2.075694   2.075696   2.096285   2.096287   2.20284    2.20284    2.631848]
nelec by numeric integration = 14.00000220048854
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -174.4473759442149  Ecoul = 64.97302010403311  Exc = -13.056944887864837
cycle= 3 E= -108.884098972741  delta_E= -0.00579  |g|= 0.00187  |ddm|= 0.163
    CPU time for cycle= 3      0.99 sec, wall time      0.02 sec
  HOMO = -0.33325414785611  LUMO = -0.198595310398482
  mo_energy =
[-14.576528 -14.576509  -0.834998  -0.70857   -0.378468  -0.333254  -0.333254  -0.198595  -0.198595  -0.084994   0.532458   0.611574   0.657604   0.657604
   0.772684   0.772684   0.850669   0.897583   1.891172   2.007976   2.007976   2.075285   2.075287   2.095879   2.095881   2.202464   2.202464   2.631476]
nelec by numeric integration = 14.000002201051121
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -174.45317453343768  Ecoul = 64.97981973520405  Exc = -13.057946989630763
cycle= 4 E= -108.884100032559  delta_E= -1.06e-06  |g|= 0.00035  |ddm|= 0.00275
    CPU time for cycle= 4      0.99 sec, wall time      0.02 sec
  HOMO = -0.333244275294255  LUMO = -0.198571157832476
  mo_energy =
[-14.576445 -14.576427  -0.835008  -0.708527  -0.378445  -0.333244  -0.333244  -0.198571  -0.198571  -0.084977   0.53248    0.611628   0.657613   0.657613
   0.7727     0.7727     0.850663   0.897575   1.891189   2.007991   2.007991   2.075299   2.075301   2.095893   2.095895   2.202482   2.202482   2.631491]
nelec by numeric integration = 14.000002201124325
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -174.45290586983643  Ecoul = 64.97948640859887  Exc = -13.057882349457378
cycle= 5 E= -108.88410005539  delta_E= -2.28e-08  |g|= 1.04e-05  |ddm|= 0.000216
    CPU time for cycle= 5      0.99 sec, wall time      0.02 sec
  HOMO = -0.33324625622555  LUMO = -0.198574818688666
  mo_energy =
[-14.576447 -14.576428  -0.835011  -0.708529  -0.378447  -0.333246  -0.333246  -0.198575  -0.198575  -0.084981   0.532476   0.611624   0.657607   0.657607
   0.772696   0.772696   0.850658   0.897571   1.891184   2.007986   2.007986   2.075293   2.075295   2.095888   2.09589    2.202476   2.202476   2.631486]
nelec by numeric integration = 14.000002201129805
    CPU time for vxc      0.80 sec, wall time      0.02 sec
E1 = -174.4529294029055  Ecoul = 64.97951288162052  Exc = -13.057885289435472
cycle= 6 E= -108.884100055415  delta_E= -2.55e-11  |g|= 4.7e-07  |ddm|= 8.86e-06
    CPU time for cycle= 6      0.99 sec, wall time      0.02 sec
  HOMO = -0.333246484629838  LUMO = -0.198575011246117
  mo_energy =
[-14.576447 -14.576429  -0.835011  -0.708529  -0.378447  -0.333246  -0.333246  -0.198575  -0.198575  -0.084981   0.532476   0.611624   0.657607   0.657607
   0.772696   0.772696   0.850658   0.897571   1.891184   2.007986   2.007986   2.075293   2.075295   2.095888   2.09589    2.202476   2.202476   2.631486]
nelec by numeric integration = 14.000002201130131
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -174.45293164768145  Ecoul = 64.97951547727358  Exc = -13.057885640312492
Extra cycle  E= -108.884100055415  delta_E= 9.95e-14  |g|= 2.8e-07  |ddm|= 6.5e-07
    CPU time for scf_cycle      8.65 sec, wall time      0.18 sec
    CPU time for SCF      8.67 sec, wall time      0.18 sec
converged SCF energy = -108.884100055415
             #0      #1      #2      #3      #4      #5     
  0 N 1s       0.700   0.700   0.210   0.227                
  0 N 2s                       0.449   0.499  -0.111        
  0 N 3s                       0.259   0.314  -0.107        
  0 N 2px                                              0.350
  0 N 2py                                              0.271
  0 N 2pz                                     -0.444        
  0 N 3px                                             -0.260
  0 N 3py                                             -0.201
  0 N 3pz                                      0.288        
  1 N 1s       0.700  -0.700   0.210  -0.227                
  1 N 2s                       0.449  -0.499  -0.111        
  1 N 3s                       0.259  -0.314  -0.107        
  1 N 2px                                              0.350
  1 N 2py                                              0.271
  1 N 2pz                                      0.444        
  1 N 3px                                             -0.260
  1 N 3py                                             -0.201
  1 N 3pz                                     -0.288        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                       0.217  -0.172
  0 N 2s                              -0.171   1.124  -0.948
  0 N 3s                              -0.147  -1.041   0.988
  0 N 2px     -0.271   0.367  -0.319                        
  0 N 2py      0.350   0.319   0.367                        
  0 N 2pz                              0.523   0.111  -0.414
  0 N 3px      0.201  -0.273   0.237                        
  0 N 3py     -0.260  -0.237  -0.273                        
  0 N 3pz                             -0.460   0.186  -0.388
  1 N 1s                                       0.217   0.172
  1 N 2s                               0.171   1.124   0.948
  1 N 3s                               0.147  -1.041  -0.988
  1 N 2px     -0.271  -0.367   0.319                        
  1 N 2py      0.350  -0.319  -0.367                        
  1 N 2pz                              0.523  -0.111  -0.414
  1 N 3px      0.201   0.273  -0.237                        
  1 N 3py     -0.260   0.237   0.273                        
  1 N 3pz                             -0.460  -0.186  -0.388
[-14.576447 -14.576429  -0.835011  -0.708529  -0.378447  -0.333246  -0.333246  -0.198575  -0.198575  -0.084981   0.532476   0.611624]
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 14.000002201130131
    CPU time for vxc      0.79 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 3.53  e= [1.975534]  max|de|= 1.98  lindep= 0.968
davidson 1 2  |r|= 2.15  e= [1.107361]  max|de|= -0.868  lindep= 0.749
davidson 2 3  |r|= 1.27  e= [0.757012]  max|de|= -0.35  lindep= 0.565
davidson 3 4  |r|= 0.462  e= [0.49633]  max|de|= -0.261  lindep= 0.652
davidson 4 5  |r|= 0.42  e= [0.371365]  max|de|= -0.125  lindep= 0.73
davidson 5 6  |r|= 0.419  e= [0.196816]  max|de|= -0.175  lindep= 0.808
davidson 6 7  |r|= 0.0911  e= [0.160295]  max|de|= -0.0365  lindep= 0.777
davidson 7 8  |r|= 0.0236  e= [0.158494]  max|de|= -0.0018  lindep= 0.819
davidson 8 9  |r|= 0.00773  e= [0.158384]  max|de|= -0.00011  lindep= 0.825
root 0 converged  |r|= 0.00123  e= 0.15837306714365612  max|de|= -1.12e-05
converged 9 10  |r|= 0.00123  e= [0.158373]  max|de|= -1.12e-05
RHF/RKS wavefunction is stable in the internal stability analysis
             #0      #1      #2      #3      #4      #5     
  0 N 1s       0.700   0.700   0.210   0.227                
  0 N 2s                       0.449   0.499  -0.111        
  0 N 3s                       0.259   0.314  -0.107        
  0 N 2px                                              0.350
  0 N 2py                                              0.271
  0 N 2pz                                     -0.444        
  0 N 3px                                             -0.260
  0 N 3py                                             -0.201
  0 N 3pz                                      0.288        
  1 N 1s       0.700  -0.700   0.210  -0.227                
  1 N 2s                       0.449  -0.499  -0.111        
  1 N 3s                       0.259  -0.314  -0.107        
  1 N 2px                                              0.350
  1 N 2py                                              0.271
  1 N 2pz                                      0.444        
  1 N 3px                                             -0.260
  1 N 3py                                             -0.201
  1 N 3pz                                     -0.288        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                       0.217  -0.172
  0 N 2s                              -0.171   1.124  -0.948
  0 N 3s                              -0.147  -1.041   0.988
  0 N 2px     -0.271   0.367  -0.319                        
  0 N 2py      0.350   0.319   0.367                        
  0 N 2pz                              0.523   0.111  -0.414
  0 N 3px      0.201  -0.273   0.237                        
  0 N 3py     -0.260  -0.237  -0.273                        
  0 N 3pz                             -0.460   0.186  -0.388
  1 N 1s                                       0.217   0.172
  1 N 2s                               0.171   1.124   0.948
  1 N 3s                               0.147  -1.041  -0.988
  1 N 2px     -0.271  -0.367   0.319                        
  1 N 2py      0.350  -0.319  -0.367                        
  1 N 2pz                              0.523  -0.111  -0.414
  1 N 3px      0.201   0.273  -0.237                        
  1 N 3py     -0.260   0.237   0.273                        
  1 N 3pz                             -0.460  -0.186  -0.388
[-14.576447 -14.576429  -0.835011  -0.708529  -0.378447  -0.333246  -0.333246  -0.198575  -0.198575  -0.084981   0.532476   0.611624]
scan 1.90, -108.884100
#INFO: **** input file is /share/home/srwang/pyAutoMR/examples/guess/N2-RKS.py ****
from pyscf import gto, dft
from automr import guess, dump_mat
import numpy as np
#mf=guess.from_fch_simp("v2.fchk", xc='pbe0')

#mf2.verbose=9
#mf2.stability()
for r in np.arange(1.5, 3.0, 0.1):
    mol = gto.Mole(atom='''N 0.0 0.0 0.0; N 0.0 0.0 %f'''%r, basis='def2-svp', verbose=5).build()
    mf = dft.RKS(mol)
    mf.xc = 'pbe0'
    mf.kernel()
    dump_mat.dump_mo(mol, mf.mo_coeff[:,:12])
    print(mf.mo_energy[:12])
    
    mf2 = guess.check_stab(mf, newton=True, res=True)
    dump_mat.dump_mo(mol, mf2.mo_coeff[:,:12])
    print(mf2.mo_energy[:12])
    print('scan %.2f, %.6f' % (r, mf2.e_tot))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='xc06n05', release='3.10.0-1127.el7.x86_64', version='#1 SMP Tue Feb 18 16:39:12 EST 2020', machine='x86_64', processor='x86_64')  Threads 48
Python 3.7.4 (default, Aug 13 2019, 20:35:49) 
[GCC 7.3.0]
numpy 1.17.2  scipy 1.4.1
Date: Thu Sep 16 17:41:37 2021
PySCF version 1.7.6a1
PySCF path  /share/home/srwang/pyscf/pyscf
GIT ORIG_HEAD 80f71dfe77ac5f9caae26788acf76446987635bd
GIT HEAD      ref: refs/heads/master
GIT master branch  80f71dfe77ac5f9caae26788acf76446987635bd

[ENV] PYSCF_EXT_PATH /share/home/srwang/pyscf_ext/fciqmc:
[CONFIG] conf_file /share/home/srwang/.pyscf_conf.py
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 2
[INPUT] num. electrons = 14
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 N      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 N      0.000000000000   0.000000000000   2.000000000000 AA    0.000000000000   0.000000000000   3.779452249130 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] N
[INPUT] 0    0    [5    /1   ]  1712.8415853      -0.0053934125305
                                257.64812677      -0.040221581118
                                58.458245853      -0.1793114499
                                16.198367905      -0.46376317823
                                5.0052600809      -0.44171422662
[INPUT] 0    0    [1    /1   ]  0.58731856571        1
[INPUT] 0    0    [1    /1   ]  0.18764592253        1
[INPUT] 1    0    [3    /1   ]  13.571470233      -0.040072398852
                                2.9257372874      -0.21807045028
                                0.79927750754     -0.51294466049
[INPUT] 1    0    [1    /1   ]  0.21954348034        1
[INPUT] 2    0    [1    /1   ]  1                    1

nuclear repulsion = 12.96484166754
number of shells = 12
number of NR pGTOs = 48
number of NR cGTOs = 28
basis = def2-svp
ecp = {}
CPU time:        93.05


******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmp2e5v71r0
max_memory 4000 MB (current use 258 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2aaf78ea5830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2aaf78ea5cb0>
Set gradient conv threshold to 3.16228e-05
atom N rad-grids = 75, ang-grids = [ 50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  86  86  86  86  86  86  86  86  86 266 266 266 266 266 266 266
 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266]
tot grids = 28092
Drop grids 3722
    CPU time for setting up grids      0.23 sec, wall time      0.00 sec
nelec by numeric integration = 13.992312739282628
    CPU time for vxc      0.79 sec, wall time      0.02 sec
E1 = -174.21758624901142  Ecoul = 65.87955101289039  Exc = -13.154297175045707
init E= -108.527490743627
cond(S) = 33.959953663655824
    CPU time for initialize scf      1.70 sec, wall time      0.04 sec
  HOMO = -0.232633835904799  LUMO = -0.166395956685172
  mo_energy =
[-14.378641 -14.378633  -0.755692  -0.642782  -0.274612  -0.232634  -0.232634  -0.166396  -0.166396  -0.063747   0.573057   0.649778   0.711933   0.711933
   0.824105   0.824105   0.893073   0.955694   2.003443   2.105152   2.105152   2.14827    2.148273   2.158531   2.158534   2.226663   2.226663   2.583723]
nelec by numeric integration = 14.000000109884343
    CPU time for vxc      0.83 sec, wall time      0.02 sec
E1 = -172.13631547291573  Ecoul = 63.23970183459571  Exc = -12.892554794505536
cycle= 1 E= -108.824326765286  delta_E= -0.297  |g|= 0.26  |ddm|= 1.55
    CPU time for cycle= 1      1.03 sec, wall time      0.02 sec
  HOMO = -0.372151110407813  LUMO = -0.256684648438075
  mo_energy =
[-14.708524 -14.708504  -0.869484  -0.767579  -0.417546  -0.372151  -0.372151  -0.256685  -0.256685  -0.167881   0.498204   0.576037   0.612594   0.612594
   0.734838   0.734838   0.78277    0.878009   1.889496   1.990297   1.990297   2.031562   2.031564   2.043765   2.043768   2.114422   2.114422   2.471012]
nelec by numeric integration = 13.999999964225744
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -173.6076646413392  Ecoul = 64.92754962325044  Exc = -13.121490686212441
cycle= 2 E= -108.836764036761  delta_E= -0.0124  |g|= 0.145  |ddm|= 0.454
    CPU time for cycle= 2      0.99 sec, wall time      0.02 sec
  HOMO = -0.324325164170659  LUMO = -0.205543424195522
  mo_energy =
[-14.575512 -14.575489  -0.818674  -0.717017  -0.367813  -0.324325  -0.324325  -0.205543  -0.205543  -0.11121    0.529404   0.60731    0.65379    0.65379
   0.772266   0.772266   0.828805   0.911672   1.938767   2.039429   2.039429   2.080524   2.080526   2.092761   2.092763   2.16395    2.16395    2.520998]
nelec by numeric integration = 14.000000025130866
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -173.07765688166285  Ecoul = 64.30695386408496  Exc = -13.03685125101601
cycle= 3 E= -108.842712601054  delta_E= -0.00595  |g|= 0.00145  |ddm|= 0.165
    CPU time for cycle= 3      0.99 sec, wall time      0.02 sec
  HOMO = -0.324633810962368  LUMO = -0.205813949293369
  mo_energy =
[-14.576731 -14.576708  -0.818941  -0.717367  -0.36821   -0.324634  -0.324634  -0.205814  -0.205814  -0.111407   0.529276   0.607114   0.653664   0.653664
   0.772112   0.772112   0.828622   0.911585   1.938564   2.039222   2.039222   2.080308   2.080311   2.092549   2.092551   2.163772   2.163772   2.520835]
nelec by numeric integration = 14.000000024194705
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -173.08161206764942  Ecoul = 64.31165602207243  Exc = -13.037598973376568
cycle= 4 E= -108.842713351414  delta_E= -7.5e-07  |g|= 0.000413  |ddm|= 0.00248
    CPU time for cycle= 4      0.99 sec, wall time      0.02 sec
  HOMO = -0.324626633339332  LUMO = -0.205791737418525
  mo_energy =
[-14.576653 -14.57663   -0.818954  -0.717326  -0.368192  -0.324627  -0.324627  -0.205792  -0.205792  -0.111391   0.529296   0.607174   0.653671   0.653671
   0.772128   0.772128   0.828612   0.91157    1.93858    2.039236   2.039236   2.080321   2.080324   2.092562   2.092565   2.163789   2.163789   2.520848]
nelec by numeric integration = 14.000000024353774
    CPU time for vxc      0.80 sec, wall time      0.02 sec
E1 = -173.08135212956967  Ecoul = 64.3113294208206  Exc = -13.03753234217727
cycle= 5 E= -108.842713383386  delta_E= -3.2e-08  |g|= 8.21e-06  |ddm|= 0.000237
    CPU time for cycle= 5      0.98 sec, wall time      0.02 sec
  HOMO = -0.324627251713413  LUMO = -0.205794154459237
  mo_energy =
[-14.576651 -14.576628  -0.818955  -0.717326  -0.368193  -0.324627  -0.324627  -0.205794  -0.205794  -0.111394   0.529293   0.607171   0.653666   0.653666
   0.772124   0.772124   0.828609   0.911567   1.938576   2.039232   2.039232   2.080317   2.08032    2.092558   2.09256    2.163784   2.163784   2.520843]
nelec by numeric integration = 14.000000024357838
    CPU time for vxc      0.80 sec, wall time      0.02 sec
E1 = -173.0813642010348  Ecoul = 64.31134267802456  Exc = -13.037533527929984
cycle= 6 E= -108.8427133834  delta_E= -1.39e-11  |g|= 4.15e-07  |ddm|= 7.36e-06
    CPU time for cycle= 6      0.98 sec, wall time      0.02 sec
  HOMO = -0.324627471757142  LUMO = -0.205794324089332
  mo_energy =
[-14.576652 -14.576629  -0.818955  -0.717327  -0.368193  -0.324627  -0.324627  -0.205794  -0.205794  -0.111394   0.529293   0.607171   0.653666   0.653666
   0.772124   0.772124   0.828608   0.911567   1.938576   2.039232   2.039232   2.080317   2.08032    2.092558   2.09256    2.163784   2.163784   2.520843]
nelec by numeric integration = 14.000000024357686
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -173.08136624452465  Ecoul = 64.31134503587721  Exc = -13.03753384229276
Extra cycle  E= -108.8427133834  delta_E= 2.84e-14  |g|= 7.58e-07  |ddm|= 6.6e-07
    CPU time for scf_cycle      8.64 sec, wall time      0.18 sec
    CPU time for SCF      8.66 sec, wall time      0.18 sec
converged SCF energy = -108.8427133834
             #0      #1      #2      #3      #4      #5     
  0 N 1s       0.699   0.701   0.212   0.227                
  0 N 2s                       0.454   0.499  -0.101        
  0 N 3s                       0.268   0.308                
  0 N 2px                                              0.334
  0 N 2py                                             -0.294
  0 N 2pz                                     -0.442        
  0 N 3px                                             -0.249
  0 N 3py                                              0.220
  0 N 3pz                                      0.295        
  1 N 1s       0.701  -0.699   0.212  -0.227                
  1 N 2s                       0.454  -0.499  -0.101        
  1 N 3s                       0.268  -0.308                
  1 N 2px                                              0.334
  1 N 2py                                             -0.294
  1 N 2pz                                      0.442        
  1 N 3px                                             -0.249
  1 N 3py                                              0.220
  1 N 3pz                                     -0.295        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                       0.218  -0.176
  0 N 2s                              -0.149   1.126  -0.965
  0 N 3s                              -0.106  -1.046   1.008
  0 N 2px      0.294  -0.288   0.389                        
  0 N 2py      0.334   0.389   0.288                        
  0 N 2pz                              0.519          -0.399
  0 N 3px     -0.220   0.212  -0.286                        
  0 N 3py     -0.249  -0.286  -0.212                        
  0 N 3pz                             -0.431   0.173  -0.370
  1 N 1s                                       0.218   0.176
  1 N 2s                               0.149   1.126   0.965
  1 N 3s                               0.106  -1.046  -1.008
  1 N 2px      0.294   0.288  -0.389                        
  1 N 2py      0.334  -0.389  -0.288                        
  1 N 2pz                              0.519          -0.399
  1 N 3px     -0.220  -0.212   0.286                        
  1 N 3py     -0.249   0.286   0.212                        
  1 N 3pz                             -0.431  -0.173  -0.370
[-14.576652 -14.576629  -0.818955  -0.717327  -0.368193  -0.324627  -0.324627  -0.205794  -0.205794  -0.111394   0.529293   0.607171]
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 14.000000024357684
    CPU time for vxc      0.79 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 2.03  e= [0.770326]  max|de|= 0.77  lindep= 0.727
davidson 1 2  |r|= 1.37  e= [0.494446]  max|de|= -0.276  lindep= 0.984
davidson 2 3  |r|= 0.708  e= [0.378418]  max|de|= -0.116  lindep= 0.694
davidson 3 4  |r|= 0.275  e= [0.137521]  max|de|= -0.241  lindep= 0.891
davidson 4 5  |r|= 0.168  e= [0.109575]  max|de|= -0.0279  lindep= 0.635
davidson 5 6  |r|= 0.0589  e= [0.098264]  max|de|= -0.0113  lindep= 0.834
davidson 6 7  |r|= 0.0181  e= [0.097606]  max|de|= -0.000658  lindep= 0.749
davidson 7 8  |r|= 0.00815  e= [0.097497]  max|de|= -0.000109  lindep= 0.763
root 0 converged  |r|= 0.00269  e= 0.09748036119461721  max|de|= -1.65e-05
converged 8 9  |r|= 0.00269  e= [0.09748]  max|de|= -1.65e-05
RHF/RKS wavefunction is stable in the internal stability analysis
             #0      #1      #2      #3      #4      #5     
  0 N 1s       0.699   0.701   0.212   0.227                
  0 N 2s                       0.454   0.499  -0.101        
  0 N 3s                       0.268   0.308                
  0 N 2px                                              0.334
  0 N 2py                                             -0.294
  0 N 2pz                                     -0.442        
  0 N 3px                                             -0.249
  0 N 3py                                              0.220
  0 N 3pz                                      0.295        
  1 N 1s       0.701  -0.699   0.212  -0.227                
  1 N 2s                       0.454  -0.499  -0.101        
  1 N 3s                       0.268  -0.308                
  1 N 2px                                              0.334
  1 N 2py                                             -0.294
  1 N 2pz                                      0.442        
  1 N 3px                                             -0.249
  1 N 3py                                              0.220
  1 N 3pz                                     -0.295        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                       0.218  -0.176
  0 N 2s                              -0.149   1.126  -0.965
  0 N 3s                              -0.106  -1.046   1.008
  0 N 2px      0.294  -0.288   0.389                        
  0 N 2py      0.334   0.389   0.288                        
  0 N 2pz                              0.519          -0.399
  0 N 3px     -0.220   0.212  -0.286                        
  0 N 3py     -0.249  -0.286  -0.212                        
  0 N 3pz                             -0.431   0.173  -0.370
  1 N 1s                                       0.218   0.176
  1 N 2s                               0.149   1.126   0.965
  1 N 3s                               0.106  -1.046  -1.008
  1 N 2px      0.294   0.288  -0.389                        
  1 N 2py      0.334  -0.389  -0.288                        
  1 N 2pz                              0.519          -0.399
  1 N 3px     -0.220  -0.212   0.286                        
  1 N 3py     -0.249   0.286   0.212                        
  1 N 3pz                             -0.431  -0.173  -0.370
[-14.576652 -14.576629  -0.818955  -0.717327  -0.368193  -0.324627  -0.324627  -0.205794  -0.205794  -0.111394   0.529293   0.607171]
scan 2.00, -108.842713
#INFO: **** input file is /share/home/srwang/pyAutoMR/examples/guess/N2-RKS.py ****
from pyscf import gto, dft
from automr import guess, dump_mat
import numpy as np
#mf=guess.from_fch_simp("v2.fchk", xc='pbe0')

#mf2.verbose=9
#mf2.stability()
for r in np.arange(1.5, 3.0, 0.1):
    mol = gto.Mole(atom='''N 0.0 0.0 0.0; N 0.0 0.0 %f'''%r, basis='def2-svp', verbose=5).build()
    mf = dft.RKS(mol)
    mf.xc = 'pbe0'
    mf.kernel()
    dump_mat.dump_mo(mol, mf.mo_coeff[:,:12])
    print(mf.mo_energy[:12])
    
    mf2 = guess.check_stab(mf, newton=True, res=True)
    dump_mat.dump_mo(mol, mf2.mo_coeff[:,:12])
    print(mf2.mo_energy[:12])
    print('scan %.2f, %.6f' % (r, mf2.e_tot))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='xc06n05', release='3.10.0-1127.el7.x86_64', version='#1 SMP Tue Feb 18 16:39:12 EST 2020', machine='x86_64', processor='x86_64')  Threads 48
Python 3.7.4 (default, Aug 13 2019, 20:35:49) 
[GCC 7.3.0]
numpy 1.17.2  scipy 1.4.1
Date: Thu Sep 16 17:41:37 2021
PySCF version 1.7.6a1
PySCF path  /share/home/srwang/pyscf/pyscf
GIT ORIG_HEAD 80f71dfe77ac5f9caae26788acf76446987635bd
GIT HEAD      ref: refs/heads/master
GIT master branch  80f71dfe77ac5f9caae26788acf76446987635bd

[ENV] PYSCF_EXT_PATH /share/home/srwang/pyscf_ext/fciqmc:
[CONFIG] conf_file /share/home/srwang/.pyscf_conf.py
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 2
[INPUT] num. electrons = 14
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 N      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 N      0.000000000000   0.000000000000   2.100000000000 AA    0.000000000000   0.000000000000   3.968424861587 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] N
[INPUT] 0    0    [5    /1   ]  1712.8415853      -0.0053934125305
                                257.64812677      -0.040221581118
                                58.458245853      -0.1793114499
                                16.198367905      -0.46376317823
                                5.0052600809      -0.44171422662
[INPUT] 0    0    [1    /1   ]  0.58731856571        1
[INPUT] 0    0    [1    /1   ]  0.18764592253        1
[INPUT] 1    0    [3    /1   ]  13.571470233      -0.040072398852
                                2.9257372874      -0.21807045028
                                0.79927750754     -0.51294466049
[INPUT] 1    0    [1    /1   ]  0.21954348034        1
[INPUT] 2    0    [1    /1   ]  1                    1

nuclear repulsion = 12.3474682548
number of shells = 12
number of NR pGTOs = 48
number of NR cGTOs = 28
basis = def2-svp
ecp = {}
CPU time:       106.87


******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpujv6lr_m
max_memory 4000 MB (current use 258 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2aaf78ea5830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2aaf78ea5cb0>
Set gradient conv threshold to 3.16228e-05
atom N rad-grids = 75, ang-grids = [ 50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  86  86  86  86  86  86  86  86  86 266 266 266 266 266 266 266
 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266]
tot grids = 28092
Drop grids 3712
    CPU time for setting up grids      0.24 sec, wall time      0.01 sec
nelec by numeric integration = 13.992295238759933
    CPU time for vxc      0.79 sec, wall time      0.02 sec
E1 = -172.98719820797922  Ecoul = 65.27391323504509  Exc = -13.14378633963408
init E= -108.509603057768
cond(S) = 28.19261141548463
    CPU time for initialize scf      1.69 sec, wall time      0.04 sec
  HOMO = -0.22632753070571  LUMO = -0.171810688521396
  mo_energy =
[-14.378299 -14.378282  -0.741964  -0.650794  -0.266679  -0.226328  -0.226328  -0.171811  -0.171811  -0.086232   0.568909   0.646206   0.708952   0.708952
   0.823048   0.823048   0.862901   0.971718   2.052479   2.12612    2.12612    2.151155   2.151162   2.156673   2.156681   2.199745   2.199745   2.48519 ]
nelec by numeric integration = 13.999995773699803
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -170.90283666792604  Ecoul = 62.64253053333373  Exc = -12.874907385219242
cycle= 1 E= -108.787745265012  delta_E= -0.278  |g|= 0.259  |ddm|= 1.56
    CPU time for cycle= 1      1.02 sec, wall time      0.02 sec
  HOMO = -0.364465069000184  LUMO = -0.262015747218026
  mo_energy =
[-14.707998 -14.707984  -0.855471  -0.774642  -0.406933  -0.364465  -0.364465  -0.262016  -0.262016  -0.187652   0.493575   0.571786   0.611111   0.611111
   0.733483   0.733483   0.754673   0.892695   1.939317   2.012062   2.012062   2.035131   2.035138   2.042389   2.042396   2.088337   2.088337   2.373952]
nelec by numeric integration = 13.9999951723087
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -172.37187213891778  Ecoul = 64.33177120298147  Exc = -13.107470323875171
cycle= 2 E= -108.800103005011  delta_E= -0.0124  |g|= 0.147  |ddm|= 0.458
    CPU time for cycle= 2      0.98 sec, wall time      0.02 sec
  HOMO = -0.317117926963946  LUMO = -0.211481871440313
  mo_energy =
[-14.575153 -14.575137  -0.805943  -0.72427   -0.358169  -0.317118  -0.317118  -0.211482  -0.211482  -0.132444   0.524767   0.603256   0.651465   0.651465
   0.770836   0.770836   0.799694   0.926617   1.987807   2.060561   2.060561   2.083616   2.083623   2.090897   2.090905   2.137079   2.137079   2.422945]
nelec by numeric integration = 13.999995390492636
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -171.8409350107502  Ecoul = 63.708453306313274  Exc = -13.021206453694337
cycle= 3 E= -108.806219903331  delta_E= -0.00612  |g|= 0.00114  |ddm|= 0.166
    CPU time for cycle= 3      0.98 sec, wall time      0.02 sec
  HOMO = -0.317258906175003  LUMO = -0.211577324314838
  mo_energy =
[-14.575897 -14.57588   -0.806035  -0.724446  -0.358366  -0.317259  -0.317259  -0.211577  -0.211577  -0.132429   0.524755   0.60316    0.651492   0.651492
   0.77082    0.77082    0.799695   0.926671   1.98778    2.060532   2.060532   2.083577   2.083585   2.090862   2.090869   2.137078   2.137078   2.422967]
nelec by numeric integration = 13.999995389312318
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -171.8431384243637  Ecoul = 63.711145679425236  Exc = -13.021696001369474
cycle= 4 E= -108.806220491508  delta_E= -5.88e-07  |g|= 0.000461  |ddm|= 0.00225
    CPU time for cycle= 4      0.98 sec, wall time      0.02 sec
  HOMO = -0.317254370145297  LUMO = -0.211558056225941
  mo_energy =
[-14.575825 -14.575809  -0.806049  -0.724409  -0.358353  -0.317254  -0.317254  -0.211558  -0.211558  -0.132414   0.524769   0.603225   0.651497   0.651497
   0.770835   0.770835   0.799685   0.92665    1.987795   2.060545   2.060545   2.083589   2.083596   2.090874   2.090881   2.137093   2.137093   2.422978]
nelec by numeric integration = 13.999995389319116
    CPU time for vxc      0.80 sec, wall time      0.02 sec
E1 = -171.8428948034013  Ecoul = 63.710835912838355  Exc = -13.021629895844528
cycle= 5 E= -108.806220531607  delta_E= -4.01e-08  |g|= 6.34e-06  |ddm|= 0.000257
    CPU time for cycle= 5      0.98 sec, wall time      0.02 sec
  HOMO = -0.317253947616919  LUMO = -0.211559560317542
  mo_energy =
[-14.575821 -14.575805  -0.806049  -0.724409  -0.358353  -0.317254  -0.317254  -0.21156   -0.21156   -0.132416   0.524766   0.603221   0.651493   0.651493
   0.770832   0.770832   0.799682   0.926647   1.987791   2.060541   2.060541   2.083586   2.083593   2.090871   2.090878   2.137089   2.137089   2.422974]
nelec by numeric integration = 13.99999538932245
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -171.84289928945952  Ecoul = 63.71084048649647  Exc = -13.021629983452483
cycle= 6 E= -108.806220531616  delta_E= -8.07e-12  |g|= 3.9e-07  |ddm|= 6.99e-06
    CPU time for cycle= 6      0.98 sec, wall time      0.02 sec
  HOMO = -0.317254157043258  LUMO = -0.211559712503699
  mo_energy =
[-14.575822 -14.575805  -0.806049  -0.724409  -0.358353  -0.317254  -0.317254  -0.21156   -0.21156   -0.132416   0.524766   0.603221   0.651493   0.651493
   0.770832   0.770832   0.799682   0.926647   1.987791   2.060541   2.060541   2.083586   2.083593   2.09087    2.090878   2.137089   2.137089   2.422974]
nelec by numeric integration = 13.999995389321665
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -171.84290112649094  Ecoul = 63.71084260217251  Exc = -13.021630262096949
Extra cycle  E= -108.806220531615  delta_E= 1.42e-13  |g|= 1.48e-06  |ddm|= 8.24e-07
    CPU time for scf_cycle      8.59 sec, wall time      0.18 sec
    CPU time for SCF      8.61 sec, wall time      0.18 sec
converged SCF energy = -108.806220531615
             #0      #1      #2      #3      #4      #5     
  0 N 1s       0.698   0.702   0.213   0.227                
  0 N 2s                       0.457   0.498                
  0 N 3s                       0.275   0.304                
  0 N 2px                                             -0.286
  0 N 2py                                              0.344
  0 N 2pz                                     -0.440        
  0 N 3px                                              0.215
  0 N 3py                                             -0.258
  0 N 3pz                                      0.301        
  1 N 1s       0.702  -0.698   0.213  -0.227                
  1 N 2s                       0.457  -0.498                
  1 N 3s                       0.275  -0.304                
  1 N 2px                                             -0.286
  1 N 2py                                              0.344
  1 N 2pz                                      0.440        
  1 N 3px                                              0.215
  1 N 3py                                             -0.258
  1 N 3pz                                     -0.301        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                       0.219  -0.179
  0 N 2s                              -0.130   1.127  -0.981
  0 N 3s                                      -1.050   1.023
  0 N 2px      0.344   0.385   0.290                        
  0 N 2py      0.286  -0.290   0.385                        
  0 N 2pz                              0.514          -0.384
  0 N 3px     -0.258  -0.281  -0.212                        
  0 N 3py     -0.215   0.212  -0.281                        
  0 N 3pz                             -0.410   0.149  -0.353
  1 N 1s                                       0.219   0.179
  1 N 2s                               0.130   1.127   0.981
  1 N 3s                                      -1.050  -1.023
  1 N 2px      0.344  -0.385  -0.290                        
  1 N 2py      0.286   0.290  -0.385                        
  1 N 2pz                              0.514          -0.384
  1 N 3px     -0.258   0.281   0.212                        
  1 N 3py     -0.215  -0.212   0.281                        
  1 N 3pz                             -0.410  -0.149  -0.353
[-14.575822 -14.575805  -0.806049  -0.724409  -0.358353  -0.317254  -0.317254  -0.21156   -0.21156   -0.132416   0.524766   0.603221]
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 13.999995389321661
    CPU time for vxc      0.80 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 1.84  e= [0.621783]  max|de|= 0.622  lindep= 0.763
davidson 1 2  |r|= 0.515  e= [0.293056]  max|de|= -0.329  lindep= 0.973
davidson 2 3  |r|= 0.463  e= [0.284093]  max|de|= -0.00896  lindep= 0.758
davidson 3 4  |r|= 0.426  e= [0.120044]  max|de|= -0.164  lindep= 0.836
davidson 4 5  |r|= 0.173  e= [0.063489]  max|de|= -0.0566  lindep= 0.693
davidson 5 6  |r|= 0.0647  e= [0.047856]  max|de|= -0.0156  lindep= 0.854
davidson 6 7  |r|= 0.0184  e= [0.047093]  max|de|= -0.000763  lindep= 0.824
davidson 7 8  |r|= 0.00683  e= [0.046992]  max|de|= -0.0001  lindep= 0.625
root 0 converged  |r|= 0.00299  e= 0.04697692215550275  max|de|= -1.55e-05
converged 8 9  |r|= 0.00299  e= [0.046977]  max|de|= -1.55e-05
RHF/RKS wavefunction is stable in the internal stability analysis
             #0      #1      #2      #3      #4      #5     
  0 N 1s       0.698   0.702   0.213   0.227                
  0 N 2s                       0.457   0.498                
  0 N 3s                       0.275   0.304                
  0 N 2px                                             -0.286
  0 N 2py                                              0.344
  0 N 2pz                                     -0.440        
  0 N 3px                                              0.215
  0 N 3py                                             -0.258
  0 N 3pz                                      0.301        
  1 N 1s       0.702  -0.698   0.213  -0.227                
  1 N 2s                       0.457  -0.498                
  1 N 3s                       0.275  -0.304                
  1 N 2px                                             -0.286
  1 N 2py                                              0.344
  1 N 2pz                                      0.440        
  1 N 3px                                              0.215
  1 N 3py                                             -0.258
  1 N 3pz                                     -0.301        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                       0.219  -0.179
  0 N 2s                              -0.130   1.127  -0.981
  0 N 3s                                      -1.050   1.023
  0 N 2px      0.344   0.385   0.290                        
  0 N 2py      0.286  -0.290   0.385                        
  0 N 2pz                              0.514          -0.384
  0 N 3px     -0.258  -0.281  -0.212                        
  0 N 3py     -0.215   0.212  -0.281                        
  0 N 3pz                             -0.410   0.149  -0.353
  1 N 1s                                       0.219   0.179
  1 N 2s                               0.130   1.127   0.981
  1 N 3s                                      -1.050  -1.023
  1 N 2px      0.344  -0.385  -0.290                        
  1 N 2py      0.286   0.290  -0.385                        
  1 N 2pz                              0.514          -0.384
  1 N 3px     -0.258   0.281   0.212                        
  1 N 3py     -0.215  -0.212   0.281                        
  1 N 3pz                             -0.410  -0.149  -0.353
[-14.575822 -14.575805  -0.806049  -0.724409  -0.358353  -0.317254  -0.317254  -0.21156   -0.21156   -0.132416   0.524766   0.603221]
scan 2.10, -108.806221
#INFO: **** input file is /share/home/srwang/pyAutoMR/examples/guess/N2-RKS.py ****
from pyscf import gto, dft
from automr import guess, dump_mat
import numpy as np
#mf=guess.from_fch_simp("v2.fchk", xc='pbe0')

#mf2.verbose=9
#mf2.stability()
for r in np.arange(1.5, 3.0, 0.1):
    mol = gto.Mole(atom='''N 0.0 0.0 0.0; N 0.0 0.0 %f'''%r, basis='def2-svp', verbose=5).build()
    mf = dft.RKS(mol)
    mf.xc = 'pbe0'
    mf.kernel()
    dump_mat.dump_mo(mol, mf.mo_coeff[:,:12])
    print(mf.mo_energy[:12])
    
    mf2 = guess.check_stab(mf, newton=True, res=True)
    dump_mat.dump_mo(mol, mf2.mo_coeff[:,:12])
    print(mf2.mo_energy[:12])
    print('scan %.2f, %.6f' % (r, mf2.e_tot))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='xc06n05', release='3.10.0-1127.el7.x86_64', version='#1 SMP Tue Feb 18 16:39:12 EST 2020', machine='x86_64', processor='x86_64')  Threads 48
Python 3.7.4 (default, Aug 13 2019, 20:35:49) 
[GCC 7.3.0]
numpy 1.17.2  scipy 1.4.1
Date: Thu Sep 16 17:41:38 2021
PySCF version 1.7.6a1
PySCF path  /share/home/srwang/pyscf/pyscf
GIT ORIG_HEAD 80f71dfe77ac5f9caae26788acf76446987635bd
GIT HEAD      ref: refs/heads/master
GIT master branch  80f71dfe77ac5f9caae26788acf76446987635bd

[ENV] PYSCF_EXT_PATH /share/home/srwang/pyscf_ext/fciqmc:
[CONFIG] conf_file /share/home/srwang/.pyscf_conf.py
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 2
[INPUT] num. electrons = 14
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 N      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 N      0.000000000000   0.000000000000   2.200000000000 AA    0.000000000000   0.000000000000   4.157397474043 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] N
[INPUT] 0    0    [5    /1   ]  1712.8415853      -0.0053934125305
                                257.64812677      -0.040221581118
                                58.458245853      -0.1793114499
                                16.198367905      -0.46376317823
                                5.0052600809      -0.44171422662
[INPUT] 0    0    [1    /1   ]  0.58731856571        1
[INPUT] 0    0    [1    /1   ]  0.18764592253        1
[INPUT] 1    0    [3    /1   ]  13.571470233      -0.040072398852
                                2.9257372874      -0.21807045028
                                0.79927750754     -0.51294466049
[INPUT] 1    0    [1    /1   ]  0.21954348034        1
[INPUT] 2    0    [1    /1   ]  1                    1

nuclear repulsion = 11.7862196977636
number of shells = 12
number of NR pGTOs = 48
number of NR cGTOs = 28
basis = def2-svp
ecp = {}
CPU time:       120.64


******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpxq5eoz5d
max_memory 4000 MB (current use 259 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2aaf78ea5830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2aaf78ea5cb0>
Set gradient conv threshold to 3.16228e-05
atom N rad-grids = 75, ang-grids = [ 50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  86  86  86  86  86  86  86  86  86 266 266 266 266 266 266 266
 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266]
tot grids = 28092
Drop grids 3678
    CPU time for setting up grids      0.24 sec, wall time      0.00 sec
nelec by numeric integration = 13.992276038523904
    CPU time for vxc      0.80 sec, wall time      0.02 sec
E1 = -171.86750066941016  Ecoul = 64.72055331169966  Exc = -13.135960236424197
init E= -108.496687896371
cond(S) = 23.906679145969132
    CPU time for initialize scf      1.71 sec, wall time      0.04 sec
  HOMO = -0.221185265595084  LUMO = -0.176303049313935
  mo_energy =
[-14.378082 -14.378051  -0.731099  -0.657632  -0.259378  -0.221185  -0.221185  -0.176303  -0.176303  -0.104569   0.563244   0.642769   0.707473   0.707473
   0.820908   0.820908   0.830853   0.987252   2.093296   2.139241   2.139241   2.152812   2.15282    2.155675   2.155683   2.181885   2.181885   2.401401]
nelec by numeric integration = 13.999991076470547
    CPU time for vxc      0.83 sec, wall time      0.02 sec
E1 = -169.7847258035181  Ecoul = 62.10424514265619  Exc = -12.861354338051125
cycle= 1 E= -108.755615301149  delta_E= -0.259  |g|= 0.258  |ddm|= 1.56
    CPU time for cycle= 1      1.03 sec, wall time      0.02 sec
  HOMO = -0.357872933899086  LUMO = -0.266162023746799
  mo_energy =
[-14.706402 -14.7064    -0.84433   -0.780103  -0.39686   -0.357873  -0.357873  -0.266162  -0.266162  -0.203369   0.487725   0.568068   0.61129    0.61129
   0.725632   0.731368   0.731368   0.907132   1.980918   2.026107   2.026107   2.037615   2.037624   2.042035   2.042044   2.071326   2.071326   2.291595]
nelec by numeric integration = 13.999990511842434
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -171.2511008489289  Ecoul = 63.79391646683568  Exc = -13.09686849833494
cycle= 2 E= -108.767833182665  delta_E= -0.0122  |g|= 0.148  |ddm|= 0.46
    CPU time for cycle= 2      0.98 sec, wall time      0.02 sec
  HOMO = -0.31094059052075  LUMO = -0.21625637011691
  mo_energy =
[-14.57398  -14.573977  -0.795739  -0.730073  -0.34909   -0.310941  -0.310941  -0.216256  -0.216256  -0.149501   0.518832   0.599608   0.65083    0.65083
   0.768587   0.768587   0.769313   0.94127    2.028793   2.074025   2.074025   2.085634   2.085643   2.090071   2.090079   2.119379   2.119379   2.339717]
nelec by numeric integration = 13.99999069345638
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -170.71855467838276  Ecoul = 63.16731824640991  Exc = -13.009102143822965
cycle= 3 E= -108.774118878032  delta_E= -0.00629  |g|= 0.000989  |ddm|= 0.168
    CPU time for cycle= 3      0.98 sec, wall time      0.02 sec
  HOMO = -0.310945167346316  LUMO = -0.216208001113685
  mo_energy =
[-14.574315 -14.574312  -0.795696  -0.7301    -0.349125  -0.310945  -0.310945  -0.216208  -0.216208  -0.149318   0.518923   0.599603   0.65098    0.65098
   0.768688   0.768688   0.769452   0.941443   2.02891    2.074139   2.074139   2.08574    2.085749   2.090179   2.090188   2.11952    2.11952    2.339884]
nelec by numeric integration = 13.99999069431788
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -170.71925803998886  Ecoul = 63.168276054966604  Exc = -13.00935713068951
cycle= 4 E= -108.774119417948  delta_E= -5.4e-07  |g|= 0.000485  |ddm|= 0.00208
    CPU time for cycle= 4      0.98 sec, wall time      0.02 sec
  HOMO = -0.310943127131555  LUMO = -0.216192620444101
  mo_energy =
[-14.574251 -14.574249  -0.79571   -0.730069  -0.349117  -0.310943  -0.310943  -0.216193  -0.216193  -0.149304   0.518928   0.599669   0.650982   0.650982
   0.768701   0.768701   0.769446   0.941416   2.028922   2.07415    2.07415    2.08575    2.085758   2.090189   2.090198   2.119532   2.119532   2.339893]
nelec by numeric integration = 13.999990693857889
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -170.71904114859714  Ecoul = 63.167996799312405  Exc = -13.00929481138812
cycle= 5 E= -108.774119462909  delta_E= -4.5e-08  |g|= 5.19e-06  |ddm|= 0.000271
    CPU time for cycle= 5      0.99 sec, wall time      0.02 sec
  HOMO = -0.310941851772621  LUMO = -0.216193356643369
  mo_energy =
[-14.574246 -14.574243  -0.79571   -0.730068  -0.349116  -0.310942  -0.310942  -0.216193  -0.216193  -0.149304   0.518925   0.599666   0.650978   0.650978
   0.768698   0.768698   0.769444   0.941414   2.028919   2.074147   2.074147   2.085747   2.085756   2.090187   2.090195   2.119529   2.119529   2.33989 ]
nelec by numeric integration = 13.999990693859914
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -170.71903981109028  Ecoul = 63.16799472963467  Exc = -13.009294079223276
cycle= 6 E= -108.774119462915  delta_E= -6.04e-12  |g|= 3.68e-07  |ddm|= 7.31e-06
    CPU time for cycle= 6      0.98 sec, wall time      0.02 sec
  HOMO = -0.310942055041519  LUMO = -0.216193501688237
  mo_energy =
[-14.574246 -14.574244  -0.79571   -0.730068  -0.349116  -0.310942  -0.310942  -0.216194  -0.216194  -0.149305   0.518925   0.599666   0.650978   0.650978
   0.768698   0.768698   0.769444   0.941414   2.028919   2.074147   2.074147   2.085747   2.085756   2.090187   2.090195   2.119529   2.119529   2.33989 ]
nelec by numeric integration = 13.99999069385894
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -170.71904151703424  Ecoul = 63.16799669310013  Exc = -13.009294336744873
Extra cycle  E= -108.774119462915  delta_E= -8.53e-14  |g|= 2.26e-07  |ddm|= 5.24e-07
    CPU time for scf_cycle      8.64 sec, wall time      0.18 sec
    CPU time for SCF      8.65 sec, wall time      0.18 sec
converged SCF energy = -108.774119462915
             #0      #1      #2      #3      #4      #5     
  0 N 1s       0.701  -0.699   0.214  -0.226                
  0 N 2s                       0.461  -0.497                
  0 N 3s                       0.280  -0.301                
  0 N 2px                                              0.181
  0 N 2py                                              0.411
  0 N 2pz                                      0.439        
  0 N 3px                                             -0.136
  0 N 3py                                             -0.309
  0 N 3pz                                     -0.307        
  1 N 1s       0.699   0.701   0.214   0.226                
  1 N 2s                       0.461   0.497                
  1 N 3s                       0.280   0.301                
  1 N 2px                                              0.181
  1 N 2py                                              0.411
  1 N 2pz                                     -0.439        
  1 N 3px                                             -0.136
  1 N 3py                                             -0.309
  1 N 3pz                                      0.307        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                       0.219   0.182
  0 N 2s                              -0.113   1.127   0.994
  0 N 3s                                      -1.052  -1.034
  0 N 2px      0.411  -0.465  -0.119                        
  0 N 2py     -0.181   0.119  -0.465                        
  0 N 2pz                              0.510           0.370
  0 N 3px     -0.309   0.338                                
  0 N 3py      0.136           0.338                        
  0 N 3pz                             -0.395   0.117   0.339
  1 N 1s                                       0.219  -0.182
  1 N 2s                               0.113   1.127  -0.994
  1 N 3s                                      -1.052   1.034
  1 N 2px      0.411   0.465   0.119                        
  1 N 2py     -0.181  -0.119   0.465                        
  1 N 2pz                              0.510           0.370
  1 N 3px     -0.309  -0.338                                
  1 N 3py      0.136          -0.338                        
  1 N 3pz                             -0.395  -0.117   0.339
[-14.574246 -14.574244  -0.79571   -0.730068  -0.349116  -0.310942  -0.310942  -0.216194  -0.216194  -0.149305   0.518925   0.599666]
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 13.99999069385894
    CPU time for vxc      0.80 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 3.49  e= [1.648075]  max|de|= 1.65  lindep= 0.982
davidson 1 2  |r|=  1.8  e= [0.671156]  max|de|= -0.977  lindep= 0.806
davidson 2 3  |r|= 0.703  e= [0.36632]  max|de|= -0.305  lindep= 0.547
davidson 3 4  |r|= 0.408  e= [0.281151]  max|de|= -0.0852  lindep= 0.608
davidson 4 5  |r|= 0.358  e= [0.025903]  max|de|= -0.255  lindep= 0.779
davidson 5 6  |r|= 0.0782  e= [0.006475]  max|de|= -0.0194  lindep= 0.85
davidson 6 7  |r|= 0.0156  e= [0.00505]  max|de|= -0.00143  lindep= 0.74
root 0 converged  |r|= 0.00843  e= 0.004961198508588042  max|de|= -8.88e-05
converged 7 8  |r|= 0.00843  e= [0.004961]  max|de|= -8.88e-05
RHF/RKS wavefunction is stable in the internal stability analysis
             #0      #1      #2      #3      #4      #5     
  0 N 1s       0.701  -0.699   0.214  -0.226                
  0 N 2s                       0.461  -0.497                
  0 N 3s                       0.280  -0.301                
  0 N 2px                                              0.181
  0 N 2py                                              0.411
  0 N 2pz                                      0.439        
  0 N 3px                                             -0.136
  0 N 3py                                             -0.309
  0 N 3pz                                     -0.307        
  1 N 1s       0.699   0.701   0.214   0.226                
  1 N 2s                       0.461   0.497                
  1 N 3s                       0.280   0.301                
  1 N 2px                                              0.181
  1 N 2py                                              0.411
  1 N 2pz                                     -0.439        
  1 N 3px                                             -0.136
  1 N 3py                                             -0.309
  1 N 3pz                                      0.307        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                       0.219   0.182
  0 N 2s                              -0.113   1.127   0.994
  0 N 3s                                      -1.052  -1.034
  0 N 2px      0.411  -0.465  -0.119                        
  0 N 2py     -0.181   0.119  -0.465                        
  0 N 2pz                              0.510           0.370
  0 N 3px     -0.309   0.338                                
  0 N 3py      0.136           0.338                        
  0 N 3pz                             -0.395   0.117   0.339
  1 N 1s                                       0.219  -0.182
  1 N 2s                               0.113   1.127  -0.994
  1 N 3s                                      -1.052   1.034
  1 N 2px      0.411   0.465   0.119                        
  1 N 2py     -0.181  -0.119   0.465                        
  1 N 2pz                              0.510           0.370
  1 N 3px     -0.309  -0.338                                
  1 N 3py      0.136          -0.338                        
  1 N 3pz                             -0.395  -0.117   0.339
[-14.574246 -14.574244  -0.79571   -0.730068  -0.349116  -0.310942  -0.310942  -0.216194  -0.216194  -0.149305   0.518925   0.599666]
scan 2.20, -108.774119
#INFO: **** input file is /share/home/srwang/pyAutoMR/examples/guess/N2-RKS.py ****
from pyscf import gto, dft
from automr import guess, dump_mat
import numpy as np
#mf=guess.from_fch_simp("v2.fchk", xc='pbe0')

#mf2.verbose=9
#mf2.stability()
for r in np.arange(1.5, 3.0, 0.1):
    mol = gto.Mole(atom='''N 0.0 0.0 0.0; N 0.0 0.0 %f'''%r, basis='def2-svp', verbose=5).build()
    mf = dft.RKS(mol)
    mf.xc = 'pbe0'
    mf.kernel()
    dump_mat.dump_mo(mol, mf.mo_coeff[:,:12])
    print(mf.mo_energy[:12])
    
    mf2 = guess.check_stab(mf, newton=True, res=True)
    dump_mat.dump_mo(mol, mf2.mo_coeff[:,:12])
    print(mf2.mo_energy[:12])
    print('scan %.2f, %.6f' % (r, mf2.e_tot))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='xc06n05', release='3.10.0-1127.el7.x86_64', version='#1 SMP Tue Feb 18 16:39:12 EST 2020', machine='x86_64', processor='x86_64')  Threads 48
Python 3.7.4 (default, Aug 13 2019, 20:35:49) 
[GCC 7.3.0]
numpy 1.17.2  scipy 1.4.1
Date: Thu Sep 16 17:41:38 2021
PySCF version 1.7.6a1
PySCF path  /share/home/srwang/pyscf/pyscf
GIT ORIG_HEAD 80f71dfe77ac5f9caae26788acf76446987635bd
GIT HEAD      ref: refs/heads/master
GIT master branch  80f71dfe77ac5f9caae26788acf76446987635bd

[ENV] PYSCF_EXT_PATH /share/home/srwang/pyscf_ext/fciqmc:
[CONFIG] conf_file /share/home/srwang/.pyscf_conf.py
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 2
[INPUT] num. electrons = 14
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 N      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 N      0.000000000000   0.000000000000   2.300000000000 AA    0.000000000000   0.000000000000   4.346370086500 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] N
[INPUT] 0    0    [5    /1   ]  1712.8415853      -0.0053934125305
                                257.64812677      -0.040221581118
                                58.458245853      -0.1793114499
                                16.198367905      -0.46376317823
                                5.0052600809      -0.44171422662
[INPUT] 0    0    [1    /1   ]  0.58731856571        1
[INPUT] 0    0    [1    /1   ]  0.18764592253        1
[INPUT] 1    0    [3    /1   ]  13.571470233      -0.040072398852
                                2.9257372874      -0.21807045028
                                0.79927750754     -0.51294466049
[INPUT] 1    0    [1    /1   ]  0.21954348034        1
[INPUT] 2    0    [1    /1   ]  1                    1

nuclear repulsion = 11.2737753630783
number of shells = 12
number of NR pGTOs = 48
number of NR cGTOs = 28
basis = def2-svp
ecp = {}
CPU time:       134.22


******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmp5omvjxj2
max_memory 4000 MB (current use 259 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2aaf78ea5830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2aaf78ea5cb0>
Set gradient conv threshold to 3.16228e-05
atom N rad-grids = 75, ang-grids = [ 50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  86  86  86  86  86  86  86  86  86 266 266 266 266 266 266 266
 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266]
tot grids = 28092
Drop grids 3662
    CPU time for setting up grids      0.24 sec, wall time      0.01 sec
nelec by numeric integration = 13.9922590639575
    CPU time for vxc      0.79 sec, wall time      0.02 sec
E1 = -170.84437503462922  Ecoul = 64.2133876119831  Exc = -13.130163715741531
init E= -108.487375775309
cond(S) = 20.68437325853798
    CPU time for initialize scf      1.78 sec, wall time      0.04 sec
  HOMO = -0.216983039518443  LUMO = -0.18003235172929
  mo_energy =
[-14.377945 -14.377897  -0.722506  -0.663404  -0.252698  -0.216983  -0.216983  -0.180032  -0.180032  -0.119587   0.55623    0.639457   0.707405   0.707405
   0.800754   0.817758   0.817758   1.000548   2.122567   2.146912   2.146912   2.153734   2.153735   2.155171   2.155171   2.170565   2.170565   2.332871]
nelec by numeric integration = 13.999990383609799
    CPU time for vxc      0.83 sec, wall time      0.02 sec
E1 = -168.76618549513685  Ecoul = 61.61605510199945  Exc = -12.851089029412446
cycle= 1 E= -108.727444059472  delta_E= -0.24  |g|= 0.257  |ddm|= 1.57
    CPU time for cycle= 1      1.09 sec, wall time      0.02 sec
  HOMO = -0.352212700306081  LUMO = -0.269408126709441
  mo_energy =
[-14.70409  -14.704076  -0.835478  -0.784289  -0.387518  -0.352213  -0.352213  -0.269408  -0.269408  -0.215997   0.480788   0.564796   0.612882   0.612882
   0.698867   0.728478   0.728478   0.919575   2.011013   2.034717   2.034717   2.039436   2.039437   2.042267   2.042267   2.060786   2.060786   2.224299]
nelec by numeric integration = 13.999990870430633
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -170.22963899214696  Ecoul = 63.305299055751235  Exc = -13.088907681447894
cycle= 2 E= -108.739472254765  delta_E= -0.012  |g|= 0.15  |ddm|= 0.461
    CPU time for cycle= 2      0.99 sec, wall time      0.02 sec
  HOMO = -0.30562864225826  LUMO = -0.220111429902311
  mo_energy =
[-14.572242 -14.572229  -0.78756   -0.734679  -0.340678  -0.305629  -0.305629  -0.220111  -0.220111  -0.163327   0.511734   0.596296   0.651685   0.651685
   0.741128   0.76553    0.76553    0.953893   2.058366   2.08212    2.08212    2.087022   2.087023   2.089865   2.089865   2.108257   2.108257   2.271696]
nelec by numeric integration = 13.999990638919737
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -169.69498085760267  Ecoul = 62.6750758046139  Exc = -12.999784143129945
cycle= 3 E= -108.74591383304  delta_E= -0.00644  |g|= 0.000961  |ddm|= 0.169
    CPU time for cycle= 3      0.98 sec, wall time      0.02 sec
  HOMO = -0.305535012642468  LUMO = -0.219959230845179
  mo_energy =
[-14.572264 -14.572251  -0.787428  -0.734596  -0.340596  -0.305535  -0.305535  -0.219959  -0.219959  -0.163027   0.511908   0.596365   0.651923   0.651923
   0.741354   0.765718   0.765718   0.954152   2.058587   2.082337   2.082337   2.087233   2.087233   2.090078   2.090078   2.108496   2.108496   2.271964]
nelec by numeric integration = 13.999990641742698
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -169.6945359633639  Ecoul = 62.67469533671785  Exc = -12.99984912187274
cycle= 4 E= -108.745914385441  delta_E= -5.52e-07  |g|= 0.000486  |ddm|= 0.00199
    CPU time for cycle= 4      0.98 sec, wall time      0.02 sec
  HOMO = -0.305535328798873  LUMO = -0.219948321126545
  mo_energy =
[-14.572211 -14.572198  -0.787442  -0.734571  -0.340593  -0.305535  -0.305535  -0.219948  -0.219948  -0.163014   0.5119     0.596428   0.651923   0.651923
   0.741353   0.765728   0.765728   0.95412    2.058595   2.082345   2.082345   2.08724    2.08724    2.090085   2.090085   2.108505   2.108505   2.27197 ]
nelec by numeric integration = 13.99999064101258
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -169.6943559039521  Ecoul = 62.67445974747705  Exc = -12.999793637802266
cycle= 5 E= -108.745914431199  delta_E= -4.58e-08  |g|= 5.18e-06  |ddm|= 0.000276
    CPU time for cycle= 5      0.98 sec, wall time      0.02 sec
  HOMO = -0.30553336223998  LUMO = -0.219948390955989
  mo_energy =
[-14.572204 -14.57219   -0.78744   -0.734569  -0.340591  -0.305533  -0.305533  -0.219948  -0.219948  -0.163014   0.511898   0.596425   0.651919   0.651919
   0.741352   0.765725   0.765725   0.954119   2.058593   2.082343   2.082343   2.087238   2.087238   2.090083   2.090083   2.108503   2.108503   2.271968]
nelec by numeric integration = 13.999990641008115
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -169.69434976710954  Ecoul = 62.67445220157534  Exc = -12.999792228749962
cycle= 6 E= -108.745914431206  delta_E= -6.85e-12  |g|= 3.81e-07  |ddm|= 8e-06
    CPU time for cycle= 6      0.98 sec, wall time      0.02 sec
  HOMO = -0.305533566278649  LUMO = -0.219948538975397
  mo_energy =
[-14.572205 -14.572191  -0.78744   -0.73457   -0.340591  -0.305534  -0.305534  -0.219949  -0.219949  -0.163014   0.511898   0.596425   0.651919   0.651919
   0.741352   0.765725   0.765725   0.954119   2.058593   2.082343   2.082343   2.087238   2.087238   2.090083   2.090083   2.108503   2.108503   2.271968]
nelec by numeric integration = 13.999990641008354
    CPU time for vxc      0.83 sec, wall time      0.02 sec
E1 = -169.69435144089564  Ecoul = 62.67445412956176  Exc = -12.999792482949786
Extra cycle  E= -108.745914431205  delta_E= 5.12e-13  |g|= 1.71e-06  |ddm|= 8.91e-07
    CPU time for scf_cycle      8.78 sec, wall time      0.18 sec
    CPU time for SCF      8.80 sec, wall time      0.18 sec
converged SCF energy = -108.745914431205
             #0      #1      #2      #3      #4      #5     
  0 N 1s       0.702   0.698   0.215  -0.226                
  0 N 2s                       0.464  -0.496                
  0 N 3s                       0.284  -0.298                
  0 N 2px                                              0.349
  0 N 2py                                              0.286
  0 N 2pz                                      0.439        
  0 N 3px                                             -0.263
  0 N 3py                                             -0.215
  0 N 3pz                                     -0.313        
  1 N 1s      -0.698   0.702   0.215   0.226                
  1 N 2s                       0.464   0.496                
  1 N 3s                       0.284   0.298                
  1 N 2px                                              0.349
  1 N 2py                                              0.286
  1 N 2pz                                     -0.439        
  1 N 3px                                             -0.263
  1 N 3py                                             -0.215
  1 N 3pz                                      0.313        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                       0.219   0.185
  0 N 2s                                       1.123   1.006
  0 N 3s                                      -1.050  -1.044
  0 N 2px     -0.286  -0.428   0.213                        
  0 N 2py      0.349  -0.213  -0.428                        
  0 N 2pz                              0.505           0.356
  0 N 3px      0.215   0.310  -0.155                        
  0 N 3py     -0.263   0.155   0.310                        
  0 N 3pz                             -0.382           0.327
  1 N 1s                                       0.219  -0.185
  1 N 2s                                       1.123  -1.006
  1 N 3s                                      -1.050   1.044
  1 N 2px     -0.286   0.428  -0.213                        
  1 N 2py      0.349   0.213   0.428                        
  1 N 2pz                              0.505           0.356
  1 N 3px      0.215  -0.310   0.155                        
  1 N 3py     -0.263  -0.155  -0.310                        
  1 N 3pz                             -0.382           0.327
[-14.572205 -14.572191  -0.78744   -0.73457   -0.340591  -0.305534  -0.305534  -0.219949  -0.219949  -0.163014   0.511898   0.596425]
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 13.999990641008354
    CPU time for vxc      0.80 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 3.44  e= [1.49268]  max|de|= 1.49  lindep= 0.988
davidson 1 2  |r|= 1.55  e= [0.484776]  max|de|= -1.01  lindep= 0.899
davidson 2 3  |r|= 0.343  e= [0.186807]  max|de|= -0.298  lindep=  0.9
davidson 3 4  |r|= 0.232  e= [0.143982]  max|de|= -0.0428  lindep= 0.798
davidson 4 5  |r|= 0.201  e= [0.113587]  max|de|= -0.0304  lindep= 0.654
davidson 5 6  |r|= 0.25  e= [-0.019953]  max|de|= -0.134  lindep= 0.713
davidson 6 7  |r|= 0.0658  e= [-0.02961]  max|de|= -0.00966  lindep= 0.857
davidson 7 8  |r|= 0.00776  e= [-0.03019]  max|de|= -0.00058  lindep= 0.764
root 0 converged  |r|= 0.00486  e= -0.03021282570800681  max|de|= -2.29e-05
converged 8 9  |r|= 0.00486  e= [-0.030213]  max|de|= -2.29e-05
RHF/RKS wavefunction has an internal instability




******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmp5omvjxj2
max_memory 4000 MB (current use 259 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2aaf78ea5830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2aaf78ea5cb0>
******** <class 'pyscf.dft.rks.RKS'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmp5omvjxj2
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 259 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.292284899647411  LUMO = -0.18865047114141
Initial guess E= -108.741309402439  |g|= 0.0412993
macro= 0  E= -108.747379879147  delta_E= -0.00607048  |g|= 0.00827482  3 KF 10 JK
macro= 1  E= -108.747553871636  delta_E= -0.000173992  |g|= 0.00769723  2 KF 7 JK
macro= 2  E= -108.747561243396  delta_E= -7.37176e-06  |g|= 0.000141875  2 KF 10 JK
macro= 3  E= -108.747561243396  delta_E= 0  |g|= 3.43868e-06  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 4  E=-108.747561243396  |g|= 3.43868e-06  total 9 KF 34 JK
converged SCF energy = -108.747561243396
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 13.999990603306099
    CPU time for vxc      0.81 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 1.72  e= [0.537064]  max|de|= 0.537  lindep= 0.833
davidson 1 2  |r|= 1.03  e= [0.307826]  max|de|= -0.229  lindep= 0.878
davidson 2 3  |r|= 0.384  e= [0.220116]  max|de|= -0.0877  lindep= 0.731
davidson 3 4  |r|= 0.362  e= [0.113283]  max|de|= -0.107  lindep= 0.813
davidson 4 5  |r|= 0.135  e= [0.080395]  max|de|= -0.0329  lindep= 0.721
davidson 5 6  |r|= 0.148  e= [0.065892]  max|de|= -0.0145  lindep= 0.786
davidson 6 7  |r|= 0.0639  e= [0.059392]  max|de|= -0.0065  lindep= 0.747
davidson 7 8  |r|= 0.0749  e= [0.056064]  max|de|= -0.00333  lindep= 0.738
davidson 8 9  |r|= 0.0661  e= [0.052212]  max|de|= -0.00385  lindep= 0.665
davidson 9 10  |r|= 0.243  e= [0.027102]  max|de|= -0.0251  lindep= 0.782
davidson 10 11  |r|= 0.121  e= [0.006318]  max|de|= -0.0208  lindep= 0.676
davidson 11 12  |r|= 0.0541  e= [0.001069]  max|de|= -0.00525  lindep= 0.844
davidson 12 1  |r|= 0.0541  e= [0.001069]  max|de|= -1.62e-16  lindep= 0.996
davidson 13 2  |r|= 0.0196  e= [0.000349]  max|de|= -0.00072  lindep= 0.879
davidson 14 3  |r|= 0.0231  e= [0.0003]  max|de|= -4.95e-05  lindep= 0.767
davidson 15 4  |r|= 0.0155  e= [0.000079]  max|de|= -0.000221  lindep= 0.728
root 0 converged  |r|= 0.00402  e= 7.358134993751264e-06  max|de|= -7.16e-05
converged 16 5  |r|= 0.00402  e= [0.000007]  max|de|= -7.16e-05
RHF/RKS wavefunction is stable in the internal stability analysis
             #0      #1      #2      #3      #4      #5     
  0 N 1s      -0.656   0.741   0.215  -0.226                
  0 N 2s                       0.462  -0.494                
  0 N 3s                       0.285  -0.301                
  0 N 2py                                             -0.254
  0 N 2pz                                      0.437        
  0 N 3py                                              0.204
  0 N 3pz                                     -0.314        
  1 N 1s       0.741   0.656   0.215   0.226                
  1 N 2s                       0.462   0.494                
  1 N 3s                       0.285   0.301                
  1 N 2px                                             -0.132
  1 N 2py                                             -0.572
  1 N 2pz                                     -0.437        
  1 N 3py                                              0.418
  1 N 3pz                                      0.314        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                      -0.219  -0.185
  0 N 2s                                      -1.123  -1.007
  0 N 3s                                       1.049   1.044
  0 N 2px      0.572  -0.308                                
  0 N 2py     -0.132          -0.581                        
  0 N 2pz                             -0.504          -0.357
  0 N 3px     -0.418   0.214                                
  0 N 3py                      0.441                        
  0 N 3pz                              0.384          -0.326
  1 N 1s                                      -0.219   0.185
  1 N 2s                                      -1.123   1.007
  1 N 3s                                       1.049  -1.044
  1 N 2px      0.254   0.581                                
  1 N 2py                      0.308                        
  1 N 2pz                             -0.504          -0.357
  1 N 3px     -0.204  -0.441                                
  1 N 3py                     -0.214                        
  1 N 3pz                              0.384          -0.326
[-14.563782 -14.563762  -0.782465  -0.729662  -0.337081  -0.304924  -0.304923  -0.210489  -0.210489  -0.159198   0.51484    0.599819]
scan 2.30, -108.747561
#INFO: **** input file is /share/home/srwang/pyAutoMR/examples/guess/N2-RKS.py ****
from pyscf import gto, dft
from automr import guess, dump_mat
import numpy as np
#mf=guess.from_fch_simp("v2.fchk", xc='pbe0')

#mf2.verbose=9
#mf2.stability()
for r in np.arange(1.5, 3.0, 0.1):
    mol = gto.Mole(atom='''N 0.0 0.0 0.0; N 0.0 0.0 %f'''%r, basis='def2-svp', verbose=5).build()
    mf = dft.RKS(mol)
    mf.xc = 'pbe0'
    mf.kernel()
    dump_mat.dump_mo(mol, mf.mo_coeff[:,:12])
    print(mf.mo_energy[:12])
    
    mf2 = guess.check_stab(mf, newton=True, res=True)
    dump_mat.dump_mo(mol, mf2.mo_coeff[:,:12])
    print(mf2.mo_energy[:12])
    print('scan %.2f, %.6f' % (r, mf2.e_tot))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='xc06n05', release='3.10.0-1127.el7.x86_64', version='#1 SMP Tue Feb 18 16:39:12 EST 2020', machine='x86_64', processor='x86_64')  Threads 48
Python 3.7.4 (default, Aug 13 2019, 20:35:49) 
[GCC 7.3.0]
numpy 1.17.2  scipy 1.4.1
Date: Thu Sep 16 17:41:39 2021
PySCF version 1.7.6a1
PySCF path  /share/home/srwang/pyscf/pyscf
GIT ORIG_HEAD 80f71dfe77ac5f9caae26788acf76446987635bd
GIT HEAD      ref: refs/heads/master
GIT master branch  80f71dfe77ac5f9caae26788acf76446987635bd

[ENV] PYSCF_EXT_PATH /share/home/srwang/pyscf_ext/fciqmc:
[CONFIG] conf_file /share/home/srwang/.pyscf_conf.py
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 2
[INPUT] num. electrons = 14
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 N      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 N      0.000000000000   0.000000000000   2.400000000000 AA    0.000000000000   0.000000000000   4.535342698956 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] N
[INPUT] 0    0    [5    /1   ]  1712.8415853      -0.0053934125305
                                257.64812677      -0.040221581118
                                58.458245853      -0.1793114499
                                16.198367905      -0.46376317823
                                5.0052600809      -0.44171422662
[INPUT] 0    0    [1    /1   ]  0.58731856571        1
[INPUT] 0    0    [1    /1   ]  0.18764592253        1
[INPUT] 1    0    [3    /1   ]  13.571470233      -0.040072398852
                                2.9257372874      -0.21807045028
                                0.79927750754     -0.51294466049
[INPUT] 1    0    [1    /1   ]  0.21954348034        1
[INPUT] 2    0    [1    /1   ]  1                    1

nuclear repulsion = 10.80403472295
number of shells = 12
number of NR pGTOs = 48
number of NR cGTOs = 28
basis = def2-svp
ecp = {}
CPU time:       172.21


******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmp9u4uq5lt
max_memory 4000 MB (current use 259 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2aaf78ea5830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2aaf78ea5cb0>
Set gradient conv threshold to 3.16228e-05
atom N rad-grids = 75, ang-grids = [ 50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  86  86  86  86  86  86  86  86  86 266 266 266 266 266 266 266
 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266]
tot grids = 28092
Drop grids 3652
    CPU time for setting up grids      0.25 sec, wall time      0.01 sec
nelec by numeric integration = 13.992247394845855
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -169.9058980629566  Ecoul = 63.747083755999675  Exc = -13.12588118487602
init E= -108.480660768883
cond(S) = 18.243421711265476
    CPU time for initialize scf      1.81 sec, wall time      0.04 sec
  HOMO = -0.213545446688708  LUMO = -0.183133344111436
  mo_energy =
[-14.377864 -14.377802  -0.715716  -0.668233  -0.24662   -0.213545  -0.213545  -0.183133  -0.183133  -0.131955   0.548211   0.63626    0.708573   0.708573
   0.7746     0.813757   0.813757   1.009747   2.141102   2.151096   2.151096   2.154216   2.154234   2.154915   2.154934   2.163687   2.163687   2.278992]
nelec by numeric integration = 13.999996970253598
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -167.83433739710745  Ecoul = 61.17100081202307  Exc = -12.843468556439786
cycle= 1 E= -108.702770418574  delta_E= -0.222  |g|= 0.256  |ddm|= 1.58
    CPU time for cycle= 1      1.09 sec, wall time      0.02 sec
  HOMO = -0.347329453746781  LUMO = -0.271957443086075
  mo_energy =
[-14.701303 -14.701274  -0.828415  -0.787462  -0.378985  -0.347329  -0.347329  -0.271957  -0.271957  -0.226248   0.473077   0.561899   0.615625   0.615625
   0.675993   0.724907   0.724907   0.928188   2.030394   2.039808   2.039808   2.040859   2.040876   2.042808   2.042825   2.054608   2.054608   2.171408]
nelec by numeric integration = 13.999999251107067
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -169.29428149168857  Ecoul = 62.858622118764885  Exc = -13.082942595105003
cycle= 2 E= -108.714567245079  delta_E= -0.0118  |g|= 0.151  |ddm|= 0.461
    CPU time for cycle= 2      1.00 sec, wall time      0.02 sec
  HOMO = -0.30104346217371  LUMO = -0.223239478648709
  mo_energy =
[-14.570141 -14.570112  -0.780993  -0.738308  -0.33297   -0.301043  -0.301043  -0.223239  -0.223239  -0.174645   0.503794   0.593261   0.653785   0.653785
   0.716895   0.761768   0.761768   0.96264    2.077284   2.086757   2.086757   2.088044   2.088061   2.090001   2.090019   2.101586   2.101586   2.218216]
nelec by numeric integration = 13.999998346656783
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -168.75737502060286  Ecoul = 62.22484980398175  Exc = -12.992648261572546
cycle= 3 E= -108.721138755244  delta_E= -0.00657  |g|= 0.00098  |ddm|= 0.17
    CPU time for cycle= 3      0.99 sec, wall time      0.02 sec
  HOMO = -0.300889359586529  LUMO = -0.223023712097673
  mo_energy =
[-14.569952 -14.569923  -0.780811  -0.738154  -0.332817  -0.300889  -0.300889  -0.223024  -0.223024  -0.174276   0.504023   0.593385   0.654076   0.654076
   0.717164   0.762011   0.762011   0.962952   2.077566   2.087036   2.087036   2.088319   2.088336   2.090278   2.090296   2.101885   2.101885   2.218541]
nelec by numeric integration = 13.999998348333115
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -168.7561596907285  Ecoul = 62.22356287644921  Exc = -12.992577241053873
cycle= 4 E= -108.721139332383  delta_E= -5.77e-07  |g|= 0.000467  |ddm|= 0.00193
    CPU time for cycle= 4      0.99 sec, wall time      0.02 sec
  HOMO = -0.300891740795938  LUMO = -0.223017289685539
  mo_energy =
[-14.56991  -14.56988   -0.780825  -0.738136  -0.332818  -0.300892  -0.300892  -0.223017  -0.223017  -0.174266   0.504003   0.593442   0.654072   0.654072
   0.71717    0.762017   0.762017   0.962916   2.07757    2.08704    2.08704    2.088322   2.08834    2.090282   2.0903     2.10189    2.10189    2.218544]
nelec by numeric integration = 13.999998348211932
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -168.75602248040946  Ecoul = 62.22337906184965  Exc = -12.992530679597998
cycle= 5 E= -108.721139375208  delta_E= -4.28e-08  |g|= 5.9e-06  |ddm|= 0.000271
    CPU time for cycle= 5      0.99 sec, wall time      0.02 sec
  HOMO = -0.300889255343224  LUMO = -0.22301680881604
  mo_energy =
[-14.569901 -14.569871  -0.780823  -0.738135  -0.332815  -0.300889  -0.300889  -0.223017  -0.223017  -0.174265   0.504001   0.593439   0.654069   0.654069
   0.717169   0.762015   0.762015   0.962916   2.077569   2.087039   2.087039   2.088321   2.088339   2.090281   2.090298   2.101889   2.101889   2.218543]
nelec by numeric integration = 13.999998348191186
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -168.7560124197219  Ecoul = 62.22336703070804  Exc = -12.992528709153014
cycle= 6 E= -108.721139375217  delta_E= -9.09e-12  |g|= 1.06e-06  |ddm|= 8.75e-06
    CPU time for cycle= 6      0.99 sec, wall time      0.02 sec
  HOMO = -0.300889465550255  LUMO = -0.223016966295568
  mo_energy =
[-14.569902 -14.569872  -0.780823  -0.738135  -0.332815  -0.300889  -0.300889  -0.223017  -0.223017  -0.174265   0.504001   0.593439   0.654069   0.654069
   0.717168   0.762015   0.762015   0.962916   2.077569   2.087039   2.087039   2.088321   2.088339   2.090281   2.090298   2.101888   2.101888   2.218543]
nelec by numeric integration = 13.999998348194126
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -168.7560141391607  Ecoul = 62.22336901470767  Exc = -12.99252897361059
Extra cycle  E= -108.721139375114  delta_E= 1.03e-10  |g|= 2.39e-05  |ddm|= 9.63e-06
    CPU time for scf_cycle      8.85 sec, wall time      0.18 sec
    CPU time for SCF      8.87 sec, wall time      0.18 sec
converged SCF energy = -108.721139375114
             #0      #1      #2      #3      #4      #5     
  0 N 1s      -0.689   0.711   0.216   0.225                
  0 N 2s                       0.466   0.494                
  0 N 3s                       0.287   0.297                
  0 N 2px                                              0.412
  0 N 2py                                              0.188
  0 N 2pz                                     -0.439        
  0 N 3px                                             -0.311
  0 N 3py                                             -0.142
  0 N 3pz                                      0.318        
  1 N 1s       0.711   0.689   0.216  -0.225                
  1 N 2s                       0.466  -0.494                
  1 N 3s                       0.287  -0.297                
  1 N 2px                                              0.412
  1 N 2py                                              0.188
  1 N 2pz                                      0.439        
  1 N 3px                                             -0.311
  1 N 3py                                             -0.142
  1 N 3pz                                     -0.318        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                       0.218  -0.187
  0 N 2s                                       1.114  -1.017
  0 N 3s                                      -1.044   1.051
  0 N 2px     -0.188   0.464  -0.108                        
  0 N 2py      0.412   0.108   0.464                        
  0 N 2pz                              0.501          -0.343
  0 N 3px      0.142  -0.336                                
  0 N 3py     -0.311          -0.336                        
  0 N 3pz                             -0.373          -0.316
  1 N 1s                                       0.218   0.187
  1 N 2s                                       1.114   1.017
  1 N 3s                                      -1.044  -1.051
  1 N 2px     -0.188  -0.464   0.108                        
  1 N 2py      0.412  -0.108  -0.464                        
  1 N 2pz                              0.501          -0.343
  1 N 3px      0.142   0.336                                
  1 N 3py     -0.311           0.336                        
  1 N 3pz                             -0.373          -0.316
[-14.569902 -14.569872  -0.780823  -0.738135  -0.332815  -0.300889  -0.300889  -0.223017  -0.223017  -0.174265   0.504001   0.593439]
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 13.999998348194122
    CPU time for vxc      0.80 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 3.52  e= [1.4435]  max|de|= 1.44  lindep= 0.991
davidson 1 2  |r|= 1.43  e= [0.365178]  max|de|= -1.08  lindep= 0.808
davidson 2 3  |r|= 0.439  e= [-0.015017]  max|de|= -0.38  lindep= 0.841
davidson 3 4  |r|= 0.161  e= [-0.052926]  max|de|= -0.0379  lindep= 0.748
davidson 4 5  |r|= 0.0476  e= [-0.058604]  max|de|= -0.00568  lindep= 0.697
davidson 5 6  |r|= 0.0321  e= [-0.059478]  max|de|= -0.000874  lindep= 0.78
davidson 6 7  |r|= 0.0108  e= [-0.059715]  max|de|= -0.000236  lindep= 0.714
root 0 converged  |r|= 0.00443  e= -0.05975029678453483  max|de|= -3.58e-05
converged 7 8  |r|= 0.00443  e= [-0.05975]  max|de|= -3.58e-05
RHF/RKS wavefunction has an internal instability




******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmp9u4uq5lt
max_memory 4000 MB (current use 260 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2aaf78ea5830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2aaf78ea5cb0>
******** <class 'pyscf.dft.rks.RKS'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmp9u4uq5lt
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 260 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.290100449933619  LUMO = -0.191127122170678
Initial guess E= -108.723840741023  |g|= 0.0411553
macro= 0  E= -108.726444158616  delta_E= -0.00260342  |g|= 0.0411553  2 KF 6 JK
macro= 1  E= -108.7270638412  delta_E= -0.000619683  |g|= 0.0297866  2 KF 6 JK
macro= 2  E= -108.727175842716  delta_E= -0.000112002  |g|= 0.000163063  3 KF 12 JK
macro= 3  E= -108.727175843875  delta_E= -1.15926e-09  |g|= 3.62745e-05  1 KF 5 JK
macro= 4  E= -108.727175843875  delta_E= 0  |g|= 2.9047e-06  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 5  E=-108.727175843875  |g|= 2.9047e-06  total 10 KF 37 JK
converged SCF energy = -108.727175843875
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 13.999998422403792
    CPU time for vxc      0.81 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 1.84  e= [0.678136]  max|de|= 0.678  lindep= 0.965
davidson 1 2  |r|= 1.46  e= [0.473891]  max|de|= -0.204  lindep= 0.991
davidson 2 3  |r|= 0.292  e= [0.192251]  max|de|= -0.282  lindep= 0.681
davidson 3 4  |r|= 0.236  e= [0.150009]  max|de|= -0.0422  lindep= 0.841
davidson 4 5  |r|= 0.102  e= [0.134244]  max|de|= -0.0158  lindep= 0.678
davidson 5 6  |r|= 0.292  e= [0.110047]  max|de|= -0.0242  lindep= 0.809
davidson 6 7  |r|= 0.187  e= [0.072701]  max|de|= -0.0373  lindep= 0.653
davidson 7 8  |r|= 0.269  e= [0.018373]  max|de|= -0.0543  lindep= 0.687
davidson 8 9  |r|= 0.0772  e= [0.003396]  max|de|= -0.015  lindep= 0.678
davidson 9 10  |r|= 0.0569  e= [0.000785]  max|de|= -0.00261  lindep= 0.614
davidson 10 11  |r|= 0.0119  e= [0.00001]  max|de|= -0.000775  lindep= 0.898
root 0 converged  |r|= 0.00204  e= -9.415614900741763e-06  max|de|= -1.93e-05
converged 11 12  |r|= 0.00204  e= [-0.000009]  max|de|= -1.93e-05
RHF/RKS wavefunction is stable in the internal stability analysis
             #0      #1      #2      #3      #4      #5     
  0 N 1s      -0.704   0.696   0.216  -0.225                
  0 N 2s                       0.463  -0.491                
  0 N 3s                       0.289  -0.300                
  0 N 2py                                              0.430
  0 N 2pz                                      0.436        
  0 N 3py                                             -0.319
  0 N 3pz                                     -0.320        
  1 N 1s       0.696   0.704   0.216   0.225                
  1 N 2s                       0.463   0.491                
  1 N 3s                       0.289   0.300                
  1 N 2px                                             -0.370
  1 N 2py                                              0.316
  1 N 2pz                                     -0.436        
  1 N 3px                                              0.263
  1 N 3py                                             -0.242
  1 N 3pz                                      0.320        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                       0.218   0.188
  0 N 2s                                       1.114   1.019
  0 N 3s                                      -1.043  -1.052
  0 N 2px      0.316   0.335  -0.452                        
  0 N 2py      0.370  -0.335                                
  0 N 2pz                              0.499           0.344
  0 N 3px     -0.241  -0.265   0.342                        
  0 N 3py     -0.263   0.245                                
  0 N 3pz                             -0.376           0.314
  1 N 1s                                       0.218  -0.188
  1 N 2s                                       1.114  -1.019
  1 N 3s                                      -1.043   1.052
  1 N 2px      0.430           0.335                        
  1 N 2py              0.452   0.335                        
  1 N 2pz                              0.499           0.344
  1 N 3px     -0.319          -0.245                        
  1 N 3py             -0.342  -0.265                        
  1 N 3pz                             -0.376           0.314
[-14.555988 -14.555947  -0.77229   -0.72991   -0.326982  -0.300944  -0.300943  -0.205936  -0.205935  -0.16786    0.508849   0.599038]
scan 2.40, -108.727176
#INFO: **** input file is /share/home/srwang/pyAutoMR/examples/guess/N2-RKS.py ****
from pyscf import gto, dft
from automr import guess, dump_mat
import numpy as np
#mf=guess.from_fch_simp("v2.fchk", xc='pbe0')

#mf2.verbose=9
#mf2.stability()
for r in np.arange(1.5, 3.0, 0.1):
    mol = gto.Mole(atom='''N 0.0 0.0 0.0; N 0.0 0.0 %f'''%r, basis='def2-svp', verbose=5).build()
    mf = dft.RKS(mol)
    mf.xc = 'pbe0'
    mf.kernel()
    dump_mat.dump_mo(mol, mf.mo_coeff[:,:12])
    print(mf.mo_energy[:12])
    
    mf2 = guess.check_stab(mf, newton=True, res=True)
    dump_mat.dump_mo(mol, mf2.mo_coeff[:,:12])
    print(mf2.mo_energy[:12])
    print('scan %.2f, %.6f' % (r, mf2.e_tot))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='xc06n05', release='3.10.0-1127.el7.x86_64', version='#1 SMP Tue Feb 18 16:39:12 EST 2020', machine='x86_64', processor='x86_64')  Threads 48
Python 3.7.4 (default, Aug 13 2019, 20:35:49) 
[GCC 7.3.0]
numpy 1.17.2  scipy 1.4.1
Date: Thu Sep 16 17:41:39 2021
PySCF version 1.7.6a1
PySCF path  /share/home/srwang/pyscf/pyscf
GIT ORIG_HEAD 80f71dfe77ac5f9caae26788acf76446987635bd
GIT HEAD      ref: refs/heads/master
GIT master branch  80f71dfe77ac5f9caae26788acf76446987635bd

[ENV] PYSCF_EXT_PATH /share/home/srwang/pyscf_ext/fciqmc:
[CONFIG] conf_file /share/home/srwang/.pyscf_conf.py
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 2
[INPUT] num. electrons = 14
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 N      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 N      0.000000000000   0.000000000000   2.500000000000 AA    0.000000000000   0.000000000000   4.724315311413 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] N
[INPUT] 0    0    [5    /1   ]  1712.8415853      -0.0053934125305
                                257.64812677      -0.040221581118
                                58.458245853      -0.1793114499
                                16.198367905      -0.46376317823
                                5.0052600809      -0.44171422662
[INPUT] 0    0    [1    /1   ]  0.58731856571        1
[INPUT] 0    0    [1    /1   ]  0.18764592253        1
[INPUT] 1    0    [3    /1   ]  13.571470233      -0.040072398852
                                2.9257372874      -0.21807045028
                                0.79927750754     -0.51294466049
[INPUT] 1    0    [1    /1   ]  0.21954348034        1
[INPUT] 2    0    [1    /1   ]  1                    1

nuclear repulsion = 10.371873334032
number of shells = 12
number of NR pGTOs = 48
number of NR cGTOs = 28
basis = def2-svp
ecp = {}
CPU time:       211.16


******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmp0_pzikqi
max_memory 4000 MB (current use 260 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2aaf78ea5830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2aaf78ea5cb0>
Set gradient conv threshold to 3.16228e-05
atom N rad-grids = 75, ang-grids = [ 50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  86  86  86  86  86  86  86  86  86 266 266 266 266 266 266 266
 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266]
tot grids = 28092
Drop grids 3610
    CPU time for setting up grids      0.25 sec, wall time      0.01 sec
nelec by numeric integration = 13.992240044341946
    CPU time for vxc      0.80 sec, wall time      0.02 sec
E1 = -169.0419973088753  Ecoul = 63.317024993143704  Exc = -13.122715706717234
init E= -108.475814688417
cond(S) = 16.387882608759586
    CPU time for initialize scf      1.83 sec, wall time      0.04 sec
  HOMO = -0.210732127356432  LUMO = -0.185716809628345
  mo_energy =
[-14.377831 -14.377756  -0.710352  -0.672246  -0.241115  -0.210732  -0.210732  -0.185717  -0.185717  -0.142208   0.539755   0.633159   0.710755   0.710755
   0.753116   0.809116   0.809116   1.01336    2.151449   2.153216   2.153216   2.15446    2.154497   2.154793   2.15483    2.159668   2.159668   2.238379]
nelec by numeric integration = 14.000009595141103
    CPU time for vxc      0.83 sec, wall time      0.02 sec
E1 = -166.97864302384656  Ecoul = 60.76358541925964  Exc = -12.83798715340237
cycle= 1 E= -108.681171423957  delta_E= -0.205  |g|= 0.254  |ddm|= 1.59
    CPU time for cycle= 1      1.10 sec, wall time      0.02 sec
  HOMO = -0.343079450739538  LUMO = -0.273951841132206
  mo_energy =
[-14.698211 -14.698169  -0.82273   -0.789823  -0.371259  -0.343079  -0.343079  -0.273952  -0.273952  -0.234648   0.465129   0.559315   0.619265   0.619265
   0.657523   0.720819   0.720819   0.931494   2.041584   2.042079   2.042115   2.042797   2.042797   2.043534   2.04357    2.051233   2.051233   2.131557]
nelec by numeric integration = 14.000013326143018
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -168.4340249063598  Ecoul = 62.447907090989396  Exc = -13.078458814099713
cycle= 2 E= -108.692703295438  delta_E= -0.0115  |g|= 0.152  |ddm|= 0.459
    CPU time for cycle= 2      1.00 sec, wall time      0.02 sec
  HOMO = -0.297065821254709  LUMO = -0.22578826239376
  mo_energy =
[-14.56784  -14.567797  -0.775696  -0.741144  -0.325959  -0.297066  -0.297066  -0.225788  -0.225788  -0.184007   0.495558   0.590452   0.656867   0.656867
   0.697193   0.757467   0.757467   0.966019   2.088048   2.088882   2.088918   2.089335   2.089335   2.090343   2.090379   2.097783   2.097783   2.177883]
nelec by numeric integration = 14.00001189836291
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -167.8951593162534  Ecoul = 61.81114255603889  Exc = -12.98722529532948
cycle= 3 E= -108.699368721512  delta_E= -0.00667  |g|= 0.00099  |ddm|= 0.171
    CPU time for cycle= 3      0.99 sec, wall time      0.02 sec
  HOMO = -0.2968835500743  LUMO = -0.22554365437545
  mo_energy =
[-14.567531 -14.567488  -0.775499  -0.740957  -0.325772  -0.296884  -0.296884  -0.225544  -0.225544  -0.18361    0.495814   0.590611   0.65718    0.65718
   0.697476   0.757738   0.757738   0.966356   2.088357   2.089187   2.089223   2.089641   2.089641   2.09065    2.090686   2.098105   2.098105   2.178228]
nelec by numeric integration = 14.000011896190383
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -167.89351966641055  Ecoul = 61.80934842335167  Exc = -12.987071397082797
cycle= 4 E= -108.69936930611  delta_E= -5.85e-07  |g|= 0.000432  |ddm|= 0.00189
    CPU time for cycle= 4      0.99 sec, wall time      0.02 sec
  HOMO = -0.296887436365224  LUMO = -0.225541131564013
  mo_energy =
[-14.567498 -14.567455  -0.775512  -0.740945  -0.325775  -0.296887  -0.296887  -0.225541  -0.225541  -0.183602   0.495784   0.59066    0.657175   0.657175
   0.697487   0.757741   0.757741   0.966318   2.088357   2.089187   2.089223   2.089641   2.089641   2.09065    2.090686   2.098106   2.098106   2.178228]
nelec by numeric integration = 14.000011897275067
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -167.89342492731276  Ecoul = 61.809216707544635  Exc = -12.987034457561391
cycle= 5 E= -108.699369343298  delta_E= -3.72e-08  |g|= 6.73e-06  |ddm|= 0.000257
    CPU time for cycle= 5      1.00 sec, wall time      0.02 sec
  HOMO = -0.296884616582821  LUMO = -0.225540240063604
  mo_energy =
[-14.567488 -14.567445  -0.775509  -0.740943  -0.325772  -0.296885  -0.296885  -0.22554   -0.22554   -0.183601   0.495783   0.590657   0.657172   0.657172
   0.697486   0.757739   0.757739   0.966318   2.088357   2.089186   2.089223   2.08964    2.08964    2.090649   2.090686   2.098105   2.098105   2.178228]
nelec by numeric integration = 14.000011897233138
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -167.8934118583726  Ecoul = 61.80920123210095  Exc = -12.98703205107013
cycle= 6 E= -108.69936934331  delta_E= -1.22e-11  |g|= 7.18e-07  |ddm|= 9.34e-06
    CPU time for cycle= 6      0.99 sec, wall time      0.02 sec
  HOMO = -0.296884834949178  LUMO = -0.225540408931132
  mo_energy =
[-14.567489 -14.567446  -0.775509  -0.740943  -0.325772  -0.296885  -0.296885  -0.22554   -0.22554   -0.183601   0.495783   0.590657   0.657172   0.657172
   0.697486   0.757739   0.757739   0.966318   2.088357   2.089186   2.089222   2.08964    2.08964    2.090649   2.090686   2.098105   2.098105   2.178227]
nelec by numeric integration = 14.000011897238753
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -167.8934136634391  Ecoul = 61.80920331871337  Exc = -12.987032332570838
Extra cycle  E= -108.699369343265  delta_E= 4.52e-11  |g|= 1.59e-05  |ddm|= 6.29e-06
    CPU time for scf_cycle      8.88 sec, wall time      0.19 sec
    CPU time for SCF      8.90 sec, wall time      0.19 sec
converged SCF energy = -108.699369343265
             #0      #1      #2      #3      #4      #5     
  0 N 1s       0.705   0.696   0.217  -0.225                
  0 N 2s                       0.468  -0.492                
  0 N 3s                       0.289  -0.296                
  0 N 2py                                              0.450
  0 N 2pz                                      0.439        
  0 N 3py                                             -0.339
  0 N 3pz                                     -0.323        
  1 N 1s      -0.695   0.705   0.217   0.225                
  1 N 2s                       0.468   0.492                
  1 N 3s                       0.289   0.296                
  1 N 2py                                              0.450
  1 N 2pz                                     -0.439        
  1 N 3py                                             -0.339
  1 N 3pz                                      0.323        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                       0.215   0.189
  0 N 2s                                       1.100   1.028
  0 N 3s                                      -1.035  -1.058
  0 N 2px      0.450  -0.336   0.335                        
  0 N 2py             -0.335  -0.336                        
  0 N 2pz                              0.497  -0.111   0.331
  0 N 3px     -0.339   0.243  -0.243                        
  0 N 3py              0.243   0.243                        
  0 N 3pz                             -0.366           0.306
  1 N 1s                                       0.215  -0.189
  1 N 2s                                       1.100  -1.028
  1 N 3s                                      -1.035   1.058
  1 N 2px      0.450   0.336  -0.335                        
  1 N 2py              0.335   0.336                        
  1 N 2pz                              0.497   0.111   0.331
  1 N 3px     -0.339  -0.243   0.243                        
  1 N 3py             -0.243  -0.243                        
  1 N 3pz                             -0.366           0.306
[-14.567489 -14.567446  -0.775509  -0.740943  -0.325772  -0.296885  -0.296885  -0.22554   -0.22554   -0.183601   0.495783   0.590657]
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 14.000011897238753
    CPU time for vxc      0.80 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|=  2.8  e= [0.893201]  max|de|= 0.893  lindep= 0.987
davidson 1 2  |r|= 1.26  e= [0.273493]  max|de|= -0.62  lindep= 0.632
davidson 2 3  |r|= 0.289  e= [-0.042381]  max|de|= -0.316  lindep= 0.884
davidson 3 4  |r|= 0.158  e= [-0.076698]  max|de|= -0.0343  lindep= 0.674
davidson 4 5  |r|= 0.0574  e= [-0.084162]  max|de|= -0.00746  lindep= 0.687
davidson 5 6  |r|= 0.00956  e= [-0.08469]  max|de|= -0.000528  lindep= 0.69
root 0 converged  |r|= 0.0029  e= -0.08471039136763517  max|de|= -2.02e-05
converged 6 7  |r|= 0.0029  e= [-0.08471]  max|de|= -2.02e-05
RHF/RKS wavefunction has an internal instability




******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmp0_pzikqi
max_memory 4000 MB (current use 261 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2aaf78ea5830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2aaf78ea5cb0>
******** <class 'pyscf.dft.rks.RKS'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmp0_pzikqi
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 261 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.290401810892866  LUMO = -0.191657456125782
Initial guess E= -108.709298035605  |g|= 0.0287105
macro= 0  E= -108.710805019575  delta_E= -0.00150698  |g|= 0.0287105  2 KF 6 JK
macro= 1  E= -108.710875311844  delta_E= -7.02923e-05  |g|= 0.00264493  3 KF 9 JK
macro= 2  E= -108.710875334931  delta_E= -2.30876e-08  |g|= 1.37362e-05  2 KF 8 JK
macro= 3  E= -108.710875334931  delta_E= 5.68434e-14  |g|= 9.55549e-06  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 4  E=-108.710875334931  |g|= 9.55549e-06  total 9 KF 30 JK
converged SCF energy = -108.710875334931
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 14.000012189150695
    CPU time for vxc      0.81 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 2.41  e= [0.998802]  max|de|= 0.999  lindep= 0.991
davidson 1 2  |r|= 1.57  e= [0.412865]  max|de|= -0.586  lindep= 0.841
davidson 2 3  |r|= 0.278  e= [0.042344]  max|de|= -0.371  lindep= 0.846
davidson 3 4  |r|= 0.148  e= [0.021013]  max|de|= -0.0213  lindep= 0.691
davidson 4 5  |r|= 0.116  e= [0.011424]  max|de|= -0.00959  lindep= 0.696
davidson 5 6  |r|= 0.079  e= [0.005955]  max|de|= -0.00547  lindep= 0.634
davidson 6 7  |r|= 0.0618  e= [0.001825]  max|de|= -0.00413  lindep= 0.837
davidson 7 8  |r|= 0.0276  e= [0.000494]  max|de|= -0.00133  lindep= 0.657
davidson 8 9  |r|= 0.0155  e= [0.000072]  max|de|= -0.000421  lindep= 0.747
root 0 converged  |r|= 0.00381  e= 2.6563483439172842e-05  max|de|= -4.58e-05
converged 9 10  |r|= 0.00381  e= [0.000027]  max|de|= -4.58e-05
RHF/RKS wavefunction is stable in the internal stability analysis
             #0      #1      #2      #3      #4      #5     
  0 N 1s      -0.693  -0.707  -0.216  -0.224                
  0 N 2s                      -0.465  -0.489                
  0 N 3s                      -0.292  -0.300                
  0 N 2px                                             -0.382
  0 N 2pz                                     -0.436        
  0 N 3px                                              0.282
  0 N 3pz                                      0.326        
  1 N 1s       0.707  -0.694  -0.216   0.224                
  1 N 2s                      -0.465   0.489                
  1 N 3s                      -0.292   0.300                
  1 N 2px                                             -0.243
  1 N 2py                                             -0.473
  1 N 2pz                                      0.436        
  1 N 3px                                              0.186
  1 N 3py                                              0.340
  1 N 3pz                                     -0.326        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                       0.216  -0.190
  0 N 2s                                       1.101  -1.030
  0 N 3s                                      -1.033   1.059
  0 N 2px      0.473  -0.238   0.101                        
  0 N 2py     -0.243  -0.214   0.556                        
  0 N 2pz                              0.495  -0.114  -0.331
  0 N 3px     -0.340   0.168                                
  0 N 3py      0.186   0.173  -0.431                        
  0 N 3pz                             -0.369          -0.304
  1 N 1s                                       0.216   0.190
  1 N 2s                                       1.101   1.030
  1 N 3s                                      -1.033  -1.059
  1 N 2px              0.556   0.214                        
  1 N 2py     -0.382  -0.101  -0.238                        
  1 N 2pz                              0.495   0.114  -0.331
  1 N 3px             -0.431  -0.173                        
  1 N 3py      0.282           0.168                        
  1 N 3pz                             -0.369          -0.304
[-14.550707 -14.550651  -0.76486   -0.730859  -0.318654  -0.298336  -0.298336  -0.203067  -0.203067  -0.175753   0.501643   0.597414]
scan 2.50, -108.710875
#INFO: **** input file is /share/home/srwang/pyAutoMR/examples/guess/N2-RKS.py ****
from pyscf import gto, dft
from automr import guess, dump_mat
import numpy as np
#mf=guess.from_fch_simp("v2.fchk", xc='pbe0')

#mf2.verbose=9
#mf2.stability()
for r in np.arange(1.5, 3.0, 0.1):
    mol = gto.Mole(atom='''N 0.0 0.0 0.0; N 0.0 0.0 %f'''%r, basis='def2-svp', verbose=5).build()
    mf = dft.RKS(mol)
    mf.xc = 'pbe0'
    mf.kernel()
    dump_mat.dump_mo(mol, mf.mo_coeff[:,:12])
    print(mf.mo_energy[:12])
    
    mf2 = guess.check_stab(mf, newton=True, res=True)
    dump_mat.dump_mo(mol, mf2.mo_coeff[:,:12])
    print(mf2.mo_energy[:12])
    print('scan %.2f, %.6f' % (r, mf2.e_tot))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='xc06n05', release='3.10.0-1127.el7.x86_64', version='#1 SMP Tue Feb 18 16:39:12 EST 2020', machine='x86_64', processor='x86_64')  Threads 48
Python 3.7.4 (default, Aug 13 2019, 20:35:49) 
[GCC 7.3.0]
numpy 1.17.2  scipy 1.4.1
Date: Thu Sep 16 17:41:40 2021
PySCF version 1.7.6a1
PySCF path  /share/home/srwang/pyscf/pyscf
GIT ORIG_HEAD 80f71dfe77ac5f9caae26788acf76446987635bd
GIT HEAD      ref: refs/heads/master
GIT master branch  80f71dfe77ac5f9caae26788acf76446987635bd

[ENV] PYSCF_EXT_PATH /share/home/srwang/pyscf_ext/fciqmc:
[CONFIG] conf_file /share/home/srwang/.pyscf_conf.py
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 2
[INPUT] num. electrons = 14
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 N      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 N      0.000000000000   0.000000000000   2.600000000000 AA    0.000000000000   0.000000000000   4.913287923869 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] N
[INPUT] 0    0    [5    /1   ]  1712.8415853      -0.0053934125305
                                257.64812677      -0.040221581118
                                58.458245853      -0.1793114499
                                16.198367905      -0.46376317823
                                5.0052600809      -0.44171422662
[INPUT] 0    0    [1    /1   ]  0.58731856571        1
[INPUT] 0    0    [1    /1   ]  0.18764592253        1
[INPUT] 1    0    [3    /1   ]  13.571470233      -0.040072398852
                                2.9257372874      -0.21807045028
                                0.79927750754     -0.51294466049
[INPUT] 1    0    [1    /1   ]  0.21954348034        1
[INPUT] 2    0    [1    /1   ]  1                    1

nuclear repulsion = 9.97295512887692
number of shells = 12
number of NR pGTOs = 48
number of NR cGTOs = 28
basis = def2-svp
ecp = {}
CPU time:       247.07


******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmp9zfzbyu8
max_memory 4000 MB (current use 261 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2aaf78ea5830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2aaf78ea5cb0>
Set gradient conv threshold to 3.16228e-05
atom N rad-grids = 75, ang-grids = [ 50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  86  86  86  86  86  86  86  86  86 266 266 266 266 266 266 266
 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266]
tot grids = 28092
Drop grids 3586
    CPU time for setting up grids      0.26 sec, wall time      0.01 sec
nelec by numeric integration = 13.992233722658211
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -168.24413951418097  Ecoul = 62.919239627121705  Exc = -13.12037101145448
init E= -108.472315769637
cond(S) = 14.97714256457236
    CPU time for initialize scf      1.79 sec, wall time      0.04 sec
  HOMO = -0.208429083202827  LUMO = -0.187872197651624
  mo_energy =
[-14.377838 -14.377754  -0.706117  -0.675562  -0.236146  -0.208429  -0.208429  -0.187872  -0.187872  -0.150764   0.531601   0.630134   0.713714   0.713714
   0.736217   0.804066   0.804066   1.010689   2.154207   2.154207   2.154584   2.154627   2.154741   2.154784   2.156358   2.157404   2.157404   2.209094]
nelec by numeric integration = 14.00002471842957
    CPU time for vxc      0.83 sec, wall time      0.02 sec
E1 = -166.1904382914151  Ecoul = 60.38947036585596  Exc = -12.83425633609491
cycle= 1 E= -108.662269132777  delta_E= -0.19  |g|= 0.252  |ddm|=  1.6
    CPU time for cycle= 1      1.09 sec, wall time      0.02 sec
  HOMO = -0.339332085890048  LUMO = -0.275487358246864
  mo_energy =
[-14.69492  -14.69487   -0.818089  -0.791524  -0.364285  -0.339332  -0.339332  -0.275487  -0.275487  -0.241578   0.457654   0.556988   0.623562   0.623562
   0.64329    0.716413   0.716413   0.928775   2.043224   2.043267   2.04439    2.044433   2.044637   2.044637   2.047327   2.049599   2.049599   2.102873]
nelec by numeric integration = 14.000028328890917
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -167.63972194360704  Ecoul = 62.0683171717486  Exc = -13.075060989011115
cycle= 2 E= -108.673510631993  delta_E= -0.0112  |g|= 0.152  |ddm|= 0.457
    CPU time for cycle= 2      1.00 sec, wall time      0.02 sec
  HOMO = -0.293591732416471  LUMO = -0.227868376809758
  mo_energy =
[-14.565458 -14.565405  -0.771394  -0.743337  -0.319601  -0.293592  -0.293592  -0.227868  -0.227868  -0.191824   0.487748   0.58782    0.660672   0.660672
   0.681874   0.752823   0.752823   0.963306   2.089644   2.089687   2.090786   2.090786   2.090815   2.090858   2.093385   2.095751   2.095751   2.148784]
nelec by numeric integration = 14.000026982673088
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -167.09960044784825  Ecoul = 61.42957985935808  Exc = -12.983161957016247
cycle= 3 E= -108.680227416629  delta_E= -0.00672  |g|= 0.000974  |ddm|= 0.171
    CPU time for cycle= 3      1.00 sec, wall time      0.02 sec
  HOMO = -0.293405748698454  LUMO = -0.22762127930947
  mo_energy =
[-14.565101 -14.565048  -0.771204  -0.743145  -0.319409  -0.293406  -0.293406  -0.227621  -0.227621  -0.191431   0.488007   0.587998   0.660987   0.660987
   0.682151   0.7531     0.7531     0.963642   2.089952   2.089995   2.091091   2.091091   2.091125   2.091168   2.093693   2.096071   2.096071   2.149122]
nelec by numeric integration = 14.000026977482179
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -167.0978165717982  Ecoul = 61.42760387431326  Exc = -12.982970413213401
cycle= 4 E= -108.680227981821  delta_E= -5.65e-07  |g|= 0.000387  |ddm|= 0.00185
    CPU time for cycle= 4      1.00 sec, wall time      0.02 sec
  HOMO = -0.293410357028049  LUMO = -0.227621626401016
  mo_energy =
[-14.565075 -14.565023  -0.771216  -0.743138  -0.319412  -0.29341   -0.29341   -0.227622  -0.227622  -0.191425   0.48797    0.588039   0.66098    0.66098
   0.682167   0.7531     0.7531     0.963604   2.08995    2.089993   2.091089   2.091089   2.091123   2.091166   2.093691   2.09607    2.09607    2.149121]
nelec by numeric integration = 14.00002697919431
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -167.0977578275775  Ecoul = 61.42751713594502  Exc = -12.982942449195244
cycle= 5 E= -108.680228011951  delta_E= -3.01e-08  |g|= 7.35e-06  |ddm|= 0.000235
    CPU time for cycle= 5      1.00 sec, wall time      0.02 sec
  HOMO = -0.293407386197131  LUMO = -0.227620476740925
  mo_energy =
[-14.565066 -14.565013  -0.771213  -0.743135  -0.319409  -0.293407  -0.293407  -0.22762   -0.22762   -0.191423   0.48797    0.588036   0.660977   0.660977
   0.682166   0.753098   0.753098   0.963604   2.08995    2.089993   2.091088   2.091088   2.091122   2.091165   2.093691   2.096069   2.096069   2.14912 ]
nelec by numeric integration = 14.000026979142394
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -167.0977426991936  Ecoul = 61.427499301612244  Exc = -12.98293974326041
cycle= 6 E= -108.680228011965  delta_E= -1.4e-11  |g|= 2.23e-06  |ddm|= 9.73e-06
    CPU time for cycle= 6      1.00 sec, wall time      0.02 sec
  HOMO = -0.29340761116648  LUMO = -0.227620655023283
  mo_energy =
[-14.565066 -14.565013  -0.771214  -0.743135  -0.319409  -0.293408  -0.293408  -0.227621  -0.227621  -0.191423   0.48797    0.588036   0.660977   0.660977
   0.682166   0.753098   0.753098   0.963604   2.089949   2.089993   2.091088   2.091088   2.091122   2.091165   2.093691   2.096069   2.096069   2.14912 ]
nelec by numeric integration = 14.00002697914826
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -167.09774459449358  Ecoul = 61.42750149698575  Exc = -12.982940042579251
Extra cycle  E= -108.68022801121  delta_E= 7.55e-10  |g|= 6.54e-05  |ddm|= 2.53e-05
    CPU time for scf_cycle      8.86 sec, wall time      0.18 sec
    CPU time for SCF      8.88 sec, wall time      0.19 sec
converged SCF energy = -108.68022801121
             #0      #1      #2      #3      #4      #5     
  0 N 1s       0.714   0.686   0.218  -0.224                
  0 N 2s                       0.470  -0.491                
  0 N 3s                       0.291  -0.295                
  0 N 2px                                              0.442
  0 N 2py                                              0.108
  0 N 2pz                                      0.440        
  0 N 3px                                             -0.334
  0 N 3pz                                     -0.327        
  1 N 1s      -0.686   0.714   0.218   0.224                
  1 N 2s                       0.470   0.491                
  1 N 3s                       0.291   0.295                
  1 N 2px                                              0.442
  1 N 2py                                              0.108
  1 N 2pz                                     -0.440        
  1 N 3px                                             -0.334
  1 N 3pz                                      0.327        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                       0.212   0.192
  0 N 2s                                       1.084   1.038
  0 N 3s                                      -1.025  -1.065
  0 N 2px     -0.108  -0.465                                
  0 N 2py      0.442          -0.465                        
  0 N 2pz                              0.493  -0.150   0.318
  0 N 3px              0.337                                
  0 N 3py     -0.334           0.337                        
  0 N 3pz                             -0.360           0.295
  1 N 1s                                       0.212  -0.192
  1 N 2s                                       1.084  -1.038
  1 N 3s                                      -1.025   1.065
  1 N 2px     -0.108   0.465                                
  1 N 2py      0.442           0.465                        
  1 N 2pz                              0.493   0.150   0.318
  1 N 3px             -0.337                                
  1 N 3py     -0.334          -0.337                        
  1 N 3pz                             -0.360           0.295
[-14.565066 -14.565013  -0.771214  -0.743135  -0.319409  -0.293408  -0.293408  -0.227621  -0.227621  -0.191423   0.48797    0.588036]
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 14.000026979148256
    CPU time for vxc      0.80 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 3.23  e= [1.119007]  max|de|= 1.12  lindep= 0.993
davidson 1 2  |r|= 1.24  e= [0.238039]  max|de|= -0.881  lindep= 0.68
davidson 2 3  |r|= 0.28  e= [-0.07916]  max|de|= -0.317  lindep= 0.826
davidson 3 4  |r|= 0.116  e= [-0.100258]  max|de|= -0.0211  lindep= 0.652
davidson 4 5  |r|= 0.0555  e= [-0.105107]  max|de|= -0.00485  lindep= 0.77
davidson 5 6  |r|= 0.0141  e= [-0.105832]  max|de|= -0.000725  lindep= 0.671
root 0 converged  |r|= 0.00613  e= -0.1058987131803186  max|de|= -6.67e-05
converged 6 7  |r|= 0.00613  e= [-0.105899]  max|de|= -6.67e-05
RHF/RKS wavefunction has an internal instability




******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmp9zfzbyu8
max_memory 4000 MB (current use 261 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2aaf78ea5830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2aaf78ea5cb0>
******** <class 'pyscf.dft.rks.RKS'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmp9zfzbyu8
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 261 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.288682535500362  LUMO = -0.194332641433961
Initial guess E= -108.696234460723  |g|= 0.0430384
macro= 0  E= -108.697260628752  delta_E= -0.00102617  |g|= 0.0430384  2 KF 6 JK
macro= 1  E= -108.697423899442  delta_E= -0.000163271  |g|= 0.00309574  3 KF 9 JK
macro= 2  E= -108.697424527717  delta_E= -6.28276e-07  |g|= 1.69786e-05  3 KF 12 JK
macro= 3  E= -108.697424527718  delta_E= -9.9476e-14  |g|= 3.27088e-06  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 4  E=-108.697424527718  |g|= 3.27088e-06  total 10 KF 34 JK
converged SCF energy = -108.697424527718
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 14.00002738190802
    CPU time for vxc      0.82 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 1.58  e= [0.519646]  max|de|= 0.52  lindep= 0.975
davidson 1 2  |r|= 1.54  e= [0.449761]  max|de|= -0.0699  lindep=    1
davidson 2 3  |r|= 0.225  e= [0.171565]  max|de|= -0.278  lindep= 0.928
davidson 3 4  |r|= 0.356  e= [0.136254]  max|de|= -0.0353  lindep= 0.64
davidson 4 5  |r|= 0.183  e= [0.089429]  max|de|= -0.0468  lindep= 0.827
davidson 5 6  |r|= 0.22  e= [0.068929]  max|de|= -0.0205  lindep= 0.525
davidson 6 7  |r|= 0.133  e= [0.036224]  max|de|= -0.0327  lindep= 0.798
davidson 7 8  |r|= 0.0316  e= [0.033248]  max|de|= -0.00298  lindep= 0.662
davidson 8 9  |r|= 0.0216  e= [0.032793]  max|de|= -0.000455  lindep= 0.704
davidson 9 10  |r|= 0.00839  e= [0.03268]  max|de|= -0.000113  lindep= 0.661
root 0 converged  |r|= 0.00789  e= 0.03264771329705501  max|de|= -3.23e-05
converged 10 11  |r|= 0.00789  e= [0.032648]  max|de|= -3.23e-05
RHF/RKS wavefunction is stable in the internal stability analysis
             #0      #1      #2      #3      #4      #5     
  0 N 1s      -0.701   0.699  -0.217  -0.224                
  0 N 2s                      -0.466  -0.487                
  0 N 3s                      -0.295  -0.300                
  0 N 2px                                             -0.120
  0 N 2pz                                     -0.436        
  0 N 3pz                                      0.331        
  1 N 1s       0.699   0.702  -0.217   0.224                
  1 N 2s                      -0.466   0.487                
  1 N 3s                      -0.295   0.300                
  1 N 2px                                             -0.448
  1 N 2py                                             -0.465
  1 N 2pz                                      0.436        
  1 N 3px                                              0.326
  1 N 3py                                              0.335
  1 N 3pz                                     -0.331        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                      -0.212  -0.192
  0 N 2s                                      -1.084  -1.040
  0 N 3s                                       1.023   1.065
  0 N 2px      0.465  -0.136  -0.420                        
  0 N 2py     -0.448          -0.467                        
  0 N 2pz                              0.491   0.154  -0.318
  0 N 3px     -0.335           0.331                        
  0 N 3py      0.326           0.366                        
  0 N 3pz                             -0.364          -0.293
  1 N 1s                                      -0.212   0.192
  1 N 2s                                      -1.084   1.040
  1 N 3s                                       1.023  -1.065
  1 N 2px              0.467                                
  1 N 2py     -0.120  -0.420   0.136                        
  1 N 2pz                              0.491  -0.154  -0.318
  1 N 3px             -0.366                                
  1 N 3py              0.331                                
  1 N 3pz                             -0.364          -0.293
[-14.546976 -14.546909  -0.759369  -0.732067  -0.311619  -0.296593  -0.296593  -0.201232  -0.201232  -0.182838   0.49434    0.595335]
scan 2.60, -108.697425
#INFO: **** input file is /share/home/srwang/pyAutoMR/examples/guess/N2-RKS.py ****
from pyscf import gto, dft
from automr import guess, dump_mat
import numpy as np
#mf=guess.from_fch_simp("v2.fchk", xc='pbe0')

#mf2.verbose=9
#mf2.stability()
for r in np.arange(1.5, 3.0, 0.1):
    mol = gto.Mole(atom='''N 0.0 0.0 0.0; N 0.0 0.0 %f'''%r, basis='def2-svp', verbose=5).build()
    mf = dft.RKS(mol)
    mf.xc = 'pbe0'
    mf.kernel()
    dump_mat.dump_mo(mol, mf.mo_coeff[:,:12])
    print(mf.mo_energy[:12])
    
    mf2 = guess.check_stab(mf, newton=True, res=True)
    dump_mat.dump_mo(mol, mf2.mo_coeff[:,:12])
    print(mf2.mo_energy[:12])
    print('scan %.2f, %.6f' % (r, mf2.e_tot))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='xc06n05', release='3.10.0-1127.el7.x86_64', version='#1 SMP Tue Feb 18 16:39:12 EST 2020', machine='x86_64', processor='x86_64')  Threads 48
Python 3.7.4 (default, Aug 13 2019, 20:35:49) 
[GCC 7.3.0]
numpy 1.17.2  scipy 1.4.1
Date: Thu Sep 16 17:41:41 2021
PySCF version 1.7.6a1
PySCF path  /share/home/srwang/pyscf/pyscf
GIT ORIG_HEAD 80f71dfe77ac5f9caae26788acf76446987635bd
GIT HEAD      ref: refs/heads/master
GIT master branch  80f71dfe77ac5f9caae26788acf76446987635bd

[ENV] PYSCF_EXT_PATH /share/home/srwang/pyscf_ext/fciqmc:
[CONFIG] conf_file /share/home/srwang/.pyscf_conf.py
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 2
[INPUT] num. electrons = 14
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 N      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 N      0.000000000000   0.000000000000   2.700000000000 AA    0.000000000000   0.000000000000   5.102260536326 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] N
[INPUT] 0    0    [5    /1   ]  1712.8415853      -0.0053934125305
                                257.64812677      -0.040221581118
                                58.458245853      -0.1793114499
                                16.198367905      -0.46376317823
                                5.0052600809      -0.44171422662
[INPUT] 0    0    [1    /1   ]  0.58731856571        1
[INPUT] 0    0    [1    /1   ]  0.18764592253        1
[INPUT] 1    0    [3    /1   ]  13.571470233      -0.040072398852
                                2.9257372874      -0.21807045028
                                0.79927750754     -0.51294466049
[INPUT] 1    0    [1    /1   ]  0.21954348034        1
[INPUT] 2    0    [1    /1   ]  1                    1

nuclear repulsion = 9.6035864204
number of shells = 12
number of NR pGTOs = 48
number of NR cGTOs = 28
basis = def2-svp
ecp = {}
CPU time:       284.51


******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmp6cw13d9n
max_memory 4000 MB (current use 261 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2aaf78ea5830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2aaf78ea5cb0>
Set gradient conv threshold to 3.16228e-05
atom N rad-grids = 75, ang-grids = [ 50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  86  86  86  86  86  86  86  86  86 266 266 266 266 266 266 266
 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266]
tot grids = 28092
Drop grids 3568
    CPU time for setting up grids      0.25 sec, wall time      0.01 sec
nelec by numeric integration = 13.992218985638157
    CPU time for vxc      0.80 sec, wall time      0.02 sec
E1 = -167.50505460145234  Ecoul = 62.55030799246187  Exc = -13.1186258977463
init E= -108.469786086337
cond(S) = 13.906279409660375
    CPU time for initialize scf      1.80 sec, wall time      0.04 sec
  HOMO = -0.206543341663311  LUMO = -0.18967171398837
  mo_energy =
[-14.377878 -14.377789  -0.702774  -0.678292  -0.231671  -0.206543  -0.206543  -0.189672  -0.189672  -0.15795    0.524527   0.627161   0.717212   0.717212
   0.723389   0.798832   0.798832   1.00195    2.154622   2.154622   2.154651   2.154683   2.154725   2.154757   2.156164   2.156164   2.158073   2.188894]
nelec by numeric integration = 14.0000330574713
    CPU time for vxc      5.15 sec, wall time      0.11 sec
E1 = -165.4625258995818  Ecoul = 60.045187624071445  Exc = -12.83197548344248
cycle= 1 E= -108.645727338553  delta_E= -0.176  |g|= 0.249  |ddm|=  1.6
    CPU time for cycle= 1      5.45 sec, wall time      0.12 sec
  HOMO = -0.335972311768373  LUMO = -0.27662853468957
  mo_energy =
[-14.69149  -14.691434  -0.814223  -0.792675  -0.357978  -0.335972  -0.335972  -0.276629  -0.276629  -0.247315   0.451397   0.55487    0.628298   0.628298
   0.632777   0.711892   0.711892   0.9202     2.044369   2.044402   2.045353   2.045386   2.045915   2.045915   2.049023   2.049023   2.049879   2.083203]
nelec by numeric integration = 14.000034218899472
    CPU time for vxc      0.83 sec, wall time      0.02 sec
E1 = -166.9037554282775  Ecoul = 61.715957356546355  Exc = -13.07244932178954
cycle= 2 E= -108.656660973121  delta_E= -0.0109  |g|= 0.152  |ddm|= 0.455
    CPU time for cycle= 2      1.02 sec, wall time      0.02 sec
  HOMO = -0.290530497200055  LUMO = -0.229561392487054
  mo_energy =
[-14.563071 -14.563012  -0.767864  -0.745005  -0.313839  -0.29053   -0.29053   -0.229561  -0.229561  -0.198401   0.481122   0.585323   0.66496    0.66496
   0.670413   0.748034   0.748034   0.954669   2.090387   2.09042    2.091376   2.091408   2.091671   2.091671   2.09478    2.09478    2.095534   2.128725]
nelec by numeric integration = 14.000033853171615
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -166.36343273585834  Ecoul = 61.07665419530633  Exc = -12.980191358249982
cycle= 3 E= -108.663383478402  delta_E= -0.00672  |g|= 0.000934  |ddm|= 0.171
    CPU time for cycle= 3      1.00 sec, wall time      0.02 sec
  HOMO = -0.290357017588765  LUMO = -0.229329301072602
  mo_energy =
[-14.562717 -14.562658  -0.767697  -0.744826  -0.313658  -0.290357  -0.290357  -0.229329  -0.229329  -0.198031   0.481364   0.585507   0.665261   0.665261
   0.670676   0.748302   0.748302   0.954987   2.090681   2.090713   2.09167    2.091703   2.091959   2.091959   2.09508    2.09508    2.095824   2.12904 ]
nelec by numeric integration = 14.000033851112374
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -166.36170584928402  Ecoul = 61.07473156788348  Exc = -12.979996139873998
cycle= 4 E= -108.663384000875  delta_E= -5.22e-07  |g|= 0.000335  |ddm|= 0.00179
    CPU time for cycle= 4      0.99 sec, wall time      0.02 sec
  HOMO = -0.290361509398449  LUMO = -0.22933132295367
  mo_energy =
[-14.562696 -14.562638  -0.767708  -0.744823  -0.313662  -0.290362  -0.290362  -0.229331  -0.229331  -0.198027   0.481326   0.585539   0.665253   0.665253
   0.670693   0.748299   0.748299   0.954952   2.090677   2.09071    2.091667   2.091699   2.091955   2.091955   2.095077   2.095077   2.09582    2.129037]
nelec by numeric integration = 14.000033852087572
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -166.3616728260429  Ecoul = 61.07467795370611  Exc = -12.979975571770359
cycle= 5 E= -108.663384023707  delta_E= -2.28e-08  |g|= 7.69e-06  |ddm|= 0.000207
    CPU time for cycle= 5      1.00 sec, wall time      0.02 sec
  HOMO = -0.290358552042762  LUMO = -0.229330060768103
  mo_energy =
[-14.562686 -14.562628  -0.767705  -0.74482   -0.313658  -0.290359  -0.290359  -0.22933   -0.22933   -0.198025   0.481326   0.585536   0.665251   0.665251
   0.670692   0.748297   0.748297   0.954952   2.090677   2.090709   2.091666   2.091699   2.091955   2.091955   2.095076   2.095076   2.09582    2.129037]
nelec by numeric integration = 14.00003385206549
    CPU time for vxc      0.83 sec, wall time      0.02 sec
E1 = -166.3616565324339  Ecoul = 61.07465878859786  Exc = -12.979972700284277
cycle= 6 E= -108.66338402372  delta_E= -1.32e-11  |g|= 4.4e-06  |ddm|= 9.92e-06
    CPU time for cycle= 6      1.01 sec, wall time      0.02 sec
  HOMO = -0.290358779475093  LUMO = -0.229330243961791
  mo_energy =
[-14.562687 -14.562629  -0.767705  -0.74482   -0.313658  -0.290359  -0.290359  -0.22933   -0.22933   -0.198025   0.481326   0.585536   0.665251   0.665251
   0.670692   0.748297   0.748297   0.954952   2.090677   2.090709   2.091666   2.091699   2.091955   2.091955   2.095076   2.095076   2.09582    2.129037]
nelec by numeric integration = 14.000033852067789
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -166.3616584981506  Ecoul = 61.074661071842016  Exc = -12.97997301418885
Extra cycle  E= -108.663384020097  delta_E= 3.62e-09  |g|= 0.000144  |ddm|= 5.46e-05
    CPU time for scf_cycle     13.27 sec, wall time      0.28 sec
    CPU time for SCF     13.29 sec, wall time      0.28 sec
converged SCF energy = -108.663384020097
             #0      #1      #2      #3      #4      #5     
  0 N 1s      -0.675   0.725   0.218   0.224                
  0 N 2s                       0.471   0.489                
  0 N 3s                       0.293   0.295                
  0 N 2px                                              0.456
  0 N 2pz                                     -0.440        
  0 N 3px                                             -0.345
  0 N 3pz                                      0.332        
  1 N 1s       0.725   0.675   0.218  -0.224                
  1 N 2s                       0.472  -0.489                
  1 N 3s                       0.293  -0.295                
  1 N 2px                                              0.456
  1 N 2pz                                      0.440        
  1 N 3px                                             -0.345
  1 N 3pz                                     -0.332        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                       0.208  -0.194
  0 N 2s                                       1.068  -1.047
  0 N 3s                                      -1.015   1.072
  0 N 2px                      0.470                        
  0 N 2py      0.456   0.470                                
  0 N 2pz                              0.490  -0.183  -0.304
  0 N 3px                     -0.342                        
  0 N 3py     -0.345  -0.342                                
  0 N 3pz                             -0.355          -0.284
  1 N 1s                                       0.208   0.194
  1 N 2s                                       1.068   1.047
  1 N 3s                                      -1.015  -1.072
  1 N 2px                     -0.470                        
  1 N 2py      0.456  -0.470                                
  1 N 2pz                              0.490   0.183  -0.304
  1 N 3px                      0.342                        
  1 N 3py     -0.345   0.342                                
  1 N 3pz                             -0.355          -0.284
[-14.562687 -14.562629  -0.767705  -0.74482   -0.313658  -0.290359  -0.290359  -0.22933   -0.22933   -0.198025   0.481326   0.585536]
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 14.000033852067789
    CPU time for vxc      0.80 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 3.57  e= [1.313827]  max|de|= 1.31  lindep= 0.996
davidson 1 2  |r|= 1.18  e= [0.190595]  max|de|= -1.12  lindep= 0.709
davidson 2 3  |r|= 0.272  e= [-0.101662]  max|de|= -0.292  lindep= 0.655
davidson 3 4  |r|= 0.116  e= [-0.119085]  max|de|= -0.0174  lindep= 0.82
davidson 4 5  |r|= 0.0513  e= [-0.122679]  max|de|= -0.00359  lindep= 0.715
davidson 5 6  |r|= 0.0279  e= [-0.12386]  max|de|= -0.00118  lindep= 0.585
davidson 6 7  |r|= 0.00807  e= [-0.124004]  max|de|= -0.000144  lindep= 0.778
root 0 converged  |r|= 0.0012  e= -0.12401506283290856  max|de|= -1.1e-05
converged 7 8  |r|= 0.0012  e= [-0.124015]  max|de|= -1.1e-05
RHF/RKS wavefunction has an internal instability




******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmp6cw13d9n
max_memory 4000 MB (current use 262 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2aaf78ea5830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2aaf78ea5cb0>
******** <class 'pyscf.dft.rks.RKS'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmp6cw13d9n
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 262 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.289789828052221  LUMO = -0.193079690601464
Initial guess E= -108.685713573146  |g|= 0.0205433
macro= 0  E= -108.686061561942  delta_E= -0.000347989  |g|= 0.00113729  3 KF 10 JK
macro= 1  E= -108.686061738957  delta_E= -1.77014e-07  |g|= 9.46373e-05  2 KF 11 JK
macro= 2  E= -108.686061738957  delta_E= 2.84217e-14  |g|= 6.72777e-06  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 3  E=-108.686061738957  |g|= 6.72777e-06  total 7 KF 27 JK
converged SCF energy = -108.686061738957
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 14.000034156178213
    CPU time for vxc      0.82 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|=  1.6  e= [0.501944]  max|de|= 0.502  lindep= 0.991
davidson 1 2  |r|= 1.47  e= [0.440647]  max|de|= -0.0613  lindep= 0.509
davidson 2 3  |r|= 0.214  e= [0.161735]  max|de|= -0.279  lindep= 0.991
davidson 3 4  |r|= 0.28  e= [0.138904]  max|de|= -0.0228  lindep= 0.53
davidson 4 5  |r|= 0.257  e= [0.059203]  max|de|= -0.0797  lindep= 0.937
davidson 5 6  |r|= 0.118  e= [0.041689]  max|de|= -0.0175  lindep= 0.576
davidson 6 7  |r|= 0.14  e= [0.026045]  max|de|= -0.0156  lindep= 0.82
davidson 7 8  |r|= 0.0288  e= [0.022806]  max|de|= -0.00324  lindep= 0.974
davidson 8 9  |r|= 0.00628  e= [0.022681]  max|de|= -0.000125  lindep= 0.758
davidson 9 10  |r|= 0.0121  e= [0.022644]  max|de|= -3.71e-05  lindep= 0.657
davidson 10 11  |r|= 0.185  e= [0.019388]  max|de|= -0.00326  lindep= 0.822
davidson 11 12  |r|= 0.12  e= [0.004756]  max|de|= -0.0146  lindep= 0.504
davidson 12 1  |r|= 0.12  e= [0.004756]  max|de|= -9.87e-16  lindep= 0.998
davidson 13 2  |r|= 0.056  e= [0.001691]  max|de|= -0.00307  lindep= 0.989
davidson 14 3  |r|= 0.0508  e= [0.001128]  max|de|= -0.000563  lindep= 0.574
davidson 15 4  |r|= 0.0258  e= [0.000204]  max|de|= -0.000924  lindep= 0.905
davidson 16 5  |r|= 0.00709  e= [0.000078]  max|de|= -0.000126  lindep= 0.721
root 0 converged  |r|= 0.0061  e= 5.2475300467877875e-05  max|de|= -2.54e-05
converged 17 6  |r|= 0.0061  e= [0.000052]  max|de|= -2.54e-05
RHF/RKS wavefunction is stable in the internal stability analysis
             #0      #1      #2      #3      #4      #5     
  0 N 1s      -0.704  -0.696  -0.217  -0.223                
  0 N 2s                      -0.467  -0.485                
  0 N 3s                      -0.296  -0.299                
  0 N 2px                                              0.373
  0 N 2py                                              0.455
  0 N 2pz                                     -0.436        
  0 N 3px                                             -0.265
  0 N 3py                                             -0.334
  0 N 3pz                                      0.335        
  1 N 1s       0.696  -0.704  -0.217   0.223                
  1 N 2s                      -0.467   0.485                
  1 N 3s                      -0.296   0.299                
  1 N 2px                                             -0.159
  1 N 2py                                              0.252
  1 N 2pz                                      0.436        
  1 N 3px                                              0.105
  1 N 3py                                             -0.193
  1 N 3pz                                     -0.335        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                       0.209   0.195
  0 N 2s                                       1.068   1.050
  0 N 3s                                      -1.013  -1.072
  0 N 2px     -0.252  -0.391  -0.258                        
  0 N 2py     -0.159   0.427   0.103                        
  0 N 2pz                              0.487  -0.186   0.305
  0 N 3px      0.193   0.314   0.192                        
  0 N 3py      0.105  -0.332                                
  0 N 3pz                             -0.359           0.282
  1 N 1s                                       0.209  -0.195
  1 N 2s                                       1.068  -1.050
  1 N 3s                                      -1.013   1.072
  1 N 2px     -0.455  -0.103   0.427                        
  1 N 2py      0.373  -0.258   0.391                        
  1 N 2pz                              0.487   0.186   0.305
  1 N 3px      0.334          -0.332                        
  1 N 3py     -0.265   0.192  -0.314                        
  1 N 3pz                             -0.359           0.282
[-14.544225 -14.544154  -0.755259  -0.733303  -0.305569  -0.295398  -0.295398  -0.200037  -0.200036  -0.189143   0.487926   0.59301 ]
scan 2.70, -108.686062
#INFO: **** input file is /share/home/srwang/pyAutoMR/examples/guess/N2-RKS.py ****
from pyscf import gto, dft
from automr import guess, dump_mat
import numpy as np
#mf=guess.from_fch_simp("v2.fchk", xc='pbe0')

#mf2.verbose=9
#mf2.stability()
for r in np.arange(1.5, 3.0, 0.1):
    mol = gto.Mole(atom='''N 0.0 0.0 0.0; N 0.0 0.0 %f'''%r, basis='def2-svp', verbose=5).build()
    mf = dft.RKS(mol)
    mf.xc = 'pbe0'
    mf.kernel()
    dump_mat.dump_mo(mol, mf.mo_coeff[:,:12])
    print(mf.mo_energy[:12])
    
    mf2 = guess.check_stab(mf, newton=True, res=True)
    dump_mat.dump_mo(mol, mf2.mo_coeff[:,:12])
    print(mf2.mo_energy[:12])
    print('scan %.2f, %.6f' % (r, mf2.e_tot))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='xc06n05', release='3.10.0-1127.el7.x86_64', version='#1 SMP Tue Feb 18 16:39:12 EST 2020', machine='x86_64', processor='x86_64')  Threads 48
Python 3.7.4 (default, Aug 13 2019, 20:35:49) 
[GCC 7.3.0]
numpy 1.17.2  scipy 1.4.1
Date: Thu Sep 16 17:41:42 2021
PySCF version 1.7.6a1
PySCF path  /share/home/srwang/pyscf/pyscf
GIT ORIG_HEAD 80f71dfe77ac5f9caae26788acf76446987635bd
GIT HEAD      ref: refs/heads/master
GIT master branch  80f71dfe77ac5f9caae26788acf76446987635bd

[ENV] PYSCF_EXT_PATH /share/home/srwang/pyscf_ext/fciqmc:
[CONFIG] conf_file /share/home/srwang/.pyscf_conf.py
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 2
[INPUT] num. electrons = 14
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 N      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 N      0.000000000000   0.000000000000   2.800000000000 AA    0.000000000000   0.000000000000   5.291233148782 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] N
[INPUT] 0    0    [5    /1   ]  1712.8415853      -0.0053934125305
                                257.64812677      -0.040221581118
                                58.458245853      -0.1793114499
                                16.198367905      -0.46376317823
                                5.0052600809      -0.44171422662
[INPUT] 0    0    [1    /1   ]  0.58731856571        1
[INPUT] 0    0    [1    /1   ]  0.18764592253        1
[INPUT] 1    0    [3    /1   ]  13.571470233      -0.040072398852
                                2.9257372874      -0.21807045028
                                0.79927750754     -0.51294466049
[INPUT] 1    0    [1    /1   ]  0.21954348034        1
[INPUT] 2    0    [1    /1   ]  1                    1

nuclear repulsion = 9.2606011911
number of shells = 12
number of NR pGTOs = 48
number of NR cGTOs = 28
basis = def2-svp
ecp = {}
CPU time:       323.46


******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpxix2qbe6
max_memory 4000 MB (current use 262 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2aaf78ea5830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2aaf78ea5cb0>
Set gradient conv threshold to 3.16228e-05
atom N rad-grids = 75, ang-grids = [ 50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  86  86  86  86  86  86  86  86  86 266 266 266 266 266 266 266
 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266]
tot grids = 28092
Drop grids 3550
    CPU time for setting up grids      0.25 sec, wall time      0.01 sec
nelec by numeric integration = 13.992192311863494
    CPU time for vxc      0.80 sec, wall time      0.02 sec
E1 = -166.8185059144734  Ecoul = 62.207270193397285  Exc = -13.11731981488602
init E= -108.467954344862
cond(S) = 13.094349132363424
    CPU time for initialize scf      1.79 sec, wall time      0.04 sec
  HOMO = -0.204999511230215  LUMO = -0.191174575560301
  mo_energy =
[-14.377943 -14.377855  -0.700134  -0.680533  -0.227647  -0.205     -0.205     -0.191175  -0.191175  -0.164015   0.519188   0.624216   0.713975   0.721029
   0.721029   0.79361    0.79361    0.988084   2.154685   2.154694   2.154722   2.154731   2.154758   2.154758   2.15549    2.15549    2.158152   2.175537]
nelec by numeric integration = 14.00002864693479
    CPU time for vxc      0.84 sec, wall time      0.02 sec
E1 = -164.78885584944345  Ecoul = 59.727914994333  Exc = -12.830913573551546
cycle= 1 E= -108.631253237562  delta_E= -0.163  |g|= 0.246  |ddm|= 1.61
    CPU time for cycle= 1      1.10 sec, wall time      0.02 sec
  HOMO = -0.332901811596504  LUMO = -0.27741959771305
  mo_energy =
[-14.687942 -14.687884  -0.810923  -0.793361  -0.352246  -0.332902  -0.332902  -0.27742   -0.27742   -0.252057   0.44699    0.552912   0.625371   0.633282
   0.633282   0.707442   0.707442   0.906657   2.045556   2.045567   2.046415   2.046426   2.046965   2.046965   2.049086   2.049086   2.050831   2.07039 ]
nelec by numeric integration = 14.00002610263125
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -166.21975428509907  Ecoul = 61.38768851124736  Exc = -13.070403893487386
cycle= 2 E= -108.641868476239  delta_E= -0.0106  |g|= 0.151  |ddm|= 0.451
    CPU time for cycle= 2      1.00 sec, wall time      0.02 sec
  HOMO = -0.287803826839019  LUMO = -0.230927568090386
  mo_energy =
[-14.560719 -14.560659  -0.764927  -0.746239  -0.308606  -0.287804  -0.287804  -0.230928  -0.230928  -0.203961   0.476317   0.582921   0.662172   0.669514
   0.669514   0.743281   0.743281   0.941001   2.091137   2.091147   2.091999   2.092009   2.092302   2.092302   2.094425   2.094425   2.096063   2.115518]
nelec by numeric integration = 14.000027196482241
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -165.680548026021  Ecoul = 60.74950972294757  Exc = -12.978113850648576
cycle= 3 E= -108.648550962622  delta_E= -0.00668  |g|= 0.00088  |ddm|= 0.171
    CPU time for cycle= 3      1.01 sec, wall time      0.02 sec
  HOMO = -0.287651686932929  LUMO = -0.230720057799022
  mo_energy =
[-14.560398 -14.560338  -0.76479   -0.746085  -0.308446  -0.287652  -0.287652  -0.23072   -0.23072   -0.203625   0.476533   0.583102   0.662418   0.669794
   0.669794   0.74353    0.74353    0.94129    2.091405   2.091416   2.092269   2.092279   2.092563   2.092563   2.094696   2.094696   2.096326   2.1158  ]
nelec by numeric integration = 14.000027200678838
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -165.67900246060748  Ecoul = 60.7477868931095  Exc = -12.977937051518719
cycle= 4 E= -108.648551427917  delta_E= -4.65e-07  |g|= 0.00028  |ddm|= 0.00172
    CPU time for cycle= 4      1.00 sec, wall time      0.02 sec
  HOMO = -0.287655355835369  LUMO = -0.23072266596278
  mo_energy =
[-14.560381 -14.56032   -0.764799  -0.746083  -0.308449  -0.287655  -0.287655  -0.230723  -0.230723  -0.203623   0.476498   0.583127   0.662434   0.669786
   0.669786   0.743527   0.743527   0.94126    2.091401   2.091411   2.092265   2.092275   2.092559   2.092559   2.094692   2.094692   2.096321   2.115796]
nelec by numeric integration = 14.000027200098698
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -165.67898407292444  Ecoul = 60.7477533630152  Exc = -12.977921925278688
cycle= 5 E= -108.648551444088  delta_E= -1.62e-08  |g|= 7.77e-06  |ddm|= 0.000176
    CPU time for cycle= 5      1.00 sec, wall time      0.02 sec
  HOMO = -0.287652543357794  LUMO = -0.230721412843401
  mo_energy =
[-14.560371 -14.560311  -0.764796  -0.74608   -0.308445  -0.287653  -0.287653  -0.230721  -0.230721  -0.20362    0.476498   0.583124   0.662433   0.669784
   0.669784   0.743525   0.743525   0.94126    2.091401   2.091411   2.092264   2.092274   2.092558   2.092558   2.094692   2.094692   2.096321   2.115796]
nelec by numeric integration = 14.000027200139847
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -165.67896736663988  Ecoul = 60.747733736111755  Exc = -12.977919004676195
cycle= 6 E= -108.648551444104  delta_E= -1.64e-11  |g|= 1.57e-06  |ddm|= 9.65e-06
    CPU time for cycle= 6      1.00 sec, wall time      0.02 sec
  HOMO = -0.287652768031904  LUMO = -0.230721595600831
  mo_energy =
[-14.560372 -14.560311  -0.764796  -0.746081  -0.308445  -0.287653  -0.287653  -0.230722  -0.230722  -0.203621   0.476498   0.583124   0.662433   0.669784
   0.669784   0.743525   0.743525   0.94126    2.091401   2.091411   2.092264   2.092274   2.092558   2.092558   2.094692   2.094692   2.096321   2.115796]
nelec by numeric integration = 14.000027200136302
    CPU time for vxc      0.83 sec, wall time      0.02 sec
E1 = -165.6789693709668  Ecoul = 60.74773606313227  Exc = -12.977919326861247
Extra cycle  E= -108.648551443596  delta_E= 5.09e-10  |g|= 5.43e-05  |ddm|= 2.02e-05
    CPU time for scf_cycle      8.88 sec, wall time      0.19 sec
    CPU time for SCF      8.90 sec, wall time      0.19 sec
converged SCF energy = -108.648551443596
             #0      #1      #2      #3      #4      #5     
  0 N 1s       0.708   0.692   0.219  -0.224                
  0 N 2s                       0.473  -0.488                
  0 N 3s                       0.294  -0.294                
  0 N 2py                                              0.448
  0 N 2pz                                      0.441        
  0 N 3py                                             -0.338
  0 N 3pz                                     -0.336        
  1 N 1s      -0.692   0.708   0.219   0.224                
  1 N 2s                       0.473   0.488                
  1 N 3s                       0.294   0.295                
  1 N 2py                                              0.448
  1 N 2pz                                     -0.441        
  1 N 3py                                             -0.338
  1 N 3pz                                      0.336        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                       0.205   0.196
  0 N 2s                                       1.055   1.057
  0 N 3s                                      -1.008  -1.078
  0 N 2px      0.448   0.219  -0.415                        
  0 N 2py             -0.415  -0.219                        
  0 N 2pz                              0.487  -0.208   0.290
  0 N 3px     -0.338  -0.160   0.303                        
  0 N 3py              0.303   0.160                        
  0 N 3pz                             -0.351  -0.128   0.273
  1 N 1s                                       0.205  -0.196
  1 N 2s                                       1.055  -1.057
  1 N 3s                                      -1.008   1.078
  1 N 2px      0.448  -0.219   0.415                        
  1 N 2py              0.415   0.219                        
  1 N 2pz                              0.487   0.208   0.290
  1 N 3px     -0.338   0.160  -0.303                        
  1 N 3py             -0.303  -0.160                        
  1 N 3pz                             -0.351   0.128   0.273
[-14.560372 -14.560311  -0.764796  -0.746081  -0.308445  -0.287653  -0.287653  -0.230722  -0.230722  -0.203621   0.476498   0.583124]
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 14.000027200136302
    CPU time for vxc      0.81 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 3.37  e= [1.12757]  max|de|= 1.13  lindep= 0.996
davidson 1 2  |r|= 1.07  e= [0.143364]  max|de|= -0.984  lindep= 0.709
davidson 2 3  |r|= 0.269  e= [-0.1063]  max|de|= -0.25  lindep= 0.683
davidson 3 4  |r|= 0.143  e= [-0.131741]  max|de|= -0.0254  lindep= 0.836
davidson 4 5  |r|= 0.0625  e= [-0.137329]  max|de|= -0.00559  lindep= 0.672
davidson 5 6  |r|= 0.0379  e= [-0.139282]  max|de|= -0.00195  lindep= 0.706
davidson 6 7  |r|= 0.0105  e= [-0.139536]  max|de|= -0.000254  lindep= 0.752
root 0 converged  |r|= 0.00311  e= -0.13956030469024228  max|de|= -2.44e-05
converged 7 8  |r|= 0.00311  e= [-0.13956]  max|de|= -2.44e-05
RHF/RKS wavefunction has an internal instability




******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpxix2qbe6
max_memory 4000 MB (current use 263 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2aaf78ea5830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2aaf78ea5cb0>
******** <class 'pyscf.dft.rks.RKS'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpxix2qbe6
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 263 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.289636774688472  LUMO = -0.193498843100926
Initial guess E= -108.676140303885  |g|= 0.0179367
macro= 0  E= -108.6762991063  delta_E= -0.000158802  |g|= 0.000136766  3 KF 15 JK
macro= 1  E= -108.67629910668  delta_E= -3.79345e-10  |g|= 3.37173e-05  1 KF 3 JK
macro= 2  E= -108.67629910668  delta_E= 2.84217e-14  |g|= 1.04995e-05  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 3  E=-108.67629910668  |g|= 1.04995e-05  total 6 KF 24 JK
converged SCF energy = -108.67629910668
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 14.000027243823524
    CPU time for vxc      0.84 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 2.21  e= [0.90173]  max|de|= 0.902  lindep= 0.981
davidson 1 2  |r|= 1.52  e= [0.356484]  max|de|= -0.545  lindep= 0.474
davidson 2 3  |r|= 0.217  e= [0.030243]  max|de|= -0.326  lindep= 0.794
davidson 3 4  |r|= 0.136  e= [0.013691]  max|de|= -0.0166  lindep= 0.56
davidson 4 5  |r|= 0.0835  e= [0.006873]  max|de|= -0.00682  lindep= 0.91
davidson 5 6  |r|= 0.0342  e= [0.004759]  max|de|= -0.00211  lindep= 0.617
davidson 6 7  |r|= 0.0403  e= [0.003407]  max|de|= -0.00135  lindep= 0.865
davidson 7 8  |r|= 0.0287  e= [0.002709]  max|de|= -0.000698  lindep= 0.638
davidson 8 9  |r|= 0.0574  e= [0.001363]  max|de|= -0.00135  lindep= 0.736
davidson 9 10  |r|= 0.0264  e= [0.000133]  max|de|= -0.00123  lindep= 0.853
davidson 10 11  |r|= 0.00917  e= [-0.000024]  max|de|= -0.000157  lindep= 0.562
root 0 converged  |r|= 0.00593  e= -7.849499370954213e-05  max|de|= -5.44e-05
converged 11 12  |r|= 0.00593  e= [-0.000078]  max|de|= -5.44e-05
RHF/RKS wavefunction has an internal instability




******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpxix2qbe6
max_memory 4000 MB (current use 263 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2aaf78ea5830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2aaf78ea5cb0>
******** <class 'pyscf.dft.rks.RKS'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpxix2qbe6
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 263 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.293148392155699  LUMO = -0.197023671470612
Initial guess E= -108.675833066362  |g|= 0.00939805
macro= 0  E= -108.67629682709  delta_E= -0.000463761  |g|= 0.00939805  2 KF 6 JK
macro= 1  E= -108.67629903473  delta_E= -2.20764e-06  |g|= 1.54627e-05  3 KF 17 JK
macro= 2  E= -108.676276759141  delta_E= 2.22756e-05  |g|= 1.97413e-05  2 KF 13 JK
macro= 3  E= -108.676299312703  delta_E= -2.25536e-05  |g|= 0.000758937  2 KF 8 JK
macro= 4  E= -108.67629931369  delta_E= -9.87342e-10  |g|= 1.75296e-05  1 KF 6 JK
Canonicalize SCF orbitals
macro X = 5  E=-108.67629931369  |g|= 1.75296e-05  total 11 KF 56 JK
converged SCF energy = -108.67629931369
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 14.000027241926732
    CPU time for vxc      0.82 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 1.67  e= [0.540428]  max|de|= 0.54  lindep= 0.953
davidson 1 2  |r|= 1.45  e= [0.407572]  max|de|= -0.133  lindep= 0.699
davidson 2 3  |r|= 0.161  e= [0.119375]  max|de|= -0.288  lindep= 0.989
davidson 3 4  |r|= 0.156  e= [0.106792]  max|de|= -0.0126  lindep= 0.536
davidson 4 5  |r|= 0.195  e= [0.086683]  max|de|= -0.0201  lindep= 0.852
davidson 5 6  |r|= 0.107  e= [0.074797]  max|de|= -0.0119  lindep= 0.647
davidson 6 7  |r|= 0.244  e= [0.031505]  max|de|= -0.0433  lindep= 0.724
davidson 7 8  |r|= 0.0762  e= [0.018006]  max|de|= -0.0135  lindep= 0.616
davidson 8 9  |r|= 0.0329  e= [0.016308]  max|de|= -0.0017  lindep= 0.716
davidson 9 10  |r|= 0.0072  e= [0.016086]  max|de|= -0.000222  lindep= 0.895
root 0 converged  |r|= 0.00395  e= 0.016067628226888543  max|de|= -1.84e-05
converged 10 11  |r|= 0.00395  e= [0.016068]  max|de|= -1.84e-05
RHF/RKS wavefunction is stable in the internal stability analysis
             #0      #1      #2      #3      #4      #5     
  0 N 1s       0.696  -0.704   0.218   0.223                
  0 N 2s                       0.469   0.484                
  0 N 3s                       0.298   0.299                
  0 N 2px                                             -0.557
  0 N 2py                                             -0.266
  0 N 2pz                                      0.437        
  0 N 3px                                              0.405
  0 N 3py                                              0.188
  0 N 3pz                                     -0.340        
  1 N 1s      -0.704  -0.696   0.218  -0.223                
  1 N 2s                       0.469  -0.484                
  1 N 3s                       0.298  -0.299                
  1 N 2px                                             -0.159
  1 N 2py                                              0.171
  1 N 2pz                                     -0.437        
  1 N 3px                                              0.127
  1 N 3py                                             -0.118
  1 N 3pz                                      0.340        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                      -0.206  -0.197
  0 N 2s                                      -1.055  -1.059
  0 N 3s                                       1.006   1.078
  0 N 2px      0.172  -0.303                                
  0 N 2py      0.159   0.517   0.224                        
  0 N 2pz                             -0.484   0.211  -0.291
  0 N 3px     -0.118   0.235                                
  0 N 3py     -0.127  -0.412  -0.170                        
  0 N 3pz                              0.355   0.130  -0.271
  1 N 1s                                      -0.206   0.197
  1 N 2s                                      -1.055   1.059
  1 N 3s                                       1.006  -1.078
  1 N 2px     -0.266   0.224  -0.517                        
  1 N 2py      0.557          -0.303                        
  1 N 2pz                             -0.484  -0.211  -0.291
  1 N 3px      0.188  -0.170   0.412                        
  1 N 3py     -0.405           0.235                        
  1 N 3pz                              0.355  -0.130  -0.271
[-14.542098 -14.542025  -0.752135  -0.734443  -0.30029   -0.294544  -0.294542  -0.199233  -0.19923   -0.194718   0.483168   0.590558]
scan 2.80, -108.676299
#INFO: **** input file is /share/home/srwang/pyAutoMR/examples/guess/N2-RKS.py ****
from pyscf import gto, dft
from automr import guess, dump_mat
import numpy as np
#mf=guess.from_fch_simp("v2.fchk", xc='pbe0')

#mf2.verbose=9
#mf2.stability()
for r in np.arange(1.5, 3.0, 0.1):
    mol = gto.Mole(atom='''N 0.0 0.0 0.0; N 0.0 0.0 %f'''%r, basis='def2-svp', verbose=5).build()
    mf = dft.RKS(mol)
    mf.xc = 'pbe0'
    mf.kernel()
    dump_mat.dump_mo(mol, mf.mo_coeff[:,:12])
    print(mf.mo_energy[:12])
    
    mf2 = guess.check_stab(mf, newton=True, res=True)
    dump_mat.dump_mo(mol, mf2.mo_coeff[:,:12])
    print(mf2.mo_energy[:12])
    print('scan %.2f, %.6f' % (r, mf2.e_tot))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='xc06n05', release='3.10.0-1127.el7.x86_64', version='#1 SMP Tue Feb 18 16:39:12 EST 2020', machine='x86_64', processor='x86_64')  Threads 48
Python 3.7.4 (default, Aug 13 2019, 20:35:49) 
[GCC 7.3.0]
numpy 1.17.2  scipy 1.4.1
Date: Thu Sep 16 17:41:43 2021
PySCF version 1.7.6a1
PySCF path  /share/home/srwang/pyscf/pyscf
GIT ORIG_HEAD 80f71dfe77ac5f9caae26788acf76446987635bd
GIT HEAD      ref: refs/heads/master
GIT master branch  80f71dfe77ac5f9caae26788acf76446987635bd

[ENV] PYSCF_EXT_PATH /share/home/srwang/pyscf_ext/fciqmc:
[CONFIG] conf_file /share/home/srwang/.pyscf_conf.py
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 2
[INPUT] num. electrons = 14
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 N      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 N      0.000000000000   0.000000000000   2.900000000000 AA    0.000000000000   0.000000000000   5.480205761239 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] N
[INPUT] 0    0    [5    /1   ]  1712.8415853      -0.0053934125305
                                257.64812677      -0.040221581118
                                58.458245853      -0.1793114499
                                16.198367905      -0.46376317823
                                5.0052600809      -0.44171422662
[INPUT] 0    0    [1    /1   ]  0.58731856571        1
[INPUT] 0    0    [1    /1   ]  0.18764592253        1
[INPUT] 1    0    [3    /1   ]  13.571470233      -0.040072398852
                                2.9257372874      -0.21807045028
                                0.79927750754     -0.51294466049
[INPUT] 1    0    [1    /1   ]  0.21954348034        1
[INPUT] 2    0    [1    /1   ]  1                    1

nuclear repulsion = 8.94127011554483
number of shells = 12
number of NR pGTOs = 48
number of NR cGTOs = 28
basis = def2-svp
ecp = {}
CPU time:       385.50


******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpbyb05rv6
max_memory 4000 MB (current use 263 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2aaf78ea5830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2aaf78ea5cb0>
Set gradient conv threshold to 3.16228e-05
atom N rad-grids = 75, ang-grids = [ 50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  86  86  86  86  86  86  86  86  86 266 266 266 266 266 266 266
 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266]
tot grids = 28092
Drop grids 3534
    CPU time for setting up grids      0.25 sec, wall time      0.01 sec
nelec by numeric integration = 13.992162098101378
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -166.17910833396255  Ecoul = 61.88754906375383  Exc = -13.11633856422868
init E= -108.466627718893
cond(S) = 12.478155749221127
    CPU time for initialize scf      1.83 sec, wall time      0.04 sec
  HOMO = -0.20373649353441  LUMO = -0.192429863148589
  mo_energy =
[-14.378029 -14.377943  -0.698049  -0.682367  -0.224036  -0.203736  -0.203736  -0.19243   -0.19243   -0.169157   0.516007   0.621278   0.707351   0.724966
   0.724966   0.788559   0.788559   0.970427   2.154682   2.154697   2.154701   2.154716   2.154764   2.154764   2.155113   2.155113   2.157553   2.167039]
nelec by numeric integration = 14.000016090921465
    CPU time for vxc      0.83 sec, wall time      0.02 sec
E1 = -164.16424808050814  Ecoul = 59.43527272860901  Exc = -12.830889029774553
cycle= 1 E= -108.618594266129  delta_E= -0.152  |g|= 0.243  |ddm|= 1.62
    CPU time for cycle= 1      1.09 sec, wall time      0.02 sec
  HOMO = -0.330040158427438  LUMO = -0.27789374371938
  mo_energy =
[-14.68428  -14.684223  -0.808023  -0.793643  -0.347     -0.33004   -0.33004   -0.277894  -0.277894  -0.255948   0.444842   0.551074   0.620507   0.638348
   0.638348   0.703222   0.703222   0.889434   2.046794   2.046808   2.047559   2.047573   2.047966   2.047966   2.049552   2.049552   2.051172   2.062522]
nelec by numeric integration = 14.000010779104592
    CPU time for vxc      0.84 sec, wall time      0.02 sec
E1 = -165.58234707642166  Ecoul = 61.08095865701054  Exc = -13.068767886036252
cycle= 2 E= -108.628886189903  delta_E= -0.0103  |g|= 0.15  |ddm|= 0.447
    CPU time for cycle= 2      1.02 sec, wall time      0.02 sec
  HOMO = -0.285345678525035  LUMO = -0.232012758313684
  mo_energy =
[-14.558419 -14.55836   -0.762442  -0.747111  -0.303839  -0.285346  -0.285346  -0.232013  -0.232013  -0.208669   0.473746   0.580579   0.656563   0.674151
   0.674151   0.738718   0.738718   0.923593   2.091888   2.091902   2.092655   2.092669   2.092844   2.092844   2.094431   2.094431   2.095948   2.107222]
nelec by numeric integration = 14.000012945694543
    CPU time for vxc      1.00 sec, wall time      0.02 sec
E1 = -165.045732490688  Ecoul = 60.44575489731952  Exc = -12.976777856404105
cycle= 3 E= -108.635485334228  delta_E= -0.0066  |g|= 0.000821  |ddm|= 0.17
    CPU time for cycle= 3      1.32 sec, wall time      0.03 sec
  HOMO = -0.285217808870474  LUMO = -0.231833095224783
  mo_energy =
[-14.558145 -14.558085  -0.762337  -0.746984  -0.303704  -0.285218  -0.285218  -0.231833  -0.231833  -0.208374   0.473932   0.580754   0.656792   0.674407
   0.674407   0.738945   0.738945   0.92385    2.092128   2.092142   2.092897   2.092911   2.093075   2.093075   2.094671   2.094671   2.096179   2.107469]
nelec by numeric integration = 14.000012951332042
    CPU time for vxc      0.90 sec, wall time      0.02 sec
E1 = -165.04442654169668  Ecoul = 60.44430156929379  Exc = -12.97663087996245
cycle= 4 E= -108.635485736821  delta_E= -4.03e-07  |g|= 0.000227  |ddm|= 0.00164
    CPU time for cycle= 4      1.08 sec, wall time      0.02 sec
  HOMO = -0.285220204494625  LUMO = -0.231835485769878
  mo_energy =
[-14.558129 -14.558069  -0.762342  -0.746983  -0.303705  -0.28522   -0.28522   -0.231835  -0.231835  -0.208371   0.473901   0.580771   0.656806   0.674399
   0.674399   0.738941   0.738941   0.923825   2.092124   2.092138   2.092893   2.092907   2.09307    2.09307    2.094667   2.094667   2.096174   2.107465]
nelec by numeric integration = 14.000012949698174
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -165.04441333783416  Ecoul = 60.444276824823376  Exc = -12.976619350004414
cycle= 5 E= -108.63548574747  delta_E= -1.06e-08  |g|= 7.74e-06  |ddm|= 0.000144
    CPU time for cycle= 5      1.00 sec, wall time      0.02 sec
  HOMO = -0.285217630395583  LUMO = -0.231834330229334
  mo_energy =
[-14.558119 -14.55806   -0.76234   -0.746981  -0.303702  -0.285218  -0.285218  -0.231834  -0.231834  -0.208369   0.473901   0.580769   0.656804   0.674397
   0.674397   0.738939   0.738939   0.923825   2.092123   2.092138   2.092892   2.092906   2.09307    2.09307    2.094666   2.094666   2.096174   2.107465]
nelec by numeric integration = 14.000012949786843
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -165.0443968083847  Ecoul = 60.444257421212995  Exc = -12.976616475525654
cycle= 6 E= -108.635485747153  delta_E= 3.18e-10  |g|= 4.43e-05  |ddm|= 1.87e-05
    CPU time for cycle= 6      1.00 sec, wall time      0.02 sec
  HOMO = -0.28521763226427  LUMO = -0.231834332263689
  mo_energy =
[-14.558119 -14.55806   -0.76234   -0.746981  -0.303702  -0.285218  -0.285218  -0.231834  -0.231834  -0.208369   0.473901   0.580769   0.656804   0.674397
   0.674397   0.738939   0.738939   0.923825   2.092123   2.092138   2.092892   2.092906   2.09307    2.09307    2.094666   2.094666   2.096174   2.107465]
nelec by numeric integration = 14.000012949786788
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -165.04439682682562  Ecoul = 60.444257441910466  Exc = -12.976616478113733
cycle= 7 E= -108.635485747484  delta_E= -3.32e-10  |g|= 4.27e-06  |ddm|= 1.73e-05
    CPU time for cycle= 7      1.01 sec, wall time      0.02 sec
  HOMO = -0.285217843842584  LUMO = -0.231834505069194
  mo_energy =
[-14.55812  -14.55806   -0.76234   -0.746981  -0.303702  -0.285218  -0.285218  -0.231835  -0.231835  -0.208369   0.473901   0.580769   0.656804   0.674397
   0.674397   0.738939   0.738939   0.923825   2.092123   2.092138   2.092892   2.092906   2.09307    2.09307    2.094666   2.094666   2.096174   2.107465]
nelec by numeric integration = 14.00001294977877
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -165.0443987864143  Ecoul = 60.44425972370334  Exc = -12.976616795582348
Extra cycle  E= -108.635485742748  delta_E= 4.74e-09  |g|= 0.000167  |ddm|= 6.11e-05
    CPU time for scf_cycle     10.36 sec, wall time      0.22 sec
    CPU time for SCF     10.38 sec, wall time      0.22 sec
converged SCF energy = -108.635485742748
             #0      #1      #2      #3      #4      #5     
  0 N 1s       0.723   0.676   0.219  -0.223                
  0 N 2s                       0.473  -0.487                
  0 N 3s                       0.295  -0.294                
  0 N 2px                                              0.207
  0 N 2py                                              0.408
  0 N 2pz                                      0.441        
  0 N 3px                                             -0.156
  0 N 3py                                             -0.309
  0 N 3pz                                     -0.340        
  1 N 1s      -0.676   0.723   0.219   0.223                
  1 N 2s                       0.473   0.487                
  1 N 3s                       0.295   0.294                
  1 N 2px                                              0.207
  1 N 2py                                              0.408
  1 N 2pz                                     -0.441        
  1 N 3px                                             -0.156
  1 N 3py                                             -0.309
  1 N 3pz                                      0.340        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                       0.203   0.198
  0 N 2s                                       1.046   1.066
  0 N 3s                                      -1.006  -1.085
  0 N 2px      0.408  -0.468                                
  0 N 2py     -0.207          -0.468                        
  0 N 2pz                              0.484  -0.225   0.276
  0 N 3px     -0.309   0.343                                
  0 N 3py      0.156           0.343                        
  0 N 3pz                             -0.348  -0.154   0.260
  1 N 1s                                       0.203  -0.198
  1 N 2s                                       1.046  -1.066
  1 N 3s                                      -1.006   1.085
  1 N 2px      0.408   0.468                                
  1 N 2py     -0.207           0.468                        
  1 N 2pz                              0.484   0.225   0.276
  1 N 3px     -0.309  -0.343                                
  1 N 3py      0.156          -0.343                        
  1 N 3pz                             -0.348   0.154   0.260
[-14.55812  -14.55806   -0.76234   -0.746981  -0.303702  -0.285218  -0.285218  -0.231835  -0.231835  -0.208369   0.473901   0.580769]
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 14.000012949778766
    CPU time for vxc      0.79 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 3.11  e= [0.907102]  max|de|= 0.907  lindep= 0.995
davidson 1 2  |r|= 1.04  e= [0.109623]  max|de|= -0.797  lindep= 0.705
davidson 2 3  |r|= 0.267  e= [-0.110425]  max|de|= -0.22  lindep= 0.692
davidson 3 4  |r|= 0.165  e= [-0.140933]  max|de|= -0.0305  lindep= 0.837
davidson 4 5  |r|= 0.0763  e= [-0.148783]  max|de|= -0.00785  lindep= 0.674
davidson 5 6  |r|= 0.0641  e= [-0.152166]  max|de|= -0.00338  lindep= 0.724
davidson 6 7  |r|= 0.0153  e= [-0.152914]  max|de|= -0.000748  lindep= 0.731
root 0 converged  |r|= 0.0059  e= -0.1529803556733109  max|de|= -6.68e-05
converged 7 8  |r|= 0.0059  e= [-0.15298]  max|de|= -6.68e-05
RHF/RKS wavefunction has an internal instability




******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpbyb05rv6
max_memory 4000 MB (current use 263 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2aaf78ea5830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2aaf78ea5cb0>
******** <class 'pyscf.dft.rks.RKS'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpbyb05rv6
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 263 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.288705569095237  LUMO = -0.195097210140346
Initial guess E= -108.667578328681  |g|= 0.0262575
macro= 0  E= -108.667816679215  delta_E= -0.000238351  |g|= 0.000340613  4 KF 15 JK
macro= 1  E= -108.667816977558  delta_E= -2.98343e-07  |g|= 5.49727e-05  2 KF 11 JK
macro= 2  E= -108.667816977558  delta_E= -1.7053e-13  |g|= 7.66487e-06  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 3  E=-108.667816977558  |g|= 7.66487e-06  total 8 KF 32 JK
converged SCF energy = -108.667816977558
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 14.000012723588753
    CPU time for vxc      0.81 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 1.65  e= [0.498365]  max|de|= 0.498  lindep= 0.963
davidson 1 2  |r|= 1.33  e= [0.287117]  max|de|= -0.211  lindep= 0.444
davidson 2 3  |r|= 0.19  e= [0.051226]  max|de|= -0.236  lindep= 0.799
davidson 3 4  |r|= 0.218  e= [0.019896]  max|de|= -0.0313  lindep= 0.709
davidson 4 5  |r|= 0.0767  e= [0.00715]  max|de|= -0.0127  lindep= 0.829
davidson 5 6  |r|= 0.045  e= [0.005064]  max|de|= -0.00209  lindep= 0.608
davidson 6 7  |r|= 0.0341  e= [0.003792]  max|de|= -0.00127  lindep= 0.886
davidson 7 8  |r|= 0.026  e= [0.003203]  max|de|= -0.000589  lindep= 0.586
davidson 8 9  |r|= 0.0331  e= [0.002469]  max|de|= -0.000734  lindep= 0.911
davidson 9 10  |r|= 0.0246  e= [0.001881]  max|de|= -0.000589  lindep= 0.649
davidson 10 11  |r|= 0.0491  e= [0.000615]  max|de|= -0.00127  lindep= 0.763
davidson 11 12  |r|= 0.0175  e= [0.000139]  max|de|= -0.000475  lindep= 0.882
davidson 12 1  |r|= 0.0175  e= [0.000139]  max|de|= 8.84e-16  lindep= 0.999
root 0 converged  |r|= 0.00431  e= 0.00010155500416803366  max|de|= -3.76e-05
converged 13 2  |r|= 0.00431  e= [0.000102]  max|de|= -3.76e-05
RHF/RKS wavefunction is stable in the internal stability analysis
             #0      #1      #2      #3      #4      #5     
  0 N 1s       0.693   0.708   0.218   0.222                
  0 N 2s                       0.470   0.482                
  0 N 3s                       0.299   0.299                
  0 N 2px                                             -0.278
  0 N 2py                                              0.500
  0 N 2pz                                     -0.438        
  0 N 3px                                              0.196
  0 N 3py                                             -0.365
  0 N 3pz                                      0.343        
  1 N 1s      -0.707   0.693   0.218  -0.222                
  1 N 2s                       0.470  -0.482                
  1 N 3s                       0.299  -0.299                
  1 N 2px                                              0.256
  1 N 2py                                              0.210
  1 N 2pz                                      0.438        
  1 N 3px                                             -0.180
  1 N 3py                                             -0.161
  1 N 3pz                                     -0.343        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                       0.203  -0.199
  0 N 2s                                       1.046  -1.068
  0 N 3s                                      -1.003   1.085
  0 N 2px      0.210           0.461  -0.284                
  0 N 2py     -0.256           0.322  -0.102                
  0 N 2pz              0.482                  -0.229  -0.276
  0 N 3px     -0.161          -0.370   0.219                
  0 N 3py      0.180          -0.251                        
  0 N 3pz             -0.352                  -0.155  -0.259
  1 N 1s                                       0.203   0.199
  1 N 2s                                       1.046   1.068
  1 N 3s                                      -1.003  -1.085
  1 N 2px      0.500           0.102   0.322                
  1 N 2py      0.278          -0.284  -0.461                
  1 N 2pz              0.482                   0.229  -0.276
  1 N 3px     -0.365                  -0.251                
  1 N 3py     -0.196           0.219   0.370                
  1 N 3pz             -0.352                   0.155  -0.259
[-14.540338 -14.540266  -0.749703  -0.735415  -0.29562   -0.293884  -0.293883  -0.199609  -0.198644  -0.198643   0.480552   0.588047]
scan 2.90, -108.667817
