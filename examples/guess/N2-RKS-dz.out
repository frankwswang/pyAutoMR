#INFO: **** input file is /share/home/srwang/pyAutoMR/examples/guess/N2-RKS-dz.py ****
from pyscf import gto, dft
from automr import guess, dump_mat
import numpy as np
#mf=guess.from_fch_simp("v2.fchk", xc='pbe0')

#mf2.verbose=9
#mf2.stability()
for r in np.arange(4.5, 4.55, 0.25):
    mol = gto.Mole(atom='''N 0.0 0.0 0.0; N 0.0 0.0 %f'''%r, basis='ccpvdz', verbose=5, symmetry='D2h').build()
    mf = dft.RKS(mol)
    mf.xc = 'pbe0'
    mf.kernel()
    dump_mat.dump_mo(mol, mf.mo_coeff[:,:12])
    print(mf.mo_energy[:12])
    
    mf2 = guess.check_stab(mf, newton=True, res=True)
    dump_mat.dump_mo(mol, mf2.mo_coeff[:,:12])
    print(mf2.mo_energy[:12])
    print('scan %.2f, %.6f' % (r, mf2.e_tot))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='xn01', release='3.10.0-1127.el7.x86_64', version='#1 SMP Tue Feb 18 16:39:12 EST 2020', machine='x86_64', processor='x86_64')  Threads 32
Python 3.7.4 (default, Aug 13 2019, 20:35:49) 
[GCC 7.3.0]
numpy 1.17.2  scipy 1.4.1
Date: Thu Sep 16 19:03:34 2021
PySCF version 1.7.6a1
PySCF path  /share/home/srwang/pyscf/pyscf
GIT ORIG_HEAD 80f71dfe77ac5f9caae26788acf76446987635bd
GIT HEAD      ref: refs/heads/master
GIT master branch  80f71dfe77ac5f9caae26788acf76446987635bd

[ENV] PYSCF_EXT_PATH /share/home/srwang/pyscf_ext/fciqmc:
[CONFIG] conf_file /share/home/srwang/.pyscf_conf.py
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 2
[INPUT] num. electrons = 14
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry D2h subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 N      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 N      0.000000000000   0.000000000000   4.500000000000 AA    0.000000000000   0.000000000000   8.503767560543 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] N
[INPUT] 0    0    [8    /2   ]  9046              0.0007 -0.000153
                                1357              0.005389 -0.001208
                                309.3             0.027406 -0.005992
                                87.73             0.103207 -0.024544
                                28.56             0.278723 -0.067459
                                10.21             0.44854 -0.158078
                                3.838             0.278238 -0.121831
                                0.7466            0.01544 0.549003
[INPUT] 0    0    [1    /1   ]  0.2248               1
[INPUT] 1    0    [3    /1   ]  13.55             0.039919
                                2.917             0.217169
                                0.7973            0.510319
[INPUT] 1    0    [1    /1   ]  0.2185               1
[INPUT] 2    0    [1    /1   ]  0.817                1

nuclear repulsion = 5.76215185224
point group symmetry = D2h
num. orbitals of irrep Ag = 7
num. orbitals of irrep B1g = 1
num. orbitals of irrep B2g = 3
num. orbitals of irrep B3g = 3
num. orbitals of irrep Au = 1
num. orbitals of irrep B1u = 7
num. orbitals of irrep B2u = 3
num. orbitals of irrep B3u = 3
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = ccpvdz
ecp = {}
CPU time:         1.08


******** <class 'pyscf.dft.rks_symm.SymAdaptedRKS'> ********
method = SymAdaptedRKS-SymAdaptedRHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpv56fymum
max_memory 4000 MB (current use 115 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2b9ba0613830>
grids dens level: 3
symmetrized grids: D2h
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2b9ba0613cb0>
Freeze 0 electrons in irreps []
    14 free electrons in irreps Ag B1g B2g B3g Au B1u B2u B3u
Set gradient conv threshold to 3.16228e-05
atom N rad-grids = 75, ang-grids = [ 50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  86  86  86  86  86  86  86  86  86 266 266 266 266 266 266 266
 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266]
tot grids = 28092
Drop grids 3808
    CPU time for setting up grids      0.30 sec, wall time      0.01 sec
nelec by numeric integration = 13.993459589991838
    CPU time for vxc      0.58 sec, wall time      0.03 sec
E1 = -159.93546974697998  Ecoul = 58.71715577045521  Exc = -13.117468392315494
init E= -108.5736305166
cond(S) = 9.232156026658618
    CPU time for initialize scf      1.20 sec, wall time      0.08 sec
HOMO (B3u) = -0.196344130379785  LUMO (B3g) = -0.196089191548006
irrep_nelec = [6, 0, 0, 0, 0, 4, 2, 2]
Ag nocc = 3  HOMO = -0.197769244905842  LUMO = 0.74145663768487
   mo_energy = [-14.39094   -0.704385  -0.197769   0.741457   0.853039   1.774665   1.774702]
B1g nocc = 0
   mo_energy = [1.774619]
B2g nocc = 0
   mo_energy = [-0.196089  0.75269   1.774589]
B3g nocc = 0
   mo_energy = [-0.196089  0.75269   1.774589]
Au nocc = 0
   mo_energy = [1.774619]
B1u nocc = 2  HOMO = -0.704091843829712  LUMO = -0.194692423186604
   mo_energy = [-14.39094   -0.704092  -0.194692   0.76212    0.856343   1.774665   1.774708]
B2u nocc = 1  HOMO = -0.196344130379785  LUMO = 0.751095915445321

WARN: B2u HOMO -0.196344130379785 > system LUMO -0.196089191548006

   mo_energy = [-0.196344  0.751096  1.774587]
B3u nocc = 1  HOMO = -0.196344130379785  LUMO = 0.751095915445319

WARN: B3u HOMO -0.196344130379785 > system LUMO -0.196089191548006

   mo_energy = [-0.196344  0.751096  1.774587]
nelec by numeric integration = 14.000045296648377
    CPU time for vxc      0.70 sec, wall time      0.03 sec
E1 = -158.25492554472777  Ecoul = 56.72658420234128  Exc = -12.880086919270118
cycle= 1 E= -108.646276409417  delta_E= -0.0726  |g|= 0.197  |ddm|= 1.66
    CPU time for cycle= 1      0.96 sec, wall time      0.04 sec
HOMO (B3u) = -0.295375753709396  LUMO (B3g) = -0.266254920388191
irrep_nelec = [6, 0, 0, 0, 0, 4, 2, 2]
Ag nocc = 3  HOMO = -0.29695273467071  LUMO = 0.671097993494976
   mo_energy = [-14.638341  -0.795472  -0.296953   0.671098   0.788204   1.699633   1.69971 ]
B1g nocc = 0
   mo_energy = [1.699664]
B2g nocc = 0
   mo_energy = [-0.266255  0.682585  1.699943]
B3g nocc = 0
   mo_energy = [-0.266255  0.682585  1.699943]
Au nocc = 0
   mo_energy = [1.699918]
B1u nocc = 2  HOMO = -0.794295583680749  LUMO = -0.264459703344188
   mo_energy = [-14.638334  -0.794296  -0.26446    0.692216   0.791938   1.699964   1.700091]
B2u nocc = 1  HOMO = -0.295375753709396  LUMO = 0.680879968381716
   mo_energy = [-0.295376  0.68088   1.699548]
B3u nocc = 1  HOMO = -0.295375753709396  LUMO = 0.680879968381714
   mo_energy = [-0.295376  0.68088   1.699548]
nelec by numeric integration = 14.000043839037962
    CPU time for vxc      0.55 sec, wall time      0.02 sec
E1 = -159.35389971455845  Ecoul = 58.00126750679013  Exc = -13.062289929949397
cycle= 2 E= -108.652770285478  delta_E= -0.00649  |g|= 0.119  |ddm|= 0.324
    CPU time for cycle= 2      0.77 sec, wall time      0.03 sec
HOMO (B2u) = -0.260525622920315  LUMO (B2g) = -0.231329199484769
irrep_nelec = [6, 0, 0, 0, 0, 4, 2, 2]
Ag nocc = 3  HOMO = -0.262247608985587  LUMO = 0.69924259455625
   mo_energy = [-14.540794  -0.759312  -0.262248   0.699243   0.813659   1.73023    1.730314]
B1g nocc = 0
   mo_energy = [1.730268]
B2g nocc = 0
   mo_energy = [-0.231329  0.710605  1.73054 ]
B3g nocc = 0
   mo_energy = [-0.231329  0.710605  1.73054 ]
Au nocc = 0
   mo_energy = [1.73052]
B1u nocc = 2  HOMO = -0.758118260951118  LUMO = -0.229435761364133
   mo_energy = [-14.540787  -0.758118  -0.229436   0.720186   0.817321   1.730566   1.730685]
B2u nocc = 1  HOMO = -0.260525622920315  LUMO = 0.70894342873718
   mo_energy = [-0.260526  0.708943  1.730148]
B3u nocc = 1  HOMO = -0.260525622920316  LUMO = 0.70894342873718
   mo_energy = [-0.260526  0.708943  1.730148]
nelec by numeric integration = 14.00004443917571
    CPU time for vxc      0.55 sec, wall time      0.02 sec
E1 = -158.94014404943667  Ecoul = 57.513907630093364  Exc = -12.992627713821149
cycle= 3 E= -108.656712280924  delta_E= -0.00394  |g|= 0.000396  |ddm|= 0.123
    CPU time for cycle= 3      0.75 sec, wall time      0.03 sec
HOMO (B3u) = -0.260505972677457  LUMO (B3g) = -0.231291983172079
irrep_nelec = [6, 0, 0, 0, 0, 4, 2, 2]
Ag nocc = 3  HOMO = -0.26222739442291  LUMO = 0.699327904885035
   mo_energy = [-14.54076   -0.759344  -0.262227   0.699328   0.813688   1.73029    1.730377]
B1g nocc = 0
   mo_energy = [1.730331]
B2g nocc = 0
   mo_energy = [-0.231292  0.710674  1.730603]
B3g nocc = 0
   mo_energy = [-0.231292  0.710674  1.730603]
Au nocc = 0
   mo_energy = [1.730583]
B1u nocc = 2  HOMO = -0.758144220456637  LUMO = -0.229387731962765
   mo_energy = [-14.540752  -0.758144  -0.229388   0.72026    0.817346   1.730629   1.730747]
B2u nocc = 1  HOMO = -0.260505972677458  LUMO = 0.709028349638698
   mo_energy = [-0.260506  0.709028  1.730209]
B3u nocc = 1  HOMO = -0.260505972677457  LUMO = 0.7090283496387
   mo_energy = [-0.260506  0.709028  1.730209]
nelec by numeric integration = 14.000044447318544
    CPU time for vxc      0.55 sec, wall time      0.02 sec
E1 = -158.94011090483448  Ecoul = 57.51389905612943  Exc = -12.992652338825541
cycle= 4 E= -108.656712335291  delta_E= -5.44e-08  |g|= 2.8e-05  |ddm|= 0.000579
    CPU time for cycle= 4      0.76 sec, wall time      0.03 sec
HOMO (B3u) = -0.260504500384726  LUMO (B2g) = -0.231291722577274
irrep_nelec = [6, 0, 0, 0, 0, 4, 2, 2]
Ag nocc = 3  HOMO = -0.262225727015309  LUMO = 0.699324223668719
   mo_energy = [-14.540752  -0.759342  -0.262226   0.699324   0.813685   1.730288   1.730375]
B1g nocc = 0
   mo_energy = [1.730329]
B2g nocc = 0
   mo_energy = [-0.231292  0.71067   1.7306  ]
B3g nocc = 0
   mo_energy = [-0.231292  0.71067   1.7306  ]
Au nocc = 0
   mo_energy = [1.730581]
B1u nocc = 2  HOMO = -0.758142886530899  LUMO = -0.229387414057542
   mo_energy = [-14.540745  -0.758143  -0.229387   0.720257   0.817344   1.730627   1.730745]
B2u nocc = 1  HOMO = -0.260504500384727  LUMO = 0.709024017213256
   mo_energy = [-0.260505  0.709024  1.730206]
B3u nocc = 1  HOMO = -0.260504500384726  LUMO = 0.709024017213257
   mo_energy = [-0.260505  0.709024  1.730206]
nelec by numeric integration = 14.000044446896812
    CPU time for vxc      0.57 sec, wall time      0.02 sec
E1 = -158.940095062228  Ecoul = 57.51388089240163  Exc = -12.992650017903829
cycle= 5 E= -108.65671233549  delta_E= -2e-10  |g|= 5.13e-06  |ddm|= 2.16e-05
    CPU time for cycle= 5      0.79 sec, wall time      0.03 sec
HOMO (B3u) = -0.26050426240163  LUMO (B3g) = -0.231291748237254
irrep_nelec = [6, 0, 0, 0, 0, 4, 2, 2]
Ag nocc = 3  HOMO = -0.262225459938825  LUMO = 0.699323088323395
   mo_energy = [-14.54075   -0.759342  -0.262225   0.699323   0.813684   1.730287   1.730374]
B1g nocc = 0
   mo_energy = [1.730329]
B2g nocc = 0
   mo_energy = [-0.231292  0.71067   1.7306  ]
B3g nocc = 0
   mo_energy = [-0.231292  0.71067   1.7306  ]
Au nocc = 0
   mo_energy = [1.73058]
B1u nocc = 2  HOMO = -0.758142703185894  LUMO = -0.229387406071403
   mo_energy = [-14.540743  -0.758143  -0.229387   0.720256   0.817343   1.730626   1.730744]
B2u nocc = 1  HOMO = -0.26050426240163  LUMO = 0.709022945960899
   mo_energy = [-0.260504  0.709023  1.730206]
B3u nocc = 1  HOMO = -0.26050426240163  LUMO = 0.7090229459609
   mo_energy = [-0.260504  0.709023  1.730206]
nelec by numeric integration = 14.000044446987694
    CPU time for vxc      0.56 sec, wall time      0.02 sec
E1 = -158.9400913278446  Ecoul = 57.51387631936649  Exc = -12.992649179256777
Extra cycle  E= -108.656712335495  delta_E= -4.69e-12  |g|= 2.13e-06  |ddm|= 4.43e-06
    CPU time for scf_cycle      6.00 sec, wall time      0.26 sec
    CPU time for SCF      6.01 sec, wall time      0.26 sec
converged SCF energy = -108.656712335495
             #0      #1      #2      #3      #4      #5     
  0 N 1s       0.709   0.709                                
  0 N 2s                       0.366   0.366                
  0 N 3s                       0.399   0.398                
  0 N 2py                                              0.458
  0 N 2pz                                      0.455        
  0 N 3py                                              0.351
  0 N 3pz                                      0.353        
  1 N 1s       0.709  -0.709                                
  1 N 2s                       0.366  -0.366                
  1 N 3s                       0.399  -0.398                
  1 N 2py                                              0.458
  1 N 2pz                                     -0.455        
  1 N 3py                                              0.351
  1 N 3pz                                     -0.353        
             #6      #7      #8      #9      #10     #11    
  0 N 2px      0.458   0.458                                
  0 N 2py                      0.458                  -0.691
  0 N 2pz                              0.460  -0.691        
  0 N 3px      0.351   0.350                                
  0 N 3py                      0.350                   0.751
  0 N 3pz                              0.349   0.746        
  1 N 2px      0.458  -0.458                                
  1 N 2py                     -0.458                  -0.691
  1 N 2pz                              0.460   0.691        
  1 N 3px      0.351  -0.350                                
  1 N 3py                     -0.350                   0.751
  1 N 3pz                              0.349  -0.746        
[-14.54075  -14.540743  -0.759342  -0.758143  -0.262225  -0.260504  -0.260504  -0.231292  -0.231292  -0.229387   0.699323   0.709023]
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 14.000044446987694
    CPU time for vxc      0.55 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 4.06  e= [5.132784]  max|de|= 5.13  lindep= 0.849
davidson 1 2  |r|= 2.49  e= [4.582927]  max|de|= -0.55  lindep= 0.533
davidson 2 3  |r|= 3.68  e= [4.4284]  max|de|= -0.155  lindep= 0.553
davidson 3 4  |r|= 0.747  e= [4.057831]  max|de|= -0.371  lindep= 0.348
davidson 4 5  |r|= 3.16  e= [3.545579]  max|de|= -0.512  lindep= 0.348
Large |r| detected, restore to previous x0
davidson 5 1  |r|= 0.747  e= [4.057831]  max|de|= 0.512  lindep= 0.958
davidson 6 2  |r|= 0.945  e= [4.051248]  max|de|= -0.00658  lindep= 0.858
davidson 7 3  |r|= 3.54  e= [3.96928]  max|de|= -0.082  lindep= 0.858
Large |r| detected, restore to previous x0
davidson 8 1  |r|= 0.945  e= [4.051248]  max|de|= 0.082  lindep= 0.935
davidson 9 2  |r|= 1.09  e= [4.044981]  max|de|= -0.00627  lindep= 0.892
davidson 10 3  |r|= 2.83  e= [4.01099]  max|de|= -0.034  lindep= 0.51
davidson 11 4  |r|= 1.48  e= [3.458594]  max|de|= -0.552  lindep= 0.0666
davidson 12 5  |r|= 2.86  e= [3.364176]  max|de|= -0.0944  lindep= 0.0679
davidson 13 6  |r|= 3.26  e= [3.311881]  max|de|= -0.0523  lindep= 0.0357
davidson 14 7  |r|= 2.93  e= [3.035567]  max|de|= -0.276  lindep= 0.0406
davidson 15 8  |r|= 4.15  e= [2.873648]  max|de|= -0.162  lindep= 0.031
davidson 16 9  |r|= 0.784  e= [2.411953]  max|de|= -0.462  lindep= 0.244
davidson 17 10  |r|= 0.0237  e= [2.36858]  max|de|= -0.0434  lindep= 0.949
root 0 converged  |r|= 0.00099  e= 2.368497880315465  max|de|= -8.24e-05
converged 18 11  |r|= 0.00099  e= [2.368498]  max|de|= -8.24e-05
RHF/RKS wavefunction is stable in the internal stability analysis
             #0      #1      #2      #3      #4      #5     
  0 N 1s       0.709   0.709                                
  0 N 2s                       0.366   0.366                
  0 N 3s                       0.399   0.398                
  0 N 2py                                              0.458
  0 N 2pz                                      0.455        
  0 N 3py                                              0.351
  0 N 3pz                                      0.353        
  1 N 1s       0.709  -0.709                                
  1 N 2s                       0.366  -0.366                
  1 N 3s                       0.399  -0.398                
  1 N 2py                                              0.458
  1 N 2pz                                     -0.455        
  1 N 3py                                              0.351
  1 N 3pz                                     -0.353        
             #6      #7      #8      #9      #10     #11    
  0 N 2px      0.458   0.458                                
  0 N 2py                      0.458                  -0.691
  0 N 2pz                              0.460  -0.691        
  0 N 3px      0.351   0.350                                
  0 N 3py                      0.350                   0.751
  0 N 3pz                              0.349   0.746        
  1 N 2px      0.458  -0.458                                
  1 N 2py                     -0.458                  -0.691
  1 N 2pz                              0.460   0.691        
  1 N 3px      0.351  -0.350                                
  1 N 3py                     -0.350                   0.751
  1 N 3pz                              0.349  -0.746        
[-14.54075  -14.540743  -0.759342  -0.758143  -0.262225  -0.260504  -0.260504  -0.231292  -0.231292  -0.229387   0.699323   0.709023]
scan 4.50, -108.656712
