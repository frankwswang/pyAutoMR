#INFO: **** input file is /share/home/srwang/pyAutoMR/examples/guess/N2-RKS.py ****
from pyscf import gto, dft
from automr import guess, dump_mat
import numpy as np
#mf=guess.from_fch_simp("v2.fchk", xc='pbe0')

#mf2.verbose=9
#mf2.stability()
for r in np.arange(3.0, 9.0, 0.25):
    mol = gto.Mole(atom='''N 0.0 0.0 0.0; N 0.0 0.0 %f'''%r, basis='def2-svp', verbose=5).build()
    mf = dft.RKS(mol)
    mf.xc = 'pbe0'
    mf.kernel()
    dump_mat.dump_mo(mol, mf.mo_coeff[:,:12])
    print(mf.mo_energy[:12])
    
    mf2 = guess.check_stab(mf, newton=True, res=True)
    dump_mat.dump_mo(mol, mf2.mo_coeff[:,:12])
    print(mf2.mo_energy[:12])
    print('scan %.2f, %.6f' % (r, mf2.e_tot))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='xc06n05', release='3.10.0-1127.el7.x86_64', version='#1 SMP Tue Feb 18 16:39:12 EST 2020', machine='x86_64', processor='x86_64')  Threads 48
Python 3.7.4 (default, Aug 13 2019, 20:35:49) 
[GCC 7.3.0]
numpy 1.17.2  scipy 1.4.1
Date: Thu Sep 16 17:43:51 2021
PySCF version 1.7.6a1
PySCF path  /share/home/srwang/pyscf/pyscf
GIT ORIG_HEAD 80f71dfe77ac5f9caae26788acf76446987635bd
GIT HEAD      ref: refs/heads/master
GIT master branch  80f71dfe77ac5f9caae26788acf76446987635bd

[ENV] PYSCF_EXT_PATH /share/home/srwang/pyscf_ext/fciqmc:
[CONFIG] conf_file /share/home/srwang/.pyscf_conf.py
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 2
[INPUT] num. electrons = 14
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 N      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 N      0.000000000000   0.000000000000   3.000000000000 AA    0.000000000000   0.000000000000   5.669178373695 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] N
[INPUT] 0    0    [5    /1   ]  1712.8415853      -0.0053934125305
                                257.64812677      -0.040221581118
                                58.458245853      -0.1793114499
                                16.198367905      -0.46376317823
                                5.0052600809      -0.44171422662
[INPUT] 0    0    [1    /1   ]  0.58731856571        1
[INPUT] 0    0    [1    /1   ]  0.18764592253        1
[INPUT] 1    0    [3    /1   ]  13.571470233      -0.040072398852
                                2.9257372874      -0.21807045028
                                0.79927750754     -0.51294466049
[INPUT] 1    0    [1    /1   ]  0.21954348034        1
[INPUT] 2    0    [1    /1   ]  1                    1

nuclear repulsion = 8.64322777836
number of shells = 12
number of NR pGTOs = 48
number of NR cGTOs = 28
basis = def2-svp
ecp = {}
CPU time:         0.81


******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmp1miwhoev
max_memory 4000 MB (current use 108 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2b8e2e583830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2b8e2e583cb0>
Set gradient conv threshold to 3.16228e-05
atom N rad-grids = 75, ang-grids = [ 50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  86  86  86  86  86  86  86  86  86 266 266 266 266 266 266 266
 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266]
tot grids = 28092
Drop grids 3524
    CPU time for setting up grids      0.44 sec, wall time      0.01 sec
nelec by numeric integration = 13.992135233562898
    CPU time for vxc      0.95 sec, wall time      0.02 sec
E1 = -165.58218686367616  Ecoul = 61.5888908210114  Exc = -13.115597258900062
init E= -108.465665523205
cond(S) = 12.008914836311863
    CPU time for initialize scf      3.34 sec, wall time      0.11 sec
  HOMO = -0.202704273858414  LUMO = -0.19347819126673
  mo_energy =
[-14.37813  -14.378049  -0.696403  -0.683866  -0.2208    -0.202704  -0.202704  -0.193478  -0.193478  -0.173528   0.515134   0.61833    0.703009   0.72886
   0.72886    0.783801   0.783801   0.95039    2.154656   2.154667   2.154692   2.154703   2.154717   2.154717   2.154888   2.154888   2.156793   2.161813]
nelec by numeric integration = 14.00000158261987
    CPU time for vxc      1.02 sec, wall time      0.02 sec
E1 = -163.58413648053698  Ecoul = 59.16512329213362  Exc = -12.831741760708466
cycle= 1 E= -108.607527170752  delta_E= -0.142  |g|= 0.24  |ddm|= 1.63
    CPU time for cycle= 1      1.32 sec, wall time      0.03 sec
  HOMO = -0.327326899824258  LUMO = -0.278081609303087
  mo_energy =
[-14.680509 -14.680455  -0.805404  -0.793576  -0.342165  -0.327327  -0.327327  -0.278082  -0.278082  -0.259104   0.445099   0.549315   0.61773    0.643359
   0.643359   0.699352   0.699352   0.869908   2.048101   2.048135   2.04879    2.048824   2.049017   2.049017   2.050294   2.050294   2.051446   2.058059]
nelec by numeric integration = 13.999995522465753
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -164.98696189796925  Ecoul = 60.793666614827146  Exc = -13.067427978609981
cycle= 2 E= -108.617495483392  delta_E= -0.00997  |g|= 0.149  |ddm|= 0.442
    CPU time for cycle= 2      1.03 sec, wall time      0.02 sec
  HOMO = -0.28310246954964  LUMO = -0.232854238185035
  mo_energy =
[-14.556173 -14.556117  -0.760298  -0.747676  -0.299483  -0.283102  -0.283102  -0.232854  -0.232854  -0.212654   0.473553   0.578269   0.65311    0.678719
   0.678719   0.734464   0.734464   0.903829   2.092653   2.092688   2.093345   2.093379   2.093383   2.093383   2.094663   2.094663   2.095719   2.102281]
nelec by numeric integration = 13.999997954027114
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -164.4544457249147  Ecoul = 60.16330209853583  Exc = -12.976056901353243
cycle= 3 E= -108.623972749372  delta_E= -0.00648  |g|= 0.000764  |ddm|= 0.169
    CPU time for cycle= 3      0.99 sec, wall time      0.02 sec
  HOMO = -0.282997632661619  LUMO = -0.232701252868992
  mo_energy =
[-14.555947 -14.555891  -0.760222  -0.747577  -0.299371  -0.282998  -0.282998  -0.232701  -0.232701  -0.212397   0.473709   0.578434   0.653325   0.678951
   0.678951   0.734668   0.734668   0.904054   2.092866   2.0929     2.093558   2.093585   2.093585   2.093592   2.094873   2.094873   2.09592    2.102495]
nelec by numeric integration = 13.999997955698678
    CPU time for vxc      0.80 sec, wall time      0.02 sec
E1 = -164.4533874191388  Ecoul = 60.16212930890522  Exc = -12.975942758489253
cycle= 4 E= -108.623973090363  delta_E= -3.41e-07  |g|= 0.000176  |ddm|= 0.00154
    CPU time for cycle= 4      0.98 sec, wall time      0.02 sec
  HOMO = -0.282998593555898  LUMO = -0.232702965251989
  mo_energy =
[-14.555931 -14.555875  -0.760225  -0.747576  -0.299371  -0.282999  -0.282999  -0.232703  -0.232703  -0.212395   0.473684   0.578446   0.653336   0.678944
   0.678944   0.734663   0.734663   0.904034   2.092862   2.092897   2.093554   2.093581   2.093581   2.093588   2.094869   2.094869   2.095916   2.102491]
nelec by numeric integration = 13.999997953978486
    CPU time for vxc      0.80 sec, wall time      0.02 sec
E1 = -164.45337286899425  Ecoul = 60.16210536408903  Exc = -12.975933370276085
cycle= 5 E= -108.623973096821  delta_E= -6.46e-09  |g|= 7.47e-06  |ddm|= 0.000113
    CPU time for cycle= 5      0.98 sec, wall time      0.02 sec
  HOMO = -0.28299630668635  LUMO = -0.232701956713739
  mo_energy =
[-14.555922 -14.555866  -0.760223  -0.747574  -0.299367  -0.282996  -0.282996  -0.232702  -0.232702  -0.212393   0.473684   0.578443   0.653334   0.678941
   0.678941   0.734662   0.734662   0.904035   2.092862   2.092896   2.093554   2.093581   2.093581   2.093588   2.094868   2.094868   2.095916   2.102491]
nelec by numeric integration = 13.99999795407533
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -164.4533569174932  Ecoul = 60.16208665373768  Exc = -12.975930611402388
cycle= 6 E= -108.623973096798  delta_E= 2.34e-11  |g|= 1.52e-05  |ddm|= 1.04e-05
    CPU time for cycle= 6      0.99 sec, wall time      0.02 sec
  HOMO = -0.282996512029137  LUMO = -0.23270212438335
  mo_energy =
[-14.555923 -14.555865  -0.760223  -0.747574  -0.299368  -0.282997  -0.282997  -0.232702  -0.232702  -0.212393   0.473684   0.578443   0.653334   0.678941
   0.678941   0.734662   0.734662   0.904035   2.092862   2.092896   2.093554   2.093581   2.093581   2.093588   2.094868   2.094868   2.095916   2.102491]
nelec by numeric integration = 13.999997954065588
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -164.45335890521721  Ecoul = 60.162089042899105  Exc = -12.975930942686983
Extra cycle  E= -108.623973026645  delta_E= 7.02e-08  |g|= 0.000644  |ddm|= 0.000233
    CPU time for scf_cycle     10.60 sec, wall time      0.27 sec
    CPU time for SCF     10.61 sec, wall time      0.27 sec
converged SCF energy = -108.623973026645
             #0      #1      #2      #3      #4      #5     
  0 N 1s       0.782   0.607   0.219  -0.223                
  0 N 2s                       0.474  -0.485                
  0 N 3s                       0.296  -0.294                
  0 N 2px                                              0.414
  0 N 2py                                             -0.196
  0 N 2pz                                      0.442        
  0 N 3px                                             -0.313
  0 N 3py                                              0.148
  0 N 3pz                                     -0.344        
  1 N 1s      -0.607   0.782   0.219   0.223                
  1 N 2s                       0.474   0.486                
  1 N 3s                       0.296   0.295                
  1 N 2px                                              0.414
  1 N 2py                                             -0.196
  1 N 2pz                                     -0.442        
  1 N 3px                                             -0.313
  1 N 3py                                              0.148
  1 N 3pz                                      0.343        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                       0.201   0.200
  0 N 2s                                       1.042   1.076
  0 N 3s                                      -1.008  -1.093
  0 N 2px      0.196   0.246  -0.398                        
  0 N 2py      0.414  -0.398  -0.246                        
  0 N 2pz                              0.482  -0.235   0.260
  0 N 3px     -0.148  -0.180   0.292                        
  0 N 3py     -0.313   0.292   0.180                        
  0 N 3pz                             -0.346  -0.173   0.246
  1 N 1s                                       0.201  -0.200
  1 N 2s                                       1.042  -1.076
  1 N 3s                                      -1.007   1.093
  1 N 2px      0.196  -0.246   0.398                        
  1 N 2py      0.414   0.398   0.246                        
  1 N 2pz                              0.482   0.235   0.260
  1 N 3px     -0.148   0.180  -0.292                        
  1 N 3py     -0.313  -0.292  -0.180                        
  1 N 3pz                             -0.346   0.173   0.246
[-14.555923 -14.555865  -0.760223  -0.747574  -0.299368  -0.282997  -0.282997  -0.232702  -0.232702  -0.212393   0.473684   0.578443]
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 13.999997954065586
    CPU time for vxc      0.80 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 1.61  e= [0.221326]  max|de|= 0.221  lindep= 0.985
davidson 1 2  |r|= 0.965  e= [0.077788]  max|de|= -0.144  lindep= 0.733
davidson 2 3  |r|= 0.28  e= [-0.124198]  max|de|= -0.202  lindep= 0.68
davidson 3 4  |r|= 0.156  e= [-0.158214]  max|de|= -0.034  lindep= 0.827
davidson 4 5  |r|= 0.0391  e= [-0.162741]  max|de|= -0.00453  lindep= 0.756
davidson 5 6  |r|= 0.0431  e= [-0.163774]  max|de|= -0.00103  lindep= 0.752
davidson 6 7  |r|= 0.0192  e= [-0.164389]  max|de|= -0.000616  lindep= 0.671
davidson 7 8  |r|= 0.0131  e= [-0.164604]  max|de|= -0.000215  lindep= 0.813
root 0 converged  |r|= 0.0049  e= -0.1646528820626045  max|de|= -4.86e-05
converged 8 9  |r|= 0.0049  e= [-0.164653]  max|de|= -4.86e-05
RHF/RKS wavefunction has an internal instability




******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmp1miwhoev
max_memory 4000 MB (current use 250 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2b8e2e583830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2b8e2e583cb0>
******** <class 'pyscf.dft.rks.RKS'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmp1miwhoev
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 250 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.284382391114722  LUMO = -0.199682039319011
Initial guess E= -108.655514448498  |g|= 0.11685
macro= 0  E= -108.660372382154  delta_E= -0.00485793  |g|= 0.0125791  3 KF 10 JK
macro= 1  E= -108.660389311523  delta_E= -1.69294e-05  |g|= 4.35043e-05  3 KF 17 JK
macro= 2  E= -108.660389311524  delta_E= -5.68434e-13  |g|= 8.07494e-06  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 3  E=-108.660389311524  |g|= 8.07494e-06  total 8 KF 33 JK
converged SCF energy = -108.660389311524
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 13.999997618339656
    CPU time for vxc      0.81 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 2.07  e= [0.874563]  max|de|= 0.875  lindep= 0.981
davidson 1 2  |r|= 1.38  e= [0.315175]  max|de|= -0.559  lindep= 0.361
davidson 2 3  |r|=  0.2  e= [0.053815]  max|de|= -0.261  lindep= 0.982
davidson 3 4  |r|= 0.156  e= [0.03776]  max|de|= -0.0161  lindep= 0.585
davidson 4 5  |r|= 0.187  e= [0.017427]  max|de|= -0.0203  lindep= 0.832
davidson 5 6  |r|= 0.0782  e= [0.005513]  max|de|= -0.0119  lindep= 0.536
davidson 6 7  |r|= 0.05  e= [0.002267]  max|de|= -0.00325  lindep= 0.813
davidson 7 8  |r|= 0.02  e= [0.001637]  max|de|= -0.00063  lindep= 0.67
davidson 8 9  |r|= 0.0189  e= [0.001283]  max|de|= -0.000353  lindep= 0.874
davidson 9 10  |r|= 0.012  e= [0.001147]  max|de|= -0.000136  lindep= 0.679
davidson 10 11  |r|= 0.0294  e= [0.000938]  max|de|= -0.000209  lindep= 0.569
davidson 11 12  |r|= 0.0256  e= [0.00007]  max|de|= -0.000868  lindep= 0.86
davidson 12 1  |r|= 0.0256  e= [0.00007]  max|de|= 2.39e-16  lindep= 0.999
root 0 converged  |r|= 0.00873  e= 1.3379382954164787e-05  max|de|= -5.7e-05
converged 13 2  |r|= 0.00873  e= [0.000013]  max|de|= -5.7e-05
RHF/RKS wavefunction is stable in the internal stability analysis
             #0      #1      #2      #3      #4      #5     
  0 N 1s       0.677   0.723   0.219   0.222                
  0 N 2s                       0.470   0.481                
  0 N 3s                       0.299   0.299                
  0 N 2px                                      0.175   0.461
  0 N 2py                                     -0.105  -0.427
  0 N 3px                                     -0.134  -0.332
  0 N 3py                                              0.312
  1 N 1s      -0.723   0.677   0.219  -0.222                
  1 N 2s                       0.470  -0.481                
  1 N 3s                       0.299  -0.299                
  1 N 2px                                      0.427  -0.105
  1 N 2py                                      0.461  -0.175
  1 N 3px                                     -0.312        
  1 N 3py                                     -0.332   0.134
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                      -0.202  -0.201
  0 N 2s                                      -1.042  -1.078
  0 N 3s                                       1.005   1.092
  0 N 2px                     -0.178  -0.385                
  0 N 2py                     -0.120  -0.460                
  0 N 2pz     -0.439   0.479                   0.239  -0.261
  0 N 3px                      0.133   0.310                
  0 N 3py                      0.104   0.364                
  0 N 3pz      0.347  -0.350                   0.174  -0.245
  1 N 1s                                      -0.202   0.201
  1 N 2s                                      -1.042   1.078
  1 N 3s                                       1.005  -1.092
  1 N 2px                      0.460  -0.120                
  1 N 2py                     -0.385   0.178                
  1 N 2pz      0.439   0.479                  -0.239  -0.261
  1 N 3px                     -0.364   0.104                
  1 N 3py                      0.310  -0.133                
  1 N 3pz     -0.347  -0.350                  -0.174  -0.245
[-14.538801 -14.538733  -0.74776   -0.736196  -0.293329  -0.293326  -0.291447  -0.203874  -0.198178  -0.198175   0.48026    0.585504]
scan 3.00, -108.660389
#INFO: **** input file is /share/home/srwang/pyAutoMR/examples/guess/N2-RKS.py ****
from pyscf import gto, dft
from automr import guess, dump_mat
import numpy as np
#mf=guess.from_fch_simp("v2.fchk", xc='pbe0')

#mf2.verbose=9
#mf2.stability()
for r in np.arange(3.0, 9.0, 0.25):
    mol = gto.Mole(atom='''N 0.0 0.0 0.0; N 0.0 0.0 %f'''%r, basis='def2-svp', verbose=5).build()
    mf = dft.RKS(mol)
    mf.xc = 'pbe0'
    mf.kernel()
    dump_mat.dump_mo(mol, mf.mo_coeff[:,:12])
    print(mf.mo_energy[:12])
    
    mf2 = guess.check_stab(mf, newton=True, res=True)
    dump_mat.dump_mo(mol, mf2.mo_coeff[:,:12])
    print(mf2.mo_energy[:12])
    print('scan %.2f, %.6f' % (r, mf2.e_tot))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='xc06n05', release='3.10.0-1127.el7.x86_64', version='#1 SMP Tue Feb 18 16:39:12 EST 2020', machine='x86_64', processor='x86_64')  Threads 48
Python 3.7.4 (default, Aug 13 2019, 20:35:49) 
[GCC 7.3.0]
numpy 1.17.2  scipy 1.4.1
Date: Thu Sep 16 17:43:52 2021
PySCF version 1.7.6a1
PySCF path  /share/home/srwang/pyscf/pyscf
GIT ORIG_HEAD 80f71dfe77ac5f9caae26788acf76446987635bd
GIT HEAD      ref: refs/heads/master
GIT master branch  80f71dfe77ac5f9caae26788acf76446987635bd

[ENV] PYSCF_EXT_PATH /share/home/srwang/pyscf_ext/fciqmc:
[CONFIG] conf_file /share/home/srwang/.pyscf_conf.py
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 2
[INPUT] num. electrons = 14
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 N      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 N      0.000000000000   0.000000000000   3.250000000000 AA    0.000000000000   0.000000000000   6.141609904836 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] N
[INPUT] 0    0    [5    /1   ]  1712.8415853      -0.0053934125305
                                257.64812677      -0.040221581118
                                58.458245853      -0.1793114499
                                16.198367905      -0.46376317823
                                5.0052600809      -0.44171422662
[INPUT] 0    0    [1    /1   ]  0.58731856571        1
[INPUT] 0    0    [1    /1   ]  0.18764592253        1
[INPUT] 1    0    [3    /1   ]  13.571470233      -0.040072398852
                                2.9257372874      -0.21807045028
                                0.79927750754     -0.51294466049
[INPUT] 1    0    [1    /1   ]  0.21954348034        1
[INPUT] 2    0    [1    /1   ]  1                    1

nuclear repulsion = 7.97836410310154
number of shells = 12
number of NR pGTOs = 48
number of NR cGTOs = 28
basis = def2-svp
ecp = {}
CPU time:        38.67


******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpszdq5en8
max_memory 4000 MB (current use 250 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2b8e2e583830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2b8e2e583cb0>
Set gradient conv threshold to 3.16228e-05
atom N rad-grids = 75, ang-grids = [ 50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  86  86  86  86  86  86  86  86  86 266 266 266 266 266 266 266
 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266]
tot grids = 28092
Drop grids 3482
    CPU time for setting up grids      0.26 sec, wall time      0.01 sec
nelec by numeric integration = 13.992077329194444
    CPU time for vxc      0.83 sec, wall time      0.02 sec
E1 = -164.25019747591892  Ecoul = 60.92200730011983  Exc = -13.114419869151543
init E= -108.464245941849
cond(S) = 11.259491189241118
    CPU time for initialize scf      1.76 sec, wall time      0.04 sec
  HOMO = -0.200880437882069  LUMO = -0.19539981761975
  mo_energy =
[-14.378419 -14.378356  -0.693648  -0.686509  -0.214125  -0.20088   -0.20088   -0.1954    -0.1954    -0.181839   0.521899   0.610856   0.69986    0.737662
   0.737662   0.773658   0.773658   0.897715   2.154568   2.154568   2.154576   2.15458    2.154607   2.154607   2.154636   2.15464    2.155365   2.156282]
nelec by numeric integration = 13.999969385197009
    CPU time for vxc      0.84 sec, wall time      0.02 sec
E1 = -162.30216671247624  Ecoul = 58.57491864757393  Exc = -12.836686995455374
cycle= 1 E= -108.585570957256  delta_E= -0.121  |g|= 0.231  |ddm|= 1.64
    CPU time for cycle= 1      1.03 sec, wall time      0.02 sec
  HOMO = -0.320977908952253  LUMO = -0.277531901101762
  mo_energy =
[-14.670736 -14.670695  -0.799615  -0.792209  -0.331515  -0.320978  -0.320978  -0.277532  -0.277532  -0.264393   0.455055   0.545028   0.617886   0.654981
   0.654981   0.691643   0.691643   0.818702   2.051691   2.051749   2.05206    2.05206    2.052235   2.052293   2.052955   2.052955   2.053048   2.055069]
nelec by numeric integration = 13.99996680720312
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -163.65777158269975  Ecoul = 60.14954595040668  Exc = -13.064892495477618
cycle= 2 E= -108.594754024669  delta_E= -0.00918  |g|= 0.144  |ddm|= 0.428
    CPU time for cycle= 2      0.99 sec, wall time      0.02 sec
  HOMO = -0.278194703465071  LUMO = -0.234106026583758
  mo_energy =
[-14.550794 -14.550752  -0.755955  -0.748063  -0.290091  -0.278195  -0.278195  -0.234106  -0.234106  -0.220087   0.482247   0.572478   0.651799   0.689138
   0.689138   0.725634   0.725634   0.851837   2.094673   2.094732   2.094929   2.094929   2.095219   2.095278   2.095828   2.095828   2.095855   2.097862]
nelec by numeric integration = 13.99996779375935
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -163.1411802716412  Ecoul = 59.53822103239291  Exc = -12.976211001563524
cycle= 3 E= -108.60080613771  delta_E= -0.00605  |g|= 0.000645  |ddm|= 0.165
    CPU time for cycle= 3      0.98 sec, wall time      0.02 sec
  HOMO = -0.278128764978422  LUMO = -0.234000436428925
  mo_energy =
[-14.550657 -14.550614  -0.755927  -0.748014  -0.29002   -0.278129  -0.278129  -0.234     -0.234     -0.219907   0.482352   0.572622   0.651991   0.689323
   0.689323   0.725794   0.725794   0.852      2.094834   2.094894   2.09508    2.09508    2.095381   2.09544    2.095984   2.095984   2.096003   2.098018]
nelec by numeric integration = 13.999967787361474
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -163.14059289886538  Ecoul = 59.53758283048903  Exc = -12.976160386132271
cycle= 4 E= -108.600806351407  delta_E= -2.14e-07  |g|= 7.29e-05  |ddm|= 0.00126
    CPU time for cycle= 4      0.98 sec, wall time      0.02 sec
  HOMO = -0.278126738895003  LUMO = -0.234000201891364
  mo_energy =
[-14.550638 -14.550596  -0.755926  -0.748012  -0.290016  -0.278127  -0.278127  -0.234     -0.234     -0.219905   0.482339   0.572623   0.651993   0.689317
   0.689317   0.72579    0.72579    0.851991   2.094832   2.094891   2.095077   2.095077   2.095378   2.095437   2.095981   2.095981   2.096      2.098015]
nelec by numeric integration = 13.999967786838212
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -163.14056424651565  Ecoul = 59.53754657482289  Exc = -12.976152783918202
cycle= 5 E= -108.600806352509  delta_E= -1.1e-09  |g|= 8.55e-06  |ddm|= 5e-05
    CPU time for cycle= 5      0.99 sec, wall time      0.02 sec
  HOMO = -0.278125326238343  LUMO = -0.233999639170164
  mo_energy =
[-14.550633 -14.55059   -0.755925  -0.748011  -0.290014  -0.278125  -0.278125  -0.234     -0.234     -0.219903   0.482339   0.572621   0.651991   0.689315
   0.689315   0.725789   0.725789   0.851991   2.094831   2.09489    2.095076   2.095076   2.095377   2.095436   2.09598    2.09598    2.095999   2.098015]
nelec by numeric integration = 13.99996778689067
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -163.14055218423624  Ecoul = 59.53753252269911  Exc = -12.97615078834385
cycle= 6 E= -108.600806346779  delta_E= 5.73e-09  |g|= 0.000187  |ddm|= 6.55e-05
    CPU time for cycle= 6      0.99 sec, wall time      0.02 sec
  HOMO = -0.278125305582803  LUMO = -0.233999631657494
  mo_energy =
[-14.550632 -14.55059   -0.755925  -0.748011  -0.290014  -0.278125  -0.278125  -0.234     -0.234     -0.219903   0.482339   0.572621   0.651991   0.689315
   0.689315   0.725789   0.725789   0.851991   2.094831   2.09489    2.095076   2.095076   2.095377   2.095436   2.09598    2.09598    2.095999   2.098015]
nelec by numeric integration = 13.999967786891478
    CPU time for vxc      1.11 sec, wall time      0.02 sec
E1 = -163.14055201076792  Ecoul = 59.53753231399007  Exc = -12.97615075885048
cycle= 7 E= -108.600806352527  delta_E= -5.75e-09  |g|= 7.82e-07  |ddm|= 6.4e-05
    CPU time for cycle= 7      1.75 sec, wall time      0.04 sec
  HOMO = -0.278125411725803  LUMO = -0.233999709647951
  mo_energy =
[-14.550633 -14.550591  -0.755925  -0.748011  -0.290014  -0.278125  -0.278125  -0.234     -0.234     -0.219903   0.482339   0.572621   0.651991   0.689315
   0.689315   0.725789   0.725789   0.851991   2.094831   2.09489    2.095076   2.095076   2.095377   2.095436   2.09598    2.09598    2.095999   2.098015]
nelec by numeric integration = 13.999967786888979
    CPU time for vxc      0.88 sec, wall time      0.02 sec
E1 = -163.14055306623936  Ecoul = 59.5375335363323  Exc = -12.976150925721411
cycle= 8 E= -108.600806352527  delta_E= -1.56e-13  |g|= 2.16e-08  |ddm|= 4.94e-07
    CPU time for cycle= 8      1.24 sec, wall time      0.03 sec
  HOMO = -0.278125416920617  LUMO = -0.233999713122971
  mo_energy =
[-14.550633 -14.550591  -0.755925  -0.748011  -0.290014  -0.278125  -0.278125  -0.234     -0.234     -0.219903   0.482339   0.572621   0.651991   0.689315
   0.689315   0.725789   0.725789   0.851991   2.094831   2.09489    2.095076   2.095076   2.095377   2.095436   2.09598    2.09598    2.095999   2.098015]
nelec by numeric integration = 13.99996778688901
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -163.14055311509327  Ecoul = 59.53753359404129  Exc = -12.976150934576399
Extra cycle  E= -108.600806352527  delta_E= 1.14e-13  |g|= 8.48e-09  |ddm|= 2.4e-08
    CPU time for scf_cycle     11.69 sec, wall time      0.24 sec
    CPU time for SCF     11.72 sec, wall time      0.24 sec
converged SCF energy = -108.600806352527
             #0      #1      #2      #3      #4      #5     
  0 N 1s      -0.700   0.700   0.220   0.222                
  0 N 2s                       0.475   0.483                
  0 N 3s                       0.298   0.295                
  0 N 2px                                              0.352
  0 N 2py                                              0.294
  0 N 2pz                                     -0.444        
  0 N 3px                                             -0.267
  0 N 3py                                             -0.223
  0 N 3pz                                      0.350        
  1 N 1s       0.700   0.700   0.220  -0.222                
  1 N 2s                       0.475  -0.483                
  1 N 3s                       0.298  -0.295                
  1 N 2px                                              0.352
  1 N 2py                                              0.294
  1 N 2pz                                      0.444        
  1 N 3px                                             -0.267
  1 N 3py                                             -0.223
  1 N 3pz                                     -0.350        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                       0.202  -0.205
  0 N 2s                                       1.052  -1.099
  0 N 3s                                      -1.030   1.111
  0 N 2px     -0.294   0.423   0.191                        
  0 N 2py      0.352  -0.191   0.423                        
  0 N 2pz                              0.477  -0.232  -0.218
  0 N 3px      0.223  -0.314  -0.142                        
  0 N 3py     -0.267   0.142  -0.314                        
  0 N 3pz                             -0.343  -0.191  -0.207
  1 N 1s                                       0.202   0.205
  1 N 2s                                       1.052   1.099
  1 N 3s                                      -1.030  -1.111
  1 N 2px     -0.294  -0.423  -0.191                        
  1 N 2py      0.352   0.191  -0.423                        
  1 N 2pz                              0.477   0.232  -0.218
  1 N 3px      0.223   0.314   0.142                        
  1 N 3py     -0.267  -0.142   0.314                        
  1 N 3pz                             -0.343   0.191  -0.207
[-14.550633 -14.550591  -0.755925  -0.748011  -0.290014  -0.278125  -0.278125  -0.234     -0.234     -0.219903   0.482339   0.572621]
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 13.999967786889007
    CPU time for vxc      0.80 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 1.01  e= [0.047689]  max|de|= 0.0477  lindep= 0.998
davidson 1 2  |r|= 0.79  e= [0.010849]  max|de|= -0.0368  lindep= 0.824
davidson 2 3  |r|= 0.288  e= [-0.145435]  max|de|= -0.156  lindep= 0.606
davidson 3 4  |r|= 0.146  e= [-0.176124]  max|de|= -0.0307  lindep= 0.905
davidson 4 5  |r|= 0.0553  e= [-0.181044]  max|de|= -0.00492  lindep= 0.651
davidson 5 6  |r|= 0.0933  e= [-0.185593]  max|de|= -0.00455  lindep= 0.846
davidson 6 7  |r|= 0.0256  e= [-0.187527]  max|de|= -0.00193  lindep= 0.721
davidson 7 8  |r|= 0.012  e= [-0.18778]  max|de|= -0.000253  lindep= 0.812
root 0 converged  |r|= 0.00602  e= -0.18782333389338612  max|de|= -4.31e-05
converged 8 9  |r|= 0.00602  e= [-0.187823]  max|de|= -4.31e-05
RHF/RKS wavefunction has an internal instability




******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpszdq5en8
max_memory 4000 MB (current use 257 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2b8e2e583830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2b8e2e583cb0>
******** <class 'pyscf.dft.rks.RKS'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpszdq5en8
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 257 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.278360390006798  LUMO = -0.207951424385488
Initial guess E= -108.617055203475  |g|= 0.276416
macro= 0  E= -108.644352314537  delta_E= -0.0272971  |g|= 0.276416  2 KF 5 JK
macro= 1  E= -108.64532679223  delta_E= -0.000974478  |g|= 0.00521463  3 KF 12 JK
macro= 2  E= -108.64544703397  delta_E= -0.000120242  |g|= 0.00328911  2 KF 8 JK
macro= 3  E= -108.645455699573  delta_E= -8.6656e-06  |g|= 7.01765e-05  3 KF 17 JK
macro= 4  E= -108.645455699574  delta_E= -4.12115e-13  |g|= 1.08667e-05  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 5  E=-108.645455699574  |g|= 1.08667e-05  total 12 KF 50 JK
converged SCF energy = -108.645455699574
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 13.999967856097635
    CPU time for vxc      0.83 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 1.83  e= [0.73731]  max|de|= 0.737  lindep= 0.972
davidson 1 2  |r|= 1.25  e= [0.291488]  max|de|= -0.446  lindep= 0.442
davidson 2 3  |r|= 0.52  e= [0.105397]  max|de|= -0.186  lindep= 0.563
davidson 3 4  |r|= 0.0867  e= [0.058145]  max|de|= -0.0473  lindep= 0.806
davidson 4 5  |r|= 0.148  e= [0.0499]  max|de|= -0.00825  lindep= 0.749
davidson 5 6  |r|= 0.188  e= [0.027905]  max|de|= -0.022  lindep= 0.689
davidson 6 7  |r|= 0.105  e= [0.013479]  max|de|= -0.0144  lindep= 0.779
davidson 7 8  |r|= 0.055  e= [0.009186]  max|de|= -0.00429  lindep= 0.581
davidson 8 9  |r|= 0.0776  e= [0.005778]  max|de|= -0.00341  lindep= 0.728
davidson 9 10  |r|= 0.0224  e= [0.004303]  max|de|= -0.00148  lindep= 0.707
root 0 converged  |r|= 0.00432  e= 0.00420284314150338  max|de|= -9.98e-05
converged 10 11  |r|= 0.00432  e= [0.004203]  max|de|= -9.98e-05
RHF/RKS wavefunction is stable in the internal stability analysis
             #0      #1      #2      #3      #4      #5     
  0 N 1s       0.758   0.637  -0.219  -0.221                
  0 N 2s                      -0.472  -0.479                
  0 N 3s                      -0.301  -0.299                
  0 N 2px                                      0.524        
  0 N 2py                                     -0.396        
  0 N 3px                                     -0.380        
  0 N 3py                                      0.288        
  1 N 1s      -0.637   0.758  -0.219   0.222                
  1 N 2s                      -0.471   0.479                
  1 N 3s                      -0.301   0.299                
  1 N 2px                                              0.396
  1 N 2py                                              0.525
  1 N 3px                                             -0.288
  1 N 3py                                             -0.380
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                      -0.202  -0.206
  0 N 2s                                      -1.052  -1.101
  0 N 3s                                       1.028   1.110
  0 N 2px                     -0.375                        
  0 N 2py                     -0.507                        
  0 N 2pz     -0.441   0.474                   0.235  -0.218
  0 N 3px                      0.301                        
  0 N 3py                      0.405                        
  0 N 3pz      0.353  -0.346                   0.192  -0.207
  1 N 1s                                      -0.202   0.206
  1 N 2s                                      -1.052   1.101
  1 N 3s                                       1.028  -1.110
  1 N 2px                             -0.507                
  1 N 2py                              0.375                
  1 N 2pz      0.441   0.474                  -0.235  -0.218
  1 N 3px                              0.405                
  1 N 3py                             -0.301                
  1 N 3pz     -0.353  -0.346                  -0.192  -0.207
[-14.535314 -14.535262  -0.744163  -0.737274  -0.29205   -0.292045  -0.282644  -0.21213   -0.197132  -0.197127   0.488637   0.579096]
scan 3.25, -108.645456
#INFO: **** input file is /share/home/srwang/pyAutoMR/examples/guess/N2-RKS.py ****
from pyscf import gto, dft
from automr import guess, dump_mat
import numpy as np
#mf=guess.from_fch_simp("v2.fchk", xc='pbe0')

#mf2.verbose=9
#mf2.stability()
for r in np.arange(3.0, 9.0, 0.25):
    mol = gto.Mole(atom='''N 0.0 0.0 0.0; N 0.0 0.0 %f'''%r, basis='def2-svp', verbose=5).build()
    mf = dft.RKS(mol)
    mf.xc = 'pbe0'
    mf.kernel()
    dump_mat.dump_mo(mol, mf.mo_coeff[:,:12])
    print(mf.mo_energy[:12])
    
    mf2 = guess.check_stab(mf, newton=True, res=True)
    dump_mat.dump_mo(mol, mf2.mo_coeff[:,:12])
    print(mf2.mo_energy[:12])
    print('scan %.2f, %.6f' % (r, mf2.e_tot))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='xc06n05', release='3.10.0-1127.el7.x86_64', version='#1 SMP Tue Feb 18 16:39:12 EST 2020', machine='x86_64', processor='x86_64')  Threads 48
Python 3.7.4 (default, Aug 13 2019, 20:35:49) 
[GCC 7.3.0]
numpy 1.17.2  scipy 1.4.1
Date: Thu Sep 16 17:43:53 2021
PySCF version 1.7.6a1
PySCF path  /share/home/srwang/pyscf/pyscf
GIT ORIG_HEAD 80f71dfe77ac5f9caae26788acf76446987635bd
GIT HEAD      ref: refs/heads/master
GIT master branch  80f71dfe77ac5f9caae26788acf76446987635bd

[ENV] PYSCF_EXT_PATH /share/home/srwang/pyscf_ext/fciqmc:
[CONFIG] conf_file /share/home/srwang/.pyscf_conf.py
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 2
[INPUT] num. electrons = 14
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 N      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 N      0.000000000000   0.000000000000   3.500000000000 AA    0.000000000000   0.000000000000   6.614041435978 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] N
[INPUT] 0    0    [5    /1   ]  1712.8415853      -0.0053934125305
                                257.64812677      -0.040221581118
                                58.458245853      -0.1793114499
                                16.198367905      -0.46376317823
                                5.0052600809      -0.44171422662
[INPUT] 0    0    [1    /1   ]  0.58731856571        1
[INPUT] 0    0    [1    /1   ]  0.18764592253        1
[INPUT] 1    0    [3    /1   ]  13.571470233      -0.040072398852
                                2.9257372874      -0.21807045028
                                0.79927750754     -0.51294466049
[INPUT] 1    0    [1    /1   ]  0.21954348034        1
[INPUT] 2    0    [1    /1   ]  1                    1

nuclear repulsion = 7.40848095288
number of shells = 12
number of NR pGTOs = 48
number of NR cGTOs = 28
basis = def2-svp
ecp = {}
CPU time:        91.64


******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmp5_ilo6xo
max_memory 4000 MB (current use 257 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2b8e2e583830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2b8e2e583cb0>
Set gradient conv threshold to 3.16228e-05
atom N rad-grids = 75, ang-grids = [ 50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  86  86  86  86  86  86  86  86  86 266 266 266 266 266 266 266
 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266]
tot grids = 28092
Drop grids 3456
    CPU time for setting up grids      0.26 sec, wall time      0.01 sec
nelec by numeric integration = 13.992016193306966
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -163.10833527528314  Ecoul = 60.350087459339164  Exc = -13.113795145057411
init E= -108.463562008121
cond(S) = 10.862956349687517
    CPU time for initialize scf      1.81 sec, wall time      0.04 sec
  HOMO = -0.199790098691267  LUMO = -0.196609199288578
  mo_energy =
[-14.378701 -14.378658  -0.692123  -0.688076  -0.20912   -0.19979   -0.19979   -0.196609  -0.196609  -0.18746    0.536143   0.603314   0.70494    0.744414
   0.744414   0.766286   0.766286   0.850951   2.154464   2.154464   2.154479   2.154479   2.154501   2.154503   2.154566   2.154568   2.154765   2.154923]
nelec by numeric integration = 13.999954254769774
    CPU time for vxc      0.83 sec, wall time      0.02 sec
E1 = -161.21621632089762  Ecoul = 58.081524580198845  Exc = -12.843618812743765
cycle= 1 E= -108.569829600563  delta_E= -0.106  |g|= 0.222  |ddm|= 1.65
    CPU time for cycle= 1      1.11 sec, wall time      0.02 sec
  HOMO = -0.315213374475357  LUMO = -0.276089666005491
  mo_energy =
[-14.661109 -14.661083  -0.794603  -0.789821  -0.322604  -0.315213  -0.315213  -0.27609   -0.27609   -0.267071   0.472661   0.540592   0.625654   0.664523
   0.664523   0.686828   0.686828   0.773524   2.05543    2.055482   2.055482   2.055494   2.055856   2.055868   2.055932   2.056178   2.056178   2.056834]
nelec by numeric integration = 13.999955834580623
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -162.51865756700624  Ecoul = 59.594851513976295  Exc = -13.06298183677831
cycle= 2 E= -108.578306936928  delta_E= -0.00848  |g|= 0.138  |ddm|= 0.413
    CPU time for cycle= 2      1.01 sec, wall time      0.02 sec
  HOMO = -0.274066080882109  LUMO = -0.234540042811275
  mo_energy =
[-14.545873 -14.545846  -0.752584  -0.747512  -0.282496  -0.274066  -0.274066  -0.23454   -0.23454   -0.224894   0.498483   0.566554   0.658351   0.697408
   0.697408   0.719593   0.719593   0.805718   2.096699   2.096699   2.096708   2.096772   2.097038   2.097147   2.097211   2.0974     2.0974     2.098017]
nelec by numeric integration = 13.999955142704795
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -162.02241398667695  Ecoul = 59.00792007228776  Exc = -12.977858502235518
cycle= 3 E= -108.583871463745  delta_E= -0.00556  |g|= 0.000558  |ddm|= 0.159
    CPU time for cycle= 3      0.99 sec, wall time      0.02 sec
  HOMO = -0.274010885805921  LUMO = -0.234452149140285
  mo_energy =
[-14.545761 -14.545735  -0.752571  -0.747482  -0.282436  -0.274011  -0.274011  -0.234452  -0.234452  -0.224756   0.498567   0.566682   0.658533   0.697571
   0.697571   0.719732   0.719732   0.805852   2.096828   2.096828   2.096846   2.09691    2.097165   2.097285   2.09735    2.097533   2.097533   2.098149]
nelec by numeric integration = 13.99995513913605
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -162.02201166611633  Ecoul = 59.007489182716604  Exc = -12.97783006681257
cycle= 4 E= -108.583871597332  delta_E= -1.34e-07  |g|= 1.67e-05  |ddm|= 0.001
    CPU time for cycle= 4      0.99 sec, wall time      0.02 sec
  HOMO = -0.274006779276975  LUMO = -0.234450660082992
  mo_energy =
[-14.545739 -14.545712  -0.752567  -0.747478  -0.28243   -0.274007  -0.274007  -0.234451  -0.234451  -0.224753   0.498562   0.566676   0.658528   0.697564
   0.697564   0.719727   0.719727   0.805849   2.096825   2.096825   2.096842   2.096907   2.097162   2.097282   2.097346   2.09753    2.09753    2.098146]
nelec by numeric integration = 13.999955139068385
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -162.02196431710644  Ecoul = 59.00743331838183  Exc = -12.977821551533642
cycle= 5 E= -108.583871597378  delta_E= -4.6e-11  |g|= 1.23e-05  |ddm|= 2.02e-05
    CPU time for cycle= 5      0.99 sec, wall time      0.02 sec
  HOMO = -0.274007109244049  LUMO = -0.234450944118267
  mo_energy =
[-14.545741 -14.545712  -0.752567  -0.747479  -0.282431  -0.274007  -0.274007  -0.234451  -0.234451  -0.224753   0.498562   0.566676   0.658527   0.697564
   0.697564   0.719727   0.719727   0.805849   2.096825   2.096825   2.096842   2.096906   2.097162   2.097282   2.097346   2.097529   2.097529   2.098146]
nelec by numeric integration = 13.999955139075457
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -162.02196844711057  Ecoul = 59.00743824696923  Exc = -12.977822265149582
Extra cycle  E= -108.583871512411  delta_E= 8.5e-08  |g|= 0.000725  |ddm|= 0.000245
    CPU time for scf_cycle      7.88 sec, wall time      0.16 sec
    CPU time for SCF      7.90 sec, wall time      0.16 sec
converged SCF energy = -108.583871512411
             #0      #1      #2      #3      #4      #5     
  0 N 1s       0.827   0.545   0.220  -0.221                
  0 N 2s                       0.475  -0.480                
  0 N 3s                       0.299  -0.296                
  0 N 2px                                              0.363
  0 N 2py                                              0.280
  0 N 2pz                                      0.447        
  0 N 3px                                             -0.276
  0 N 3py                                             -0.213
  0 N 3pz                                     -0.353        
  1 N 1s      -0.545   0.827   0.220   0.222                
  1 N 2s                       0.475   0.481                
  1 N 3s                       0.299   0.296                
  1 N 2px                                              0.363
  1 N 2py                                              0.280
  1 N 2pz                                     -0.447        
  1 N 3px                                             -0.276
  1 N 3py                                             -0.213
  1 N 3pz                                      0.353        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                       0.206   0.210
  0 N 2s                                       1.081   1.119
  0 N 3s                                      -1.068  -1.127
  0 N 2px     -0.280  -0.368  -0.280                        
  0 N 2py      0.363   0.280  -0.368                        
  0 N 2pz                              0.472  -0.196   0.170
  0 N 3px      0.213   0.275   0.210                        
  0 N 3py     -0.276  -0.210   0.275                        
  0 N 3pz                             -0.342  -0.172   0.163
  1 N 1s                                       0.206  -0.210
  1 N 2s                                       1.081  -1.119
  1 N 3s                                      -1.068   1.127
  1 N 2px     -0.280   0.368   0.280                        
  1 N 2py      0.363  -0.280   0.368                        
  1 N 2pz                              0.472   0.196   0.170
  1 N 3px      0.213  -0.275  -0.210                        
  1 N 3py     -0.276   0.210  -0.275                        
  1 N 3pz                             -0.342   0.172   0.163
[-14.545741 -14.545712  -0.752567  -0.747479  -0.282431  -0.274007  -0.274007  -0.234451  -0.234451  -0.224753   0.498562   0.566676]
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 13.999955139075455
    CPU time for vxc      0.81 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 0.813  e= [-0.004296]  max|de|= -0.0043  lindep= 0.979
davidson 1 2  |r|= 0.723  e= [-0.021127]  max|de|= -0.0168  lindep= 0.885
davidson 2 3  |r|= 0.286  e= [-0.165457]  max|de|= -0.144  lindep= 0.605
davidson 3 4  |r|= 0.131  e= [-0.192562]  max|de|= -0.0271  lindep= 0.884
davidson 4 5  |r|= 0.0466  e= [-0.196325]  max|de|= -0.00376  lindep= 0.635
davidson 5 6  |r|= 0.123  e= [-0.200549]  max|de|= -0.00422  lindep= 0.797
davidson 6 7  |r|= 0.03  e= [-0.204596]  max|de|= -0.00405  lindep= 0.797
davidson 7 8  |r|= 0.0116  e= [-0.204868]  max|de|= -0.000272  lindep= 0.791
root 0 converged  |r|= 0.00629  e= -0.20491775517004726  max|de|= -4.96e-05
converged 8 9  |r|= 0.00629  e= [-0.204918]  max|de|= -4.96e-05
RHF/RKS wavefunction has an internal instability




******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmp5_ilo6xo
max_memory 4000 MB (current use 259 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2b8e2e583830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2b8e2e583cb0>
******** <class 'pyscf.dft.rks.RKS'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmp5_ilo6xo
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 259 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.269271405309555  LUMO = -0.212136310456077
Initial guess E= -108.524542189621  |g|= 0.517114
macro= 0  E= -108.628908736891  delta_E= -0.104367  |g|= 0.0840453  3 KF 12 JK
macro= 1  E= -108.625568091725  delta_E= 0.00334065  |g|= 0.0175948  3 KF 13 JK
macro= 2  E= -108.62765059025  delta_E= -0.0020825  |g|= 0.117686  2 KF 8 JK
macro= 3  E= -108.633382131152  delta_E= -0.00573154  |g|= 0.0615892  2 KF 8 JK
macro= 4  E= -108.634319535859  delta_E= -0.000937405  |g|= 0.0130846  3 KF 9 JK
macro= 5  E= -108.634480594986  delta_E= -0.000161059  |g|= 0.00932915  2 KF 6 JK
macro= 6  E= -108.634488844748  delta_E= -8.24976e-06  |g|= 5.4415e-05  3 KF 19 JK
macro= 7  E= -108.634488844748  delta_E= -2.84217e-14  |g|= 9.52237e-06  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 8  E=-108.634488844748  |g|= 9.52237e-06  total 20 KF 86 JK
converged SCF energy = -108.634488844748
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 13.999955729361899
    CPU time for vxc      0.82 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 2.16  e= [0.926364]  max|de|= 0.926  lindep= 0.97
davidson 1 2  |r|= 1.34  e= [0.326146]  max|de|= -0.6  lindep= 0.848
davidson 2 3  |r|= 0.134  e= [0.043978]  max|de|= -0.282  lindep= 0.995
davidson 3 4  |r|= 0.0519  e= [0.039932]  max|de|= -0.00405  lindep= 0.481
davidson 4 5  |r|= 0.222  e= [0.032156]  max|de|= -0.00778  lindep= 0.728
davidson 5 6  |r|= 0.0982  e= [0.017889]  max|de|= -0.0143  lindep= 0.751
davidson 6 7  |r|= 0.0681  e= [0.013303]  max|de|= -0.00459  lindep= 0.61
davidson 7 8  |r|= 0.121  e= [0.007412]  max|de|= -0.00589  lindep= 0.505
davidson 8 9  |r|= 0.0679  e= [0.000819]  max|de|= -0.00659  lindep= 0.623
davidson 9 10  |r|= 0.0151  e= [0.000135]  max|de|= -0.000684  lindep= 0.83
root 0 converged  |r|= 0.00212  e= 0.00010235627484013618  max|de|= -3.24e-05
converged 10 11  |r|= 0.00212  e= [0.000102]  max|de|= -3.24e-05
RHF/RKS wavefunction is stable in the internal stability analysis
             #0      #1      #2      #3      #4      #5     
  0 N 1s      -0.575   0.806  -0.219  -0.221                
  0 N 2s                      -0.472  -0.478                
  0 N 3s                      -0.302  -0.300                
  0 N 2px                                             -0.472
  0 N 2py                                              0.461
  0 N 3px                                              0.344
  0 N 3py                                             -0.335
  1 N 1s       0.806   0.575  -0.220   0.221                
  1 N 2s                      -0.472   0.477                
  1 N 3s                      -0.302   0.299                
  1 N 2px                                      0.461        
  1 N 2py                                      0.472        
  1 N 3px                                     -0.335        
  1 N 3py                                     -0.344        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                       0.206  -0.210
  0 N 2s                                       1.081  -1.120
  0 N 3s                                      -1.067   1.126
  0 N 2px                              0.443                
  0 N 2py                              0.452                
  0 N 2pz      0.444  -0.470                  -0.199  -0.171
  0 N 3px                             -0.356                
  0 N 3py                             -0.364                
  0 N 3pz     -0.356   0.345                  -0.174  -0.162
  1 N 1s                                       0.206   0.210
  1 N 2s                                       1.082   1.120
  1 N 3s                                      -1.067  -1.126
  1 N 2px                      0.453                        
  1 N 2py                     -0.443                        
  1 N 2pz     -0.444  -0.470                   0.199  -0.171
  1 N 3px                     -0.364                        
  1 N 3py                      0.356                        
  1 N 3pz      0.356   0.345                   0.174  -0.162
[-14.531976 -14.53194   -0.741531  -0.73735   -0.290727  -0.29072   -0.275604  -0.217676  -0.196021  -0.196014   0.504582   0.572673]
scan 3.50, -108.634489
#INFO: **** input file is /share/home/srwang/pyAutoMR/examples/guess/N2-RKS.py ****
from pyscf import gto, dft
from automr import guess, dump_mat
import numpy as np
#mf=guess.from_fch_simp("v2.fchk", xc='pbe0')

#mf2.verbose=9
#mf2.stability()
for r in np.arange(3.0, 9.0, 0.25):
    mol = gto.Mole(atom='''N 0.0 0.0 0.0; N 0.0 0.0 %f'''%r, basis='def2-svp', verbose=5).build()
    mf = dft.RKS(mol)
    mf.xc = 'pbe0'
    mf.kernel()
    dump_mat.dump_mo(mol, mf.mo_coeff[:,:12])
    print(mf.mo_energy[:12])
    
    mf2 = guess.check_stab(mf, newton=True, res=True)
    dump_mat.dump_mo(mol, mf2.mo_coeff[:,:12])
    print(mf2.mo_energy[:12])
    print('scan %.2f, %.6f' % (r, mf2.e_tot))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='xc06n05', release='3.10.0-1127.el7.x86_64', version='#1 SMP Tue Feb 18 16:39:12 EST 2020', machine='x86_64', processor='x86_64')  Threads 48
Python 3.7.4 (default, Aug 13 2019, 20:35:49) 
[GCC 7.3.0]
numpy 1.17.2  scipy 1.4.1
Date: Thu Sep 16 17:43:54 2021
PySCF version 1.7.6a1
PySCF path  /share/home/srwang/pyscf/pyscf
GIT ORIG_HEAD 80f71dfe77ac5f9caae26788acf76446987635bd
GIT HEAD      ref: refs/heads/master
GIT master branch  80f71dfe77ac5f9caae26788acf76446987635bd

[ENV] PYSCF_EXT_PATH /share/home/srwang/pyscf_ext/fciqmc:
[CONFIG] conf_file /share/home/srwang/.pyscf_conf.py
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 2
[INPUT] num. electrons = 14
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 N      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 N      0.000000000000   0.000000000000   3.750000000000 AA    0.000000000000   0.000000000000   7.086472967119 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] N
[INPUT] 0    0    [5    /1   ]  1712.8415853      -0.0053934125305
                                257.64812677      -0.040221581118
                                58.458245853      -0.1793114499
                                16.198367905      -0.46376317823
                                5.0052600809      -0.44171422662
[INPUT] 0    0    [1    /1   ]  0.58731856571        1
[INPUT] 0    0    [1    /1   ]  0.18764592253        1
[INPUT] 1    0    [3    /1   ]  13.571470233      -0.040072398852
                                2.9257372874      -0.21807045028
                                0.79927750754     -0.51294466049
[INPUT] 1    0    [1    /1   ]  0.21954348034        1
[INPUT] 2    0    [1    /1   ]  1                    1

nuclear repulsion = 6.914582222688
number of shells = 12
number of NR pGTOs = 48
number of NR cGTOs = 28
basis = def2-svp
ecp = {}
CPU time:       153.88


******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmp3bngl4h4
max_memory 4000 MB (current use 259 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2b8e2e583830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2b8e2e583cb0>
Set gradient conv threshold to 3.16228e-05
atom N rad-grids = 75, ang-grids = [ 50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  86  86  86  86  86  86  86  86  86 266 266 266 266 266 266 266
 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266]
tot grids = 28092
Drop grids 3438
    CPU time for setting up grids      0.24 sec, wall time      0.01 sec
nelec by numeric integration = 13.991953982566791
    CPU time for vxc      0.80 sec, wall time      0.02 sec
E1 = -162.11896145802422  Ecoul = 59.854642378731924  Exc = -13.113457496074295
init E= -108.463194352679
cond(S) = 10.648667015863408
    CPU time for initialize scf      1.79 sec, wall time      0.04 sec
  HOMO = -0.199142233191045  LUMO = -0.197352029613581
  mo_energy =
[-14.378919 -14.378892  -0.691273  -0.68899   -0.205436  -0.199142  -0.199142  -0.197352  -0.197352  -0.191296   0.550743   0.596127   0.715255   0.749015
   0.749015   0.761417   0.761417   0.815243   2.154405   2.154405   2.154412   2.154412   2.154448   2.154449   2.154509   2.15451    2.154574   2.154609]
nelec by numeric integration = 13.999966107355128
    CPU time for vxc      0.83 sec, wall time      0.02 sec
E1 = -160.2794208818712  Ecoul = 57.65663257285932  Exc = -12.850248517018207
cycle= 1 E= -108.558454603342  delta_E= -0.0953  |g|= 0.214  |ddm|= 1.66
    CPU time for cycle= 1      1.11 sec, wall time      0.02 sec
  HOMO = -0.310263814289263  LUMO = -0.2744780623507
  mo_energy =
[-14.652636 -14.652622  -0.790442  -0.787239  -0.31537   -0.310264  -0.310264  -0.274478  -0.274478  -0.268358   0.490129   0.536006   0.638175   0.671616
   0.671616   0.684311   0.684311   0.739357   2.058726   2.058726   2.058812   2.058873   2.058902   2.059171   2.059231   2.059288   2.059288   2.059583]
nelec by numeric integration = 13.999969099315168
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -161.5324324748429  Ecoul = 59.11277265552081  Exc = -13.06127390228008
cycle= 2 E= -108.566351498914  delta_E= -0.0079  |g|= 0.133  |ddm|= 0.398
    CPU time for cycle= 2      1.01 sec, wall time      0.02 sec
  HOMO = -0.270656080243384  LUMO = -0.234619144927199
  mo_energy =
[-14.541689 -14.541676  -0.749969  -0.746596  -0.276479  -0.270656  -0.270656  -0.234619  -0.234619  -0.228069   0.514721   0.560704   0.669855   0.703333
   0.703333   0.715936   0.715936   0.770627   2.098404   2.098404   2.098521   2.098564   2.098581   2.09888    2.09894    2.098969   2.098969   2.099248]
nelec by numeric integration = 13.99996783593637
    CPU time for vxc      0.84 sec, wall time      0.02 sec
E1 = -161.0559267360807  Ecoul = 58.54948631197671  Exc = -12.979620623496421
cycle= 3 E= -108.571478824912  delta_E= -0.00513  |g|= 0.000497  |ddm|= 0.153
    CPU time for cycle= 3      1.01 sec, wall time      0.02 sec
  HOMO = -0.270595893552886  LUMO = -0.234531533294564
  mo_energy =
[-14.541566 -14.541553  -0.749952  -0.746565  -0.276416  -0.270596  -0.270596  -0.234532  -0.234532  -0.227948   0.514803   0.560822   0.670031   0.703488
   0.703488   0.716069   0.716069   0.770754   2.09853    2.09853    2.098653   2.098688   2.098713   2.099012   2.099073   2.099098   2.099098   2.099376]
nelec by numeric integration = 13.999967837605888
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -161.055522514456  Ecoul = 58.54904855737465  Exc = -12.979587181632034
cycle= 4 E= -108.571478916025  delta_E= -9.11e-08  |g|= 3.29e-05  |ddm|= 0.000813
    CPU time for cycle= 4      0.99 sec, wall time      0.02 sec
  HOMO = -0.270592696928134  LUMO = -0.234530303126257
  mo_energy =
[-14.541551 -14.541537  -0.749949  -0.746562  -0.276412  -0.270593  -0.270593  -0.23453   -0.23453   -0.227947   0.514801   0.560815   0.670023   0.703482
   0.703482   0.716065   0.716065   0.770753   2.098528   2.098528   2.09865    2.098685   2.098711   2.09901    2.09907    2.099096   2.099096   2.099373]
nelec by numeric integration = 13.99996783722825
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -161.05548508042673  Ecoul = 58.54900540584133  Exc = -12.979581464376793
cycle= 5 E= -108.571478916274  delta_E= -2.49e-10  |g|= 9.09e-06  |ddm|= 2.78e-05
    CPU time for cycle= 5      0.99 sec, wall time      0.02 sec
  HOMO = -0.27059199539936  LUMO = -0.234529939124987
  mo_energy =
[-14.541547 -14.541533  -0.749948  -0.746562  -0.276411  -0.270592  -0.270592  -0.23453   -0.23453   -0.227946   0.5148     0.560814   0.670023   0.703481
   0.703481   0.716064   0.716064   0.770752   2.098528   2.098528   2.09865    2.098685   2.09871    2.09901    2.09907    2.099095   2.099095   2.099373]
nelec by numeric integration = 13.999967837277232
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -161.05547488923477  Ecoul = 58.54899320776165  Exc = -12.979579434036193
Extra cycle  E= -108.571478892821  delta_E= 2.35e-08  |g|= 0.000384  |ddm|= 0.000127
    CPU time for scf_cycle      7.87 sec, wall time      0.16 sec
    CPU time for SCF      7.89 sec, wall time      0.16 sec
converged SCF energy = -108.571478892821
             #0      #1      #2      #3      #4      #5     
  0 N 1s       0.817   0.559   0.220  -0.221                
  0 N 2s                       0.475  -0.479                
  0 N 3s                       0.300  -0.297                
  0 N 2px                                              0.136
  0 N 2py                                              0.438
  0 N 2pz                                      0.450        
  0 N 3px                                             -0.103
  0 N 3py                                             -0.333
  0 N 3pz                                     -0.354        
  1 N 1s      -0.559   0.817   0.220   0.221                
  1 N 2s                       0.475   0.479                
  1 N 3s                       0.300   0.297                
  1 N 2px                                              0.136
  1 N 2py                                              0.438
  1 N 2pz                                     -0.450        
  1 N 3px                                             -0.103
  1 N 3py                                             -0.333
  1 N 3pz                                      0.354        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                       0.211   0.213
  0 N 2s                                       1.111   1.133
  0 N 3s                                      -1.104  -1.138
  0 N 2px      0.438  -0.461                                
  0 N 2py     -0.136          -0.461                        
  0 N 2pz                              0.468  -0.144   0.123
  0 N 3px     -0.333   0.347                                
  0 N 3py      0.103           0.347                        
  0 N 3pz                             -0.343  -0.131   0.117
  1 N 1s                                       0.211  -0.213
  1 N 2s                                       1.111  -1.133
  1 N 3s                                      -1.104   1.138
  1 N 2px      0.438   0.461                                
  1 N 2py     -0.136           0.461                        
  1 N 2pz                              0.468   0.144   0.122
  1 N 3px     -0.333  -0.347                                
  1 N 3py      0.103          -0.347                        
  1 N 3pz                             -0.343   0.131   0.117
[-14.541547 -14.541533  -0.749948  -0.746562  -0.276411  -0.270592  -0.270592  -0.23453   -0.23453   -0.227946   0.5148     0.560814]
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 13.999967837277227
    CPU time for vxc      0.80 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|=  2.9  e= [0.621907]  max|de|= 0.622  lindep= 0.999
davidson 1 2  |r|= 0.669  e= [-0.053523]  max|de|= -0.675  lindep= 0.914
davidson 2 3  |r|= 0.256  e= [-0.186477]  max|de|= -0.133  lindep= 0.616
davidson 3 4  |r|= 0.104  e= [-0.205227]  max|de|= -0.0187  lindep= 0.897
davidson 4 5  |r|= 0.0466  e= [-0.207788]  max|de|= -0.00256  lindep= 0.564
davidson 5 6  |r|= 0.149  e= [-0.212868]  max|de|= -0.00508  lindep= 0.767
davidson 6 7  |r|= 0.0279  e= [-0.218017]  max|de|= -0.00515  lindep= 0.929
root 0 converged  |r|= 0.00278  e= -0.21810258596519652  max|de|= -8.57e-05
converged 7 8  |r|= 0.00278  e= [-0.218103]  max|de|= -8.57e-05
RHF/RKS wavefunction has an internal instability




******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmp3bngl4h4
max_memory 4000 MB (current use 260 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2b8e2e583830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2b8e2e583cb0>
******** <class 'pyscf.dft.rks.RKS'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmp3bngl4h4
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 260 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.267866583697738  LUMO = -0.219000409228672
Initial guess E= -108.623049883508  |g|= 0.0948218
macro= 0  E= -108.626336490044  delta_E= -0.00328661  |g|= 0.0948218  2 KF 6 JK
macro= 1  E= -108.626459613609  delta_E= -0.000123124  |g|= 0.000915376  3 KF 10 JK
macro= 2  E= -108.626460020692  delta_E= -4.07082e-07  |g|= 7.11604e-05  2 KF 8 JK
macro= 3  E= -108.62646002072  delta_E= -2.84501e-11  |g|= 1.11687e-05  1 KF 3 JK
Canonicalize SCF orbitals
macro X = 4  E=-108.62646002072  |g|= 1.11687e-05  total 9 KF 32 JK
converged SCF energy = -108.62646002072
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 13.999968453493036
    CPU time for vxc      0.81 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 2.22  e= [1.081905]  max|de|= 1.08  lindep= 0.984
davidson 1 2  |r|= 1.35  e= [0.295354]  max|de|= -0.787  lindep= 0.91
davidson 2 3  |r|= 0.129  e= [0.029005]  max|de|= -0.266  lindep= 0.624
davidson 3 4  |r|= 0.052  e= [0.026828]  max|de|= -0.00218  lindep= 0.56
davidson 4 5  |r|= 0.0235  e= [0.026329]  max|de|= -0.000499  lindep= 0.505
davidson 5 6  |r|= 0.149  e= [0.022634]  max|de|= -0.00369  lindep= 0.908
davidson 6 7  |r|= 0.0415  e= [0.017006]  max|de|= -0.00563  lindep= 0.839
davidson 7 8  |r|= 0.061  e= [0.015547]  max|de|= -0.00146  lindep= 0.628
davidson 8 9  |r|= 0.115  e= [0.004538]  max|de|= -0.011  lindep= 0.719
davidson 9 10  |r|= 0.0416  e= [0.001057]  max|de|= -0.00348  lindep= 0.598
davidson 10 11  |r|= 0.0111  e= [0.000618]  max|de|= -0.00044  lindep= 0.916
root 0 converged  |r|= 0.00612  e= 0.0005839112321281468  max|de|= -3.37e-05
converged 11 12  |r|= 0.00612  e= [0.000584]  max|de|= -3.37e-05
RHF/RKS wavefunction is stable in the internal stability analysis
             #0      #1      #2      #3      #4      #5     
  0 N 1s       0.644   0.752   0.219   0.221                
  0 N 2s                       0.472   0.476                
  0 N 3s                       0.302   0.300                
  0 N 2px                                     -0.170   0.354
  0 N 2py                                      0.219  -0.482
  0 N 3px                                      0.126  -0.258
  0 N 3py                                     -0.159   0.353
  1 N 1s      -0.752   0.644   0.220  -0.220                
  1 N 2s                       0.473  -0.476                
  1 N 3s                       0.303  -0.300                
  1 N 2px                                     -0.483  -0.220
  1 N 2py                                     -0.353  -0.169
  1 N 3px                                      0.354   0.159
  1 N 3py                                      0.257   0.126
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                      -0.211   0.214
  0 N 2s                                      -1.112   1.135
  0 N 3s                                       1.102  -1.137
  0 N 2px                     -0.241   0.448                
  0 N 2py                     -0.168   0.338                
  0 N 2pz     -0.448   0.466                   0.145   0.123
  0 N 3px                      0.193  -0.362                
  0 N 3py                      0.138  -0.271                
  0 N 3pz      0.356  -0.346                   0.132   0.117
  1 N 1s                                      -0.211  -0.214
  1 N 2s                                      -1.112  -1.135
  1 N 3s                                       1.102   1.137
  1 N 2px                      0.336   0.167                
  1 N 2py                     -0.449  -0.242                
  1 N 2pz      0.448   0.466                  -0.145   0.123
  1 N 3px                     -0.270  -0.137                
  1 N 3py                      0.363   0.193                
  1 N 3pz     -0.356  -0.346                  -0.132   0.117
[-14.52891  -14.52889   -0.739486  -0.736883  -0.289439  -0.289433  -0.270007  -0.221396  -0.19491   -0.194904   0.520604   0.566485]
scan 3.75, -108.626460
#INFO: **** input file is /share/home/srwang/pyAutoMR/examples/guess/N2-RKS.py ****
from pyscf import gto, dft
from automr import guess, dump_mat
import numpy as np
#mf=guess.from_fch_simp("v2.fchk", xc='pbe0')

#mf2.verbose=9
#mf2.stability()
for r in np.arange(3.0, 9.0, 0.25):
    mol = gto.Mole(atom='''N 0.0 0.0 0.0; N 0.0 0.0 %f'''%r, basis='def2-svp', verbose=5).build()
    mf = dft.RKS(mol)
    mf.xc = 'pbe0'
    mf.kernel()
    dump_mat.dump_mo(mol, mf.mo_coeff[:,:12])
    print(mf.mo_energy[:12])
    
    mf2 = guess.check_stab(mf, newton=True, res=True)
    dump_mat.dump_mo(mol, mf2.mo_coeff[:,:12])
    print(mf2.mo_energy[:12])
    print('scan %.2f, %.6f' % (r, mf2.e_tot))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='xc06n05', release='3.10.0-1127.el7.x86_64', version='#1 SMP Tue Feb 18 16:39:12 EST 2020', machine='x86_64', processor='x86_64')  Threads 48
Python 3.7.4 (default, Aug 13 2019, 20:35:49) 
[GCC 7.3.0]
numpy 1.17.2  scipy 1.4.1
Date: Thu Sep 16 17:43:55 2021
PySCF version 1.7.6a1
PySCF path  /share/home/srwang/pyscf/pyscf
GIT ORIG_HEAD 80f71dfe77ac5f9caae26788acf76446987635bd
GIT HEAD      ref: refs/heads/master
GIT master branch  80f71dfe77ac5f9caae26788acf76446987635bd

[ENV] PYSCF_EXT_PATH /share/home/srwang/pyscf_ext/fciqmc:
[CONFIG] conf_file /share/home/srwang/.pyscf_conf.py
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 2
[INPUT] num. electrons = 14
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 N      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 N      0.000000000000   0.000000000000   4.000000000000 AA    0.000000000000   0.000000000000   7.558904498260 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] N
[INPUT] 0    0    [5    /1   ]  1712.8415853      -0.0053934125305
                                257.64812677      -0.040221581118
                                58.458245853      -0.1793114499
                                16.198367905      -0.46376317823
                                5.0052600809      -0.44171422662
[INPUT] 0    0    [1    /1   ]  0.58731856571        1
[INPUT] 0    0    [1    /1   ]  0.18764592253        1
[INPUT] 1    0    [3    /1   ]  13.571470233      -0.040072398852
                                2.9257372874      -0.21807045028
                                0.79927750754     -0.51294466049
[INPUT] 1    0    [1    /1   ]  0.21954348034        1
[INPUT] 2    0    [1    /1   ]  1                    1

nuclear repulsion = 6.48242083377
number of shells = 12
number of NR pGTOs = 48
number of NR cGTOs = 28
basis = def2-svp
ecp = {}
CPU time:       188.89


******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpbvfczcep
max_memory 4000 MB (current use 260 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2b8e2e583830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2b8e2e583cb0>
Set gradient conv threshold to 3.16228e-05
atom N rad-grids = 75, ang-grids = [ 50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  86  86  86  86  86  86  86  86  86 266 266 266 266 266 266 266
 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266]
tot grids = 28092
Drop grids 3444
    CPU time for setting up grids      0.25 sec, wall time      0.01 sec
nelec by numeric integration = 13.991897637665843
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -161.25369297753514  Ecoul = 59.421570251820135  Exc = -13.11327603321613
init E= -108.462977925161
cond(S) = 10.532531923555423
    CPU time for initialize scf      1.79 sec, wall time      0.04 sec

WARN: HOMO -0.198759013153952 == LUMO -0.197789153815457

  mo_energy =
[-14.379052 -14.379037  -0.69079   -0.68951   -0.2028    -0.198759  -0.198759  -0.197789  -0.197789  -0.193913   0.56181    0.589923   0.727252   0.751869
   0.751869   0.758461   0.758461   0.790643   2.154384   2.154384   2.154387   2.154387   2.154422   2.154422   2.154475   2.154476   2.15452    2.154533]
nelec by numeric integration = 13.999996727342666
    CPU time for vxc      0.86 sec, wall time      0.02 sec
E1 = -159.4566928828429  Ecoul = 57.27930659849257  Exc = -12.855177955409287
cycle= 1 E= -108.55014340599  delta_E= -0.0872  |g|= 0.208  |ddm|= 1.66
    CPU time for cycle= 1      1.12 sec, wall time      0.02 sec
  HOMO = -0.306317907533249  LUMO = -0.273191898379672
  mo_energy =
[-14.645993 -14.645988  -0.787262  -0.785025  -0.309789  -0.306318  -0.306318  -0.273192  -0.273192  -0.2691     0.503216   0.531715   0.651914   0.676451
   0.676451   0.68325    0.68325    0.716124   2.061371   2.061371   2.061489   2.061494   2.061547   2.061791   2.061833   2.061833   2.061844   2.062029]
nelec by numeric integration = 13.999998371829347
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -160.67028901182903  Ecoul = 58.68980004689345  Exc = -13.059536221762503
cycle= 2 E= -108.557604352928  delta_E= -0.00746  |g|= 0.128  |ddm|= 0.387
    CPU time for cycle= 2      1.00 sec, wall time      0.02 sec
  HOMO = -0.267952065647668  LUMO = -0.23466536571885
  mo_energy =
[-14.538449 -14.538445  -0.748039  -0.745701  -0.271879  -0.267952  -0.267952  -0.234665  -0.234665  -0.230293   0.526903   0.555473   0.682754   0.707231
   0.707231   0.713959   0.713959   0.746617   2.099814   2.099814   2.099924   2.099951   2.100004   2.100248   2.100278   2.100278   2.100301   2.100466]
nelec by numeric integration = 13.999997643904342
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -160.20969891719366  Ecoul = 58.14555692678959  Exc = -12.980677417177777
cycle= 3 E= -108.562398573812  delta_E= -0.00479  |g|= 0.000455  |ddm|= 0.148
    CPU time for cycle= 3      0.99 sec, wall time      0.02 sec
  HOMO = -0.267882114854825  LUMO = -0.234571820282267
  mo_energy =
[-14.538302 -14.538297  -0.748012  -0.745665  -0.271807  -0.267882  -0.267882  -0.234572  -0.234572  -0.230177   0.52699    0.555585   0.682924   0.707385
   0.707385   0.714092   0.714092   0.746747   2.099944   2.099944   2.100052   2.100085   2.100138   2.100382   2.10041    2.10041    2.100436   2.100598]
nelec by numeric integration = 13.999997649916349
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -160.20922276022378  Ecoul = 58.14503298227433  Exc = -12.980629700228377
cycle= 4 E= -108.562398644408  delta_E= -7.06e-08  |g|= 4.56e-05  |ddm|= 0.000698
    CPU time for cycle= 4      1.00 sec, wall time      0.02 sec
  HOMO = -0.267879453586676  LUMO = -0.234570807814832
  mo_energy =
[-14.538289 -14.538284  -0.748009  -0.745662  -0.271804  -0.267879  -0.267879  -0.234571  -0.234571  -0.230176   0.526988   0.555579   0.682918   0.70738
   0.70738    0.714089   0.714089   0.746746   2.099942   2.099942   2.10005    2.100082   2.100136   2.10038    2.100408   2.100408   2.100433   2.100596]
nelec by numeric integration = 13.999997649225506
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -160.20918993504407  Ecoul = 58.14499543319581  Exc = -12.980624975979246
cycle= 5 E= -108.562398644057  delta_E= 3.5e-10  |g|= 7.33e-05  |ddm|= 4.2e-05
    CPU time for cycle= 5      1.00 sec, wall time      0.02 sec
  HOMO = -0.267879419149177  LUMO = -0.234570795435013
  mo_energy =
[-14.538289 -14.538284  -0.748009  -0.745662  -0.271804  -0.267879  -0.267879  -0.234571  -0.234571  -0.230176   0.526988   0.555578   0.682918   0.70738
   0.70738    0.714089   0.714089   0.746746   2.099942   2.099942   2.10005    2.100082   2.100136   2.10038    2.100408   2.100408   2.100433   2.100596]
nelec by numeric integration = 13.999997649229016
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -160.20918944126316  Ecoul = 58.144994853431726  Exc = -12.980624883785257
cycle= 6 E= -108.562398637847  delta_E= 6.21e-09  |g|= 0.000212  |ddm|= 9.08e-05
    CPU time for cycle= 6      1.00 sec, wall time      0.02 sec
  HOMO = -0.267878845582679  LUMO = -0.234570590121241
  mo_energy =
[-14.538285 -14.538281  -0.748009  -0.745662  -0.271803  -0.267879  -0.267879  -0.234571  -0.234571  -0.230176   0.526987   0.555577   0.682917   0.707379
   0.707379   0.714088   0.714088   0.746745   2.099941   2.099941   2.100049   2.100082   2.100135   2.100379   2.100407   2.100407   2.100433   2.100595]
nelec by numeric integration = 13.999997649292002
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -160.20918119201005  Ecoul = 58.14498503783334  Exc = -12.980623324496658
cycle= 7 E= -108.562398644903  delta_E= -7.06e-09  |g|= 1.75e-07  |ddm|= 6.77e-05
    CPU time for cycle= 7      1.01 sec, wall time      0.02 sec
  HOMO = -0.26787888684472  LUMO = -0.234570623587022
  mo_energy =
[-14.538285 -14.538281  -0.748009  -0.745662  -0.271803  -0.267879  -0.267879  -0.234571  -0.234571  -0.230176   0.526987   0.555577   0.682917   0.707379
   0.707379   0.714088   0.714088   0.746745   2.099941   2.099941   2.100049   2.100082   2.100135   2.100379   2.100407   2.100407   2.100433   2.100595]
nelec by numeric integration = 13.99999764929317
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -160.20918172127148  Ecoul = 58.144985650399164  Exc = -12.980623407801021
cycle= 8 E= -108.562398644903  delta_E= 4.26e-14  |g|= 9.25e-09  |ddm|= 1.94e-07
    CPU time for cycle= 8      1.00 sec, wall time      0.02 sec
  HOMO = -0.26787889062218  LUMO = -0.234570626581413
  mo_energy =
[-14.538285 -14.538281  -0.748009  -0.745662  -0.271803  -0.267879  -0.267879  -0.234571  -0.234571  -0.230176   0.526987   0.555577   0.682917   0.707379
   0.707379   0.714088   0.714088   0.746745   2.099941   2.099941   2.100049   2.100082   2.100135   2.100379   2.100407   2.100407   2.100433   2.100595]
nelec by numeric integration = 13.999997649293213
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -160.20918176475988  Ecoul = 58.144985701102605  Exc = -12.98062341501614
Extra cycle  E= -108.562398644903  delta_E= -8.53e-14  |g|= 4.95e-09  |ddm|= 1.47e-08
    CPU time for scf_cycle     10.89 sec, wall time      0.23 sec
    CPU time for SCF     10.91 sec, wall time      0.23 sec
converged SCF energy = -108.562398644903
             #0      #1      #2      #3      #4      #5     
  0 N 1s       0.700   0.700   0.220  -0.221                
  0 N 2s                       0.475  -0.478                
  0 N 3s                       0.300  -0.298                
  0 N 2px                                              0.454
  0 N 2pz                                      0.453        
  0 N 3px                                             -0.346
  0 N 3pz                                     -0.353        
  1 N 1s      -0.700   0.700   0.220   0.221                
  1 N 2s                       0.475   0.478                
  1 N 3s                       0.300   0.298                
  1 N 2px                                              0.454
  1 N 2pz                                     -0.453        
  1 N 3px                                             -0.346
  1 N 3pz                                      0.353        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                       0.214   0.215
  0 N 2s                                       1.131   1.142
  0 N 3s                                      -1.126  -1.144
  0 N 2px             -0.456                                
  0 N 2py      0.454           0.456                        
  0 N 2pz                              0.465                
  0 N 3px              0.345                                
  0 N 3py     -0.346          -0.345                        
  0 N 3pz                             -0.345                
  1 N 1s                                       0.214  -0.215
  1 N 2s                                       1.131  -1.142
  1 N 3s                                      -1.126   1.144
  1 N 2px              0.456                                
  1 N 2py      0.454          -0.456                        
  1 N 2pz                              0.465                
  1 N 3px             -0.345                                
  1 N 3py     -0.346           0.345                        
  1 N 3pz                             -0.345                
[-14.538285 -14.538281  -0.748009  -0.745662  -0.271803  -0.267879  -0.267879  -0.234571  -0.234571  -0.230176   0.526987   0.555577]
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 13.99999764929321
    CPU time for vxc      0.79 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 2.03  e= [0.237236]  max|de|= 0.237  lindep=    1
davidson 1 2  |r|= 0.623  e= [-0.066514]  max|de|= -0.304  lindep= 0.943
davidson 2 3  |r|= 0.275  e= [-0.202444]  max|de|= -0.136  lindep=  0.6
davidson 3 4  |r|= 0.0955  e= [-0.220618]  max|de|= -0.0182  lindep= 0.861
davidson 4 5  |r|= 0.0212  e= [-0.222109]  max|de|= -0.00149  lindep= 0.694
davidson 5 6  |r|= 0.0722  e= [-0.223025]  max|de|= -0.000917  lindep= 0.666
davidson 6 7  |r|= 0.0461  e= [-0.228102]  max|de|= -0.00508  lindep= 0.921
davidson 7 8  |r|= 0.00698  e= [-0.228386]  max|de|= -0.000284  lindep= 0.677
root 0 converged  |r|= 0.00518  e= -0.2284164100865781  max|de|= -3e-05
converged 8 9  |r|= 0.00518  e= [-0.228416]  max|de|= -3e-05
RHF/RKS wavefunction has an internal instability




******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpbvfczcep
max_memory 4000 MB (current use 261 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2b8e2e583830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2b8e2e583cb0>
******** <class 'pyscf.dft.rks.RKS'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpbvfczcep
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 261 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.24652039261138  LUMO = -0.231068256519517
Initial guess E= -108.152172994211  |g|= 0.97877
macro= 0  E= -108.602141954716  delta_E= -0.449969  |g|= 0.264938  3 KF 17 JK
macro= 1  E= -108.615450911294  delta_E= -0.013309  |g|= 0.107719  3 KF 19 JK
macro= 2  E= -108.619010546434  delta_E= -0.00355964  |g|= 0.100101  2 KF 6 JK
macro= 3  E= -108.620348301742  delta_E= -0.00133776  |g|= 0.00570716  3 KF 11 JK
macro= 4  E= -108.620624590071  delta_E= -0.000276288  |g|= 0.00641157  2 KF 6 JK
macro= 5  E= -108.620641958823  delta_E= -1.73688e-05  |g|= 0.000739112  3 KF 10 JK
macro= 6  E= -108.620642293697  delta_E= -3.34874e-07  |g|= 4.41989e-05  2 KF 9 JK
macro= 7  E= -108.620642293701  delta_E= -4.22062e-12  |g|= 4.99473e-06  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 8  E=-108.620642293701  |g|= 4.99473e-06  total 20 KF 89 JK
converged SCF energy = -108.620642293701
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 13.999997853147544
    CPU time for vxc      0.82 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 2.11  e= [1.084588]  max|de|= 1.08  lindep= 0.992
davidson 1 2  |r|= 1.22  e= [0.207013]  max|de|= -0.878  lindep= 0.385
davidson 2 3  |r|= 0.626  e= [0.07238]  max|de|= -0.135  lindep= 0.323
davidson 3 4  |r|= 0.118  e= [0.01557]  max|de|= -0.0568  lindep= 0.922
davidson 4 5  |r|= 0.0208  e= [0.013516]  max|de|= -0.00205  lindep= 0.684
davidson 5 6  |r|= 0.0506  e= [0.012973]  max|de|= -0.000543  lindep= 0.652
davidson 6 7  |r|= 0.105  e= [0.005931]  max|de|= -0.00704  lindep= 0.707
davidson 7 8  |r|= 0.0383  e= [0.003067]  max|de|= -0.00286  lindep= 0.75
davidson 8 9  |r|= 0.0211  e= [0.002541]  max|de|= -0.000526  lindep= 0.738
davidson 9 10  |r|= 0.0384  e= [0.001701]  max|de|= -0.000841  lindep= 0.46
davidson 10 11  |r|= 0.017  e= [0.000517]  max|de|= -0.00118  lindep= 0.929
root 0 converged  |r|= 0.00315  e= 0.00048367412312083413  max|de|= -3.3e-05
converged 11 12  |r|= 0.00315  e= [0.000484]  max|de|= -3.3e-05
RHF/RKS wavefunction is stable in the internal stability analysis
             #0      #1      #2      #3      #4      #5     
  0 N 1s       0.744   0.653   0.220   0.220                
  0 N 2s                       0.472   0.475                
  0 N 3s                       0.303   0.301                
  0 N 2px                                     -0.552   0.349
  0 N 3px                                      0.404  -0.255
  1 N 1s      -0.653   0.744   0.220  -0.220                
  1 N 2s                       0.472  -0.475                
  1 N 3s                       0.303  -0.301                
  1 N 2py                                      0.349   0.551
  1 N 3py                                     -0.255  -0.404
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                      -0.214   0.215
  0 N 2s                                      -1.131   1.143
  0 N 3s                                       1.125  -1.143
  0 N 2py                      0.518  -0.353                
  0 N 2pz     -0.450  -0.463                                
  0 N 3py                     -0.419   0.285                
  0 N 3pz      0.356   0.347                                
  1 N 1s                                      -0.214  -0.215
  1 N 2s                                      -1.131  -1.143
  1 N 3s                                       1.125   1.143
  1 N 2px                      0.352   0.517                
  1 N 2pz      0.450  -0.463                                
  1 N 3px                     -0.285  -0.419                
  1 N 3pz     -0.356   0.347                                
[-14.526384 -14.526374  -0.737946  -0.736269  -0.288347  -0.288345  -0.265685  -0.223981  -0.19395   -0.193948   0.532634   0.561046]
scan 4.00, -108.620642
#INFO: **** input file is /share/home/srwang/pyAutoMR/examples/guess/N2-RKS.py ****
from pyscf import gto, dft
from automr import guess, dump_mat
import numpy as np
#mf=guess.from_fch_simp("v2.fchk", xc='pbe0')

#mf2.verbose=9
#mf2.stability()
for r in np.arange(3.0, 9.0, 0.25):
    mol = gto.Mole(atom='''N 0.0 0.0 0.0; N 0.0 0.0 %f'''%r, basis='def2-svp', verbose=5).build()
    mf = dft.RKS(mol)
    mf.xc = 'pbe0'
    mf.kernel()
    dump_mat.dump_mo(mol, mf.mo_coeff[:,:12])
    print(mf.mo_energy[:12])
    
    mf2 = guess.check_stab(mf, newton=True, res=True)
    dump_mat.dump_mo(mol, mf2.mo_coeff[:,:12])
    print(mf2.mo_energy[:12])
    print('scan %.2f, %.6f' % (r, mf2.e_tot))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='xc06n05', release='3.10.0-1127.el7.x86_64', version='#1 SMP Tue Feb 18 16:39:12 EST 2020', machine='x86_64', processor='x86_64')  Threads 48
Python 3.7.4 (default, Aug 13 2019, 20:35:49) 
[GCC 7.3.0]
numpy 1.17.2  scipy 1.4.1
Date: Thu Sep 16 17:43:56 2021
PySCF version 1.7.6a1
PySCF path  /share/home/srwang/pyscf/pyscf
GIT ORIG_HEAD 80f71dfe77ac5f9caae26788acf76446987635bd
GIT HEAD      ref: refs/heads/master
GIT master branch  80f71dfe77ac5f9caae26788acf76446987635bd

[ENV] PYSCF_EXT_PATH /share/home/srwang/pyscf_ext/fciqmc:
[CONFIG] conf_file /share/home/srwang/.pyscf_conf.py
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 2
[INPUT] num. electrons = 14
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 N      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 N      0.000000000000   0.000000000000   4.250000000000 AA    0.000000000000   0.000000000000   8.031336029402 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] N
[INPUT] 0    0    [5    /1   ]  1712.8415853      -0.0053934125305
                                257.64812677      -0.040221581118
                                58.458245853      -0.1793114499
                                16.198367905      -0.46376317823
                                5.0052600809      -0.44171422662
[INPUT] 0    0    [1    /1   ]  0.58731856571        1
[INPUT] 0    0    [1    /1   ]  0.18764592253        1
[INPUT] 1    0    [3    /1   ]  13.571470233      -0.040072398852
                                2.9257372874      -0.21807045028
                                0.79927750754     -0.51294466049
[INPUT] 1    0    [1    /1   ]  0.21954348034        1
[INPUT] 2    0    [1    /1   ]  1                    1

nuclear repulsion = 6.10110196119529
number of shells = 12
number of NR pGTOs = 48
number of NR cGTOs = 28
basis = def2-svp
ecp = {}
CPU time:       250.66


******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmptodcex8l
max_memory 4000 MB (current use 261 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2b8e2e583830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2b8e2e583cb0>
Set gradient conv threshold to 3.16228e-05
atom N rad-grids = 75, ang-grids = [ 50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  86  86  86  86  86  86  86  86  86 266 266 266 266 266 266 266
 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266]
tot grids = 28092
Drop grids 3426
    CPU time for setting up grids      0.27 sec, wall time      0.01 sec
nelec by numeric integration = 13.991851462353868
    CPU time for vxc      0.80 sec, wall time      0.02 sec
E1 = -160.49064497107787  Ecoul = 59.03987105607386  Exc = -13.113180271390718
init E= -108.462852225199
cond(S) = 10.470470733244099
    CPU time for initialize scf      1.82 sec, wall time      0.04 sec

WARN: HOMO -0.198533078704168 == LUMO -0.198030306275968

  mo_energy =
[-14.379116 -14.379107  -0.690508  -0.689798  -0.200987  -0.198533  -0.198533  -0.19803   -0.19803   -0.195663   0.568925   0.585169   0.737782   0.753509
   0.753509   0.756804   0.756804   0.774975   2.154388   2.154388   2.15439    2.15439    2.154416   2.154417   2.154462   2.154462   2.154507   2.154514]
nelec by numeric integration = 14.000028280122354
    CPU time for vxc      0.83 sec, wall time      0.02 sec
E1 = -158.72407481647565  Ecoul = 56.93701033560576  Exc = -12.858032553463563
cycle= 1 E= -108.543995073138  delta_E= -0.0811  |g|= 0.203  |ddm|= 1.66
    CPU time for cycle= 1      1.09 sec, wall time      0.02 sec
  HOMO = -0.303363704309625  LUMO = -0.272418096761775
  mo_energy =
[-14.641297 -14.641296  -0.785035  -0.783402  -0.305688  -0.303364  -0.303364  -0.272418  -0.272418  -0.269723   0.511611   0.528232   0.663722   0.679504
   0.679504   0.68295    0.68295    0.701529   2.063284   2.063284   2.063378   2.063397   2.063442   2.063645   2.063669   2.063669   2.063691   2.063823]
nelec by numeric integration = 14.000027824767676
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -159.90997607748542  Ecoul = 58.31543248081852  Exc = -13.057713655139572
cycle= 2 E= -108.551155290611  delta_E= -0.00716  |g|= 0.126  |ddm|= 0.379
    CPU time for cycle= 2      1.00 sec, wall time      0.02 sec
  HOMO = -0.265881660556775  LUMO = -0.234827393682289
  mo_energy =
[-14.536154 -14.536153  -0.746699  -0.745009  -0.268475  -0.265882  -0.265882  -0.234827  -0.234827  -0.23196    0.534717   0.551363   0.693925   0.709617
   0.709617   0.713007   0.713007   0.731452   2.100849   2.100849   2.100939   2.100969   2.101015   2.101218   2.101235   2.101235   2.101263   2.101386]
nelec by numeric integration = 14.000027947695646
    CPU time for vxc      0.85 sec, wall time      0.02 sec
E1 = -159.46052658944956  Ecoul = 57.78450399654557  Exc = -12.980804838278775
cycle= 3 E= -108.555725469987  delta_E= -0.00457  |g|= 0.000427  |ddm|= 0.145
    CPU time for cycle= 3      1.03 sec, wall time      0.02 sec
  HOMO = -0.26580210571919  LUMO = -0.234726994917361
  mo_energy =
[-14.535983 -14.535982  -0.746664  -0.744966  -0.268394  -0.265802  -0.265802  -0.234727  -0.234727  -0.231845   0.53481    0.551471   0.694091   0.709773
   0.709773   0.713144   0.713144   0.731588   2.100985   2.100985   2.101074   2.101107   2.101153   2.101356   2.101373   2.101373   2.101402   2.101523]
nelec by numeric integration = 14.000027956130545
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -159.45997047809234  Ecoul = 57.78388580511927  Exc = -12.980742818724817
cycle= 4 E= -108.555725530503  delta_E= -6.05e-08  |g|= 4.9e-05  |ddm|= 0.000634
    CPU time for cycle= 4      0.99 sec, wall time      0.02 sec
  HOMO = -0.265799750301241  LUMO = -0.234726082789735
  mo_energy =
[-14.535971 -14.53597   -0.746661  -0.744963  -0.268392  -0.2658    -0.2658    -0.234726  -0.234726  -0.231844   0.534808   0.551466   0.694086   0.709768
   0.709768   0.713141   0.713141   0.731586   2.100982   2.100982   2.101072   2.101105   2.101151   2.101354   2.10137    2.10137    2.101399   2.101521]
nelec by numeric integration = 14.000027955385939
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -159.45993972638752  Ecoul = 57.78385063719361  Exc = -12.980738402370102
cycle= 5 E= -108.555725530369  delta_E= 1.34e-10  |g|= 6.75e-05  |ddm|= 4.24e-05
    CPU time for cycle= 5      0.99 sec, wall time      0.02 sec
  HOMO = -0.265799715570799  LUMO = -0.234726067596166
  mo_energy =
[-14.535972 -14.535969  -0.746661  -0.744963  -0.268392  -0.2658    -0.2658    -0.234726  -0.234726  -0.231844   0.534808   0.551466   0.694086   0.709768
   0.709768   0.713141   0.713141   0.731586   2.100982   2.100982   2.101072   2.101105   2.101151   2.101354   2.10137    2.10137    2.101399   2.101521]
nelec by numeric integration = 14.000027955390253
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -159.45993923148015  Ecoul = 57.78385005891447  Exc = -12.980738312605318
cycle= 6 E= -108.555725523976  delta_E= 6.39e-09  |g|= 0.000214  |ddm|= 8.82e-05
    CPU time for cycle= 6      0.99 sec, wall time      0.02 sec
  HOMO = -0.265799103611338  LUMO = -0.23472580002528
  mo_energy =
[-14.535967 -14.535966  -0.746661  -0.744963  -0.268391  -0.265799  -0.265799  -0.234726  -0.234726  -0.231843   0.534806   0.551465   0.694085   0.709767
   0.709767   0.71314    0.71314    0.731585   2.100982   2.100982   2.101071   2.101104   2.10115    2.101353   2.10137    2.10137    2.101399   2.10152 ]
nelec by numeric integration = 14.00002795546971
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -159.4599305015566  Ecoul = 57.78383972131118  Exc = -12.980736712026598
cycle= 7 E= -108.555725531077  delta_E= -7.1e-09  |g|= 1.44e-07  |ddm|= 6.72e-05
    CPU time for cycle= 7      1.00 sec, wall time      0.02 sec
  HOMO = -0.265799136020388  LUMO = -0.234725827520979
  mo_energy =
[-14.535967 -14.535966  -0.746661  -0.744963  -0.268391  -0.265799  -0.265799  -0.234726  -0.234726  -0.231843   0.534806   0.551465   0.694085   0.709767
   0.709767   0.71314    0.71314    0.731585   2.100982   2.100982   2.101071   2.101104   2.10115    2.101353   2.10137    2.10137    2.101399   2.10152 ]
nelec by numeric integration = 14.000027955469863
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -159.45993092175885  Ecoul = 57.7838402070716  Exc = -12.980736777584791
cycle= 8 E= -108.555725531077  delta_E= -1.42e-14  |g|= 7.75e-09  |ddm|= 1.51e-07
    CPU time for cycle= 8      1.01 sec, wall time      0.02 sec
  HOMO = -0.265799139321752  LUMO = -0.234725830194064
  mo_energy =
[-14.535967 -14.535966  -0.746661  -0.744963  -0.268391  -0.265799  -0.265799  -0.234726  -0.234726  -0.231843   0.534806   0.551465   0.694085   0.709767
   0.709767   0.71314    0.71314    0.731585   2.100982   2.100982   2.101071   2.101104   2.10115    2.101353   2.10137    2.10137    2.101399   2.10152 ]
nelec by numeric integration = 14.000027955469823
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -159.45993096046118  Ecoul = 57.783840252134034  Exc = -12.98073678394494
Extra cycle  E= -108.555725531077  delta_E= -4.26e-14  |g|= 4.37e-09  |ddm|= 1.26e-08
    CPU time for scf_cycle     10.91 sec, wall time      0.23 sec
    CPU time for SCF     10.93 sec, wall time      0.23 sec
converged SCF energy = -108.555725531077
             #0      #1      #2      #3      #4      #5     
  0 N 1s       0.700  -0.700   0.220  -0.221                
  0 N 2s                       0.475  -0.477                
  0 N 3s                       0.300  -0.299                
  0 N 2px                                              0.117
  0 N 2py                                              0.444
  0 N 2pz                                      0.455        
  0 N 3py                                             -0.338
  0 N 3pz                                     -0.352        
  1 N 1s       0.700   0.700   0.220   0.221                
  1 N 2s                       0.475   0.477                
  1 N 3s                       0.300   0.299                
  1 N 2px                                              0.117
  1 N 2py                                              0.444
  1 N 2pz                                     -0.455        
  1 N 3py                                             -0.338
  1 N 3pz                                      0.352        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                       0.215   0.216
  0 N 2s                                       1.140   1.145
  0 N 3s                                      -1.137  -1.146
  0 N 2px      0.444   0.111  -0.446                        
  0 N 2py     -0.117   0.446   0.111                        
  0 N 2pz                              0.462                
  0 N 3px     -0.338           0.339                        
  0 N 3py             -0.339                                
  0 N 3pz                             -0.347                
  1 N 1s                                       0.215  -0.216
  1 N 2s                                       1.140  -1.145
  1 N 3s                                      -1.137   1.146
  1 N 2px      0.444  -0.111   0.446                        
  1 N 2py     -0.117  -0.446  -0.111                        
  1 N 2pz                              0.462                
  1 N 3px     -0.338          -0.339                        
  1 N 3py              0.339                                
  1 N 3pz                             -0.347                
[-14.535967 -14.535966  -0.746661  -0.744963  -0.268391  -0.265799  -0.265799  -0.234726  -0.234726  -0.231843   0.534806   0.551465]
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 14.000027955469823
    CPU time for vxc      0.79 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 2.08  e= [0.236853]  max|de|= 0.237  lindep=    1
davidson 1 2  |r|= 0.561  e= [-0.081648]  max|de|= -0.319  lindep= 0.962
davidson 2 3  |r|= 0.254  e= [-0.217711]  max|de|= -0.136  lindep= 0.615
davidson 3 4  |r|= 0.084  e= [-0.231249]  max|de|= -0.0135  lindep= 0.849
davidson 4 5  |r|= 0.0142  e= [-0.232257]  max|de|= -0.00101  lindep= 0.758
davidson 5 6  |r|= 0.0449  e= [-0.232612]  max|de|= -0.000354  lindep= 0.613
davidson 6 7  |r|= 0.0603  e= [-0.23647]  max|de|= -0.00386  lindep= 0.902
davidson 7 8  |r|= 0.00554  e= [-0.23694]  max|de|= -0.000469  lindep= 0.797
root 0 converged  |r|= 0.00401  e= -0.2369569682187886  max|de|= -1.75e-05
converged 8 9  |r|= 0.00401  e= [-0.236957]  max|de|= -1.75e-05
RHF/RKS wavefunction has an internal instability




******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmptodcex8l
max_memory 4000 MB (current use 261 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2b8e2e583830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2b8e2e583cb0>
******** <class 'pyscf.dft.rks.RKS'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmptodcex8l
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 261 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.242437105871389  LUMO = -0.233771503467524
Initial guess E= -105.623481758037  |g|= 2.72373
macro= 0  E= -107.563492036983  delta_E= -1.94001  |g|= 2.28605  2 KF 14 JK
macro= 1  E= -108.246080238163  delta_E= -0.682588  |g|= 1.36762  2 KF 14 JK
macro= 2  E= -108.520447919176  delta_E= -0.274368  |g|= 0.752432  2 KF 14 JK
macro= 3  E= -108.592253864475  delta_E= -0.0718059  |g|= 0.185211  3 KF 18 JK
macro= 4  E= -108.571560687486  delta_E= 0.0206932  |g|= 0.0688879  3 KF 16 JK
macro= 5  E= -108.615459938317  delta_E= -0.0438993  |g|= 0.349234  2 KF 6 JK
macro= 6  E= -108.616424851823  delta_E= -0.000964914  |g|= 0.00476615  3 KF 11 JK
macro= 7  E= -108.61633949406  delta_E= 8.53578e-05  |g|= 0.00477872  2 KF 8 JK
macro= 8  E= -108.616487435749  delta_E= -0.000147942  |g|= 0.0010977  3 KF 9 JK
macro= 9  E= -108.616488880896  delta_E= -1.44515e-06  |g|= 0.000243368  2 KF 11 JK
macro= 10  E= -108.616488931594  delta_E= -5.06984e-08  |g|= 2.1798e-05  2 KF 7 JK
macro= 11  E= -108.616488938788  delta_E= -7.1945e-09  |g|= 1.71372e-05  1 KF 7 JK
macro= 12  E= -108.616488958814  delta_E= -2.00253e-08  |g|= 4.15398e-05  1 KF 6 JK
macro= 13  E= -108.616489057534  delta_E= -9.87206e-08  |g|= 3.93915e-05  1 KF 5 JK
macro= 14  E= -108.616488801374  delta_E= 2.56161e-07  |g|= 0.00051091  2 KF 8 JK
macro= 15  E= -108.616489686113  delta_E= -8.8474e-07  |g|= 0.000207275  2 KF 12 JK
macro= 16  E= -108.61648970077  delta_E= -1.46569e-08  |g|= 7.64551e-05  2 KF 13 JK
macro= 17  E= -108.616489700891  delta_E= -1.20622e-10  |g|= 2.61681e-05  1 KF 3 JK
Canonicalize SCF orbitals
macro X = 18  E=-108.616489700891  |g|= 2.61681e-05  total 37 KF 201 JK
converged SCF energy = -108.616489700891
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 14.00002773104918
    CPU time for vxc      0.82 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 2.39  e= [1.379089]  max|de|= 1.38  lindep= 0.991
davidson 1 2  |r|= 1.78  e= [0.504723]  max|de|= -0.874  lindep= 0.331
davidson 2 3  |r|= 0.543  e= [0.05604]  max|de|= -0.449  lindep= 0.477
davidson 3 4  |r|= 0.202  e= [0.013185]  max|de|= -0.0429  lindep= 0.653
davidson 4 5  |r|= 0.05  e= [0.003554]  max|de|= -0.00963  lindep= 0.615
davidson 5 6  |r|= 0.0222  e= [0.002962]  max|de|= -0.000592  lindep= 0.658
davidson 6 7  |r|= 0.0313  e= [0.002639]  max|de|= -0.000323  lindep= 0.404
davidson 7 8  |r|= 0.0504  e= [0.000531]  max|de|= -0.00211  lindep= 0.869
davidson 8 9  |r|= 0.0095  e= [0.000137]  max|de|= -0.000393  lindep= 0.935
root 0 converged  |r|= 0.00147  e= 0.00012017802304275272  max|de|= -1.73e-05
converged 9 10  |r|= 0.00147  e= [0.00012]  max|de|= -1.73e-05
RHF/RKS wavefunction is stable in the internal stability analysis
             #0      #1      #2      #3      #4      #5     
  0 N 1s       0.936  -0.324   0.220  -0.220                
  0 N 2s                       0.473  -0.473                
  0 N 3s                       0.303  -0.301                
  0 N 2px                                     -0.236        
  0 N 2py                                     -0.609        
  0 N 3px                                      0.173        
  0 N 3py                                      0.447        
  1 N 1s      -0.324  -0.936   0.219   0.221                
  1 N 2s                       0.472   0.475                
  1 N 3s                       0.302   0.302                
  1 N 2px                                              0.609
  1 N 2py                                             -0.234
  1 N 3px                                             -0.447
  1 N 3py                                              0.172
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                       0.216   0.216
  0 N 2s                                       1.141   1.146
  0 N 3s                                      -1.136  -1.145
  0 N 2px                     -0.583                        
  0 N 2py                      0.225                        
  0 N 2pz      0.453  -0.460                                
  0 N 3px                      0.473                        
  0 N 3py                     -0.183                        
  0 N 3pz     -0.355   0.349                                
  1 N 1s                                       0.216  -0.216
  1 N 2s                                       1.141  -1.146
  1 N 3s                                      -1.136   1.145
  1 N 2px                             -0.224                
  1 N 2py                             -0.583                
  1 N 2pz     -0.453  -0.460                                
  1 N 3px                              0.182                
  1 N 3py                              0.473                
  1 N 3pz      0.355   0.349                                
[-14.524503 -14.524497  -0.736855  -0.735728  -0.287528  -0.287525  -0.262447  -0.225866  -0.193221  -0.193218   0.540346   0.556818]
scan 4.25, -108.616490
#INFO: **** input file is /share/home/srwang/pyAutoMR/examples/guess/N2-RKS.py ****
from pyscf import gto, dft
from automr import guess, dump_mat
import numpy as np
#mf=guess.from_fch_simp("v2.fchk", xc='pbe0')

#mf2.verbose=9
#mf2.stability()
for r in np.arange(3.0, 9.0, 0.25):
    mol = gto.Mole(atom='''N 0.0 0.0 0.0; N 0.0 0.0 %f'''%r, basis='def2-svp', verbose=5).build()
    mf = dft.RKS(mol)
    mf.xc = 'pbe0'
    mf.kernel()
    dump_mat.dump_mo(mol, mf.mo_coeff[:,:12])
    print(mf.mo_energy[:12])
    
    mf2 = guess.check_stab(mf, newton=True, res=True)
    dump_mat.dump_mo(mol, mf2.mo_coeff[:,:12])
    print(mf2.mo_energy[:12])
    print('scan %.2f, %.6f' % (r, mf2.e_tot))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='xc06n05', release='3.10.0-1127.el7.x86_64', version='#1 SMP Tue Feb 18 16:39:12 EST 2020', machine='x86_64', processor='x86_64')  Threads 48
Python 3.7.4 (default, Aug 13 2019, 20:35:49) 
[GCC 7.3.0]
numpy 1.17.2  scipy 1.4.1
Date: Thu Sep 16 17:43:59 2021
PySCF version 1.7.6a1
PySCF path  /share/home/srwang/pyscf/pyscf
GIT ORIG_HEAD 80f71dfe77ac5f9caae26788acf76446987635bd
GIT HEAD      ref: refs/heads/master
GIT master branch  80f71dfe77ac5f9caae26788acf76446987635bd

[ENV] PYSCF_EXT_PATH /share/home/srwang/pyscf_ext/fciqmc:
[CONFIG] conf_file /share/home/srwang/.pyscf_conf.py
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 2
[INPUT] num. electrons = 14
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 N      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 N      0.000000000000   0.000000000000   4.500000000000 AA    0.000000000000   0.000000000000   8.503767560543 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] N
[INPUT] 0    0    [5    /1   ]  1712.8415853      -0.0053934125305
                                257.64812677      -0.040221581118
                                58.458245853      -0.1793114499
                                16.198367905      -0.46376317823
                                5.0052600809      -0.44171422662
[INPUT] 0    0    [1    /1   ]  0.58731856571        1
[INPUT] 0    0    [1    /1   ]  0.18764592253        1
[INPUT] 1    0    [3    /1   ]  13.571470233      -0.040072398852
                                2.9257372874      -0.21807045028
                                0.79927750754     -0.51294466049
[INPUT] 1    0    [1    /1   ]  0.21954348034        1
[INPUT] 2    0    [1    /1   ]  1                    1

nuclear repulsion = 5.76215185224
number of shells = 12
number of NR pGTOs = 48
number of NR cGTOs = 28
basis = def2-svp
ecp = {}
CPU time:       356.83


******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmp5jrhpb8b
max_memory 4000 MB (current use 262 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2b8e2e583830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2b8e2e583cb0>
Set gradient conv threshold to 3.16228e-05
atom N rad-grids = 75, ang-grids = [ 50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  86  86  86  86  86  86  86  86  86 266 266 266 266 266 266 266
 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266]
tot grids = 28092
Drop grids 3408
    CPU time for setting up grids      0.26 sec, wall time      0.01 sec
nelec by numeric integration = 13.991814536303664
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -159.81269142968952  Ecoul = 58.70088434028998  Exc = -13.113131447779828
init E= -108.462786684939
cond(S) = 10.438199028154672
    CPU time for initialize scf      1.80 sec, wall time      0.04 sec

WARN: HOMO -0.198399792178243 == LUMO -0.198151241305375

  mo_energy =
[-14.379134 -14.37913   -0.690338  -0.689951  -0.199803  -0.1984    -0.1984    -0.198151  -0.198151  -0.196785   0.573102   0.581935   0.745378   0.754391
   0.754391   0.755944   0.755944   0.765637   2.154406   2.154406   2.154407   2.154407   2.154426   2.154426   2.154464   2.154464   2.154508   2.154512]
nelec by numeric integration = 14.000046381144823
    CPU time for vxc      0.83 sec, wall time      0.02 sec
E1 = -158.06572338106906  Ecoul = 56.62328554388324  Exc = -12.859100070897217
cycle= 1 E= -108.539386055843  delta_E= -0.0766  |g|= 0.201  |ddm|= 1.66
    CPU time for cycle= 1      1.11 sec, wall time      0.02 sec
  HOMO = -0.301240764844665  LUMO = -0.272129732847506
  mo_energy =
[-14.638271 -14.638268  -0.783592  -0.782351  -0.302784  -0.301241  -0.301241  -0.27213   -0.27213   -0.27037    0.516561   0.525769   0.672191   0.6813
   0.6813     0.682968   0.682968   0.692915   2.064537   2.064537   2.064615   2.064626   2.064664   2.064836   2.064861   2.064861   2.064874   2.064987]
nelec by numeric integration = 14.000044935895307
    CPU time for vxc      5.12 sec, wall time      0.11 sec
E1 = -159.2342022330331  Ecoul = 57.9815425306349  Exc = -13.055845883885727
cycle= 2 E= -108.546353734044  delta_E= -0.00697  |g|= 0.124  |ddm|= 0.373
    CPU time for cycle= 2      5.32 sec, wall time      0.11 sec
  HOMO = -0.26432468021415  LUMO = -0.235134028069326
  mo_energy =
[-14.534659 -14.534656  -0.745826  -0.744552  -0.266016  -0.264325  -0.264325  -0.235134  -0.235134  -0.233275   0.53932    0.548517   0.701959   0.710986
   0.710986   0.712607   0.712607   0.722468   2.10154    2.10154    2.101616   2.101634   2.101672   2.101844   2.101865   2.101865   2.101882   2.10199 ]
nelec by numeric integration = 14.000045492186562
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -158.79165023731323  Ecoul = 57.45885075900758  Exc = -12.98014139609762
cycle= 3 E= -108.550789022163  delta_E= -0.00444  |g|= 0.000407  |ddm|= 0.142
    CPU time for cycle= 3      1.01 sec, wall time      0.02 sec
  HOMO = -0.264237080451888  LUMO = -0.235027582314083
  mo_energy =
[-14.534468 -14.534465  -0.745782  -0.744502  -0.265928  -0.264237  -0.264237  -0.235028  -0.235028  -0.233158   0.539419   0.548624   0.702124   0.711144
   0.711144   0.712748   0.712748   0.722609   2.101681   2.101681   2.101756   2.101777   2.101814   2.101987   2.102008   2.102008   2.102025   2.102132]
nelec by numeric integration = 14.000045500453284
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -158.79102678134967  Ecoul = 57.45815368193301  Exc = -12.980067830107739
cycle= 4 E= -108.550789077284  delta_E= -5.51e-08  |g|= 4.82e-05  |ddm|= 0.000596
    CPU time for cycle= 4      1.00 sec, wall time      0.02 sec
  HOMO = -0.264234907409436  LUMO = -0.23502669937191
  mo_energy =
[-14.534457 -14.534454  -0.74578   -0.7445    -0.265925  -0.264235  -0.264235  -0.235027  -0.235027  -0.233157   0.539415   0.54862    0.702119   0.71114
   0.71114    0.712745   0.712745   0.722607   2.101679   2.101679   2.101754   2.101774   2.101812   2.101985   2.102005   2.102005   2.102023   2.10213 ]
nelec by numeric integration = 14.000045499866063
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -158.7909969249444  Ecoul = 57.45811944751679  Exc = -12.98006345136874
cycle= 5 E= -108.550789076556  delta_E= 7.28e-10  |g|= 9.15e-05  |ddm|= 4.59e-05
    CPU time for cycle= 5      0.99 sec, wall time      0.02 sec
  HOMO = -0.264234886533936  LUMO = -0.235026688873926
  mo_energy =
[-14.534457 -14.534453  -0.74578   -0.7445    -0.265925  -0.264235  -0.264235  -0.235027  -0.235027  -0.233157   0.539415   0.54862    0.702119   0.71114
   0.71114    0.712745   0.712745   0.722607   2.101679   2.101679   2.101754   2.101774   2.101812   2.101985   2.102005   2.102005   2.102023   2.10213 ]
nelec by numeric integration = 14.000045499868325
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -158.79099663074902  Ecoul = 57.45811910312623  Exc = -12.980063399072419
cycle= 6 E= -108.550789074455  delta_E= 2.1e-09  |g|= 0.000149  |ddm|= 7.42e-05
    CPU time for cycle= 6      1.00 sec, wall time      0.02 sec
  HOMO = -0.264234232941646  LUMO = -0.235026359260995
  mo_energy =
[-14.534453 -14.53445   -0.745779  -0.7445    -0.265925  -0.264234  -0.264234  -0.235026  -0.235026  -0.233157   0.539414   0.548619   0.702118   0.711139
   0.711139   0.712744   0.712744   0.722606   2.101678   2.101678   2.101754   2.101774   2.101812   2.101984   2.102005   2.102005   2.102022   2.102129]
nelec by numeric integration = 14.000045499944198
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -158.79098741523129  Ecoul = 57.45810823291172  Exc = -12.980061747762226
cycle= 7 E= -108.550789077842  delta_E= -3.39e-09  |g|= 1.22e-07  |ddm|= 4.61e-05
    CPU time for cycle= 7      1.01 sec, wall time      0.02 sec
  HOMO = -0.264234259112567  LUMO = -0.235026382413219
  mo_energy =
[-14.534453 -14.53445   -0.745779  -0.7445    -0.265925  -0.264234  -0.264234  -0.235026  -0.235026  -0.233157   0.539414   0.548619   0.702118   0.711139
   0.711139   0.712744   0.712744   0.722606   2.101678   2.101678   2.101754   2.101774   2.101812   2.101984   2.102005   2.102005   2.102022   2.102129]
nelec by numeric integration = 14.000045499944065
    CPU time for vxc      0.83 sec, wall time      0.02 sec
E1 = -158.7909877568154  Ecoul = 57.458108627450486  Exc = -12.980061800717047
cycle= 8 E= -108.550789077842  delta_E= -1.71e-13  |g|= 6.75e-09  |ddm|= 1.22e-07
    CPU time for cycle= 8      1.02 sec, wall time      0.02 sec
  HOMO = -0.264234261984724  LUMO = -0.235026384763354
  mo_energy =
[-14.534453 -14.53445   -0.745779  -0.7445    -0.265925  -0.264234  -0.264234  -0.235026  -0.235026  -0.233157   0.539414   0.548619   0.702118   0.711139
   0.711139   0.712744   0.712744   0.722606   2.101678   2.101678   2.101754   2.101774   2.101812   2.101984   2.102005   2.102005   2.102022   2.102129]
nelec by numeric integration = 14.000045499944008
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -158.79098779100622  Ecoul = 57.45810866723568  Exc = -12.980061806311307
Extra cycle  E= -108.550789077842  delta_E= 1.14e-13  |g|= 4.07e-09  |ddm|= 1.28e-08
    CPU time for scf_cycle     15.24 sec, wall time      0.32 sec
    CPU time for SCF     15.26 sec, wall time      0.32 sec
converged SCF energy = -108.550789077842
             #0      #1      #2      #3      #4      #5     
  0 N 1s       0.700   0.700   0.220   0.221                
  0 N 2s                       0.475   0.476                
  0 N 3s                       0.300   0.299                
  0 N 2px                                              0.375
  0 N 2py                                             -0.264
  0 N 2pz                                     -0.456        
  0 N 3px                                             -0.286
  0 N 3py                                              0.201
  0 N 3pz                                      0.351        
  1 N 1s       0.700  -0.700   0.220  -0.221                
  1 N 2s                       0.475  -0.476                
  1 N 3s                       0.300  -0.299                
  1 N 2px                                              0.375
  1 N 2py                                             -0.264
  1 N 2pz                                      0.456        
  1 N 3px                                             -0.286
  1 N 3py                                              0.201
  1 N 3pz                                     -0.351        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                       0.216   0.216
  0 N 2s                                       1.144   1.146
  0 N 3s                                      -1.141  -1.146
  0 N 2px      0.264   0.376  -0.263                        
  0 N 2py      0.375  -0.263  -0.376                        
  0 N 2pz                              0.461                
  0 N 3px     -0.201  -0.286   0.201                        
  0 N 3py     -0.286   0.201   0.286                        
  0 N 3pz                             -0.348                
  1 N 1s                                       0.216  -0.216
  1 N 2s                                       1.144  -1.146
  1 N 3s                                      -1.141   1.146
  1 N 2px      0.264  -0.376   0.263                        
  1 N 2py      0.375   0.263   0.376                        
  1 N 2pz                              0.461                
  1 N 3px     -0.201   0.286  -0.201                        
  1 N 3py     -0.286  -0.201  -0.286                        
  1 N 3pz                             -0.348                
[-14.534453 -14.53445   -0.745779  -0.7445    -0.265925  -0.264234  -0.264234  -0.235026  -0.235026  -0.233157   0.539414   0.548619]
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 14.000045499944004
    CPU time for vxc      0.80 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 2.11  e= [0.243331]  max|de|= 0.243  lindep=    1
davidson 1 2  |r|= 0.508  e= [-0.097568]  max|de|= -0.341  lindep= 0.976
davidson 2 3  |r|= 0.249  e= [-0.228404]  max|de|= -0.131  lindep= 0.622
davidson 3 4  |r|= 0.0782  e= [-0.240108]  max|de|= -0.0117  lindep= 0.835
davidson 4 5  |r|= 0.0107  e= [-0.240939]  max|de|= -0.000831  lindep= 0.868
davidson 5 6  |r|= 0.0232  e= [-0.241054]  max|de|= -0.000115  lindep= 0.553
davidson 6 7  |r|= 0.0771  e= [-0.243415]  max|de|= -0.00236  lindep= 0.858
davidson 7 8  |r|= 0.01  e= [-0.244168]  max|de|= -0.000754  lindep= 0.978
root 0 converged  |r|= 0.00188  e= -0.244186427859446  max|de|= -1.79e-05
converged 8 9  |r|= 0.00188  e= [-0.244186]  max|de|= -1.79e-05
RHF/RKS wavefunction has an internal instability




******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmp5jrhpb8b
max_memory 4000 MB (current use 263 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2b8e2e583830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2b8e2e583cb0>
******** <class 'pyscf.dft.rks.RKS'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmp5jrhpb8b
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 263 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.246426119233613  LUMO = -0.228946818550477
Initial guess E= -104.580678527545  |g|= 2.37982
macro= 0  E= -107.920264442824  delta_E= -3.33959  |g|= 1.49028  3 KF 15 JK
macro= 1  E= -108.438429799309  delta_E= -0.518165  |g|= 0.763578  2 KF 14 JK
macro= 2  E= -108.590029251355  delta_E= -0.151599  |g|= 0.270632  3 KF 17 JK
macro= 3  E= -108.603799769489  delta_E= -0.0137705  |g|= 0.0872214  3 KF 14 JK
macro= 4  E= -108.609327125552  delta_E= -0.00552736  |g|= 0.0296393  2 KF 10 JK
macro= 5  E= -108.610617194377  delta_E= -0.00129007  |g|= 0.044833  2 KF 5 JK
macro= 6  E= -108.610950031826  delta_E= -0.000332837  |g|= 0.0030515  3 KF 15 JK
macro= 7  E= -108.611028651072  delta_E= -7.86192e-05  |g|= 0.00701848  2 KF 9 JK
macro= 8  E= -108.611109042027  delta_E= -8.0391e-05  |g|= 0.0111113  2 KF 7 JK
macro= 9  E= -108.609715739693  delta_E= 0.0013933  |g|= 0.0063267  2 KF 7 JK
macro= 10  E= -108.611381782275  delta_E= -0.00166604  |g|= 0.0128464  3 KF 13 JK
macro= 11  E= -108.611908079137  delta_E= -0.000526297  |g|= 0.00780672  2 KF 8 JK
macro= 12  E= -108.611368717076  delta_E= 0.000539362  |g|= 0.0145747  2 KF 8 JK
macro= 13  E= -108.61281048403  delta_E= -0.00144177  |g|= 0.00538772  3 KF 12 JK
macro= 14  E= -108.612869894828  delta_E= -5.94108e-05  |g|= 0.00397727  1 KF 5 JK
macro= 15  E= -108.61144073312  delta_E= 0.00142916  |g|= 0.00633412  2 KF 7 JK
macro= 16  E= -108.61342637671  delta_E= -0.00198564  |g|= 0.00182079  4 KF 16 JK
macro= 17  E= -108.613436423719  delta_E= -1.0047e-05  |g|= 0.00138466  1 KF 5 JK
macro= 18  E= -108.613075615891  delta_E= 0.000360808  |g|= 0.00210199  2 KF 8 JK
macro= 19  E= -108.613560655281  delta_E= -0.000485039  |g|= 0.000661608  4 KF 18 JK
macro= 20  E= -108.613561603738  delta_E= -9.48457e-07  |g|= 0.000268061  1 KF 5 JK
macro= 21  E= -108.61356565124  delta_E= -4.0475e-06  |g|= 0.000603254  2 KF 10 JK
macro= 22  E= -108.613566906852  delta_E= -1.25561e-06  |g|= 7.26022e-05  4 KF 24 JK
macro= 23  E= -108.613566907002  delta_E= -1.4974e-10  |g|= 1.99666e-05  1 KF 3 JK
Canonicalize SCF orbitals
macro X = 24  E=-108.613566907002  |g|= 1.99666e-05  total 57 KF 280 JK
converged SCF energy = -108.613566907002
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 14.000045051159486
    CPU time for vxc      0.82 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 2.22  e= [1.367722]  max|de|= 1.37  lindep= 0.997
davidson 1 2  |r|= 1.53  e= [0.378935]  max|de|= -0.989  lindep= 0.86
davidson 2 3  |r|= 0.236  e= [0.025069]  max|de|= -0.354  lindep=  0.8
davidson 3 4  |r|= 0.211  e= [0.007818]  max|de|= -0.0173  lindep= 0.407
davidson 4 5  |r|= 0.0368  e= [0.000737]  max|de|= -0.00708  lindep= 0.55
davidson 5 6  |r|= 0.00685  e= [0.000563]  max|de|= -0.000173  lindep= 0.652
root 0 converged  |r|= 0.00184  e= 0.0005564550537190753  max|de|= -6.76e-06
converged 6 7  |r|= 0.00184  e= [0.000556]  max|de|= -6.76e-06
RHF/RKS wavefunction is stable in the internal stability analysis
             #0      #1      #2      #3      #4      #5     
  0 N 1s              -0.988  -0.220  -0.220                
  0 N 2s                      -0.472  -0.474                
  0 N 3s                      -0.303  -0.302                
  0 N 2px                                              0.607
  0 N 2py                                             -0.253
  0 N 3px                                             -0.447
  0 N 3py                                              0.186
  1 N 1s       0.988          -0.220   0.220                
  1 N 2s                      -0.473   0.473                
  1 N 3s                      -0.303   0.302                
  1 N 2px                                     -0.253        
  1 N 2py                                     -0.607        
  1 N 3px                                      0.186        
  1 N 3py                                      0.447        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                      -0.217  -0.217
  0 N 2s                                      -1.145  -1.147
  0 N 3s                                       1.141   1.145
  0 N 2px                              0.243                
  0 N 2py                              0.583                
  0 N 2pz      0.454  -0.459                                
  0 N 3px                             -0.197                
  0 N 3py                             -0.473                
  0 N 3pz     -0.354   0.350                                
  1 N 1s                                      -0.217   0.217
  1 N 2s                                      -1.145   1.147
  1 N 3s                                       1.141  -1.145
  1 N 2px                     -0.583                        
  1 N 2py                      0.243                        
  1 N 2pz     -0.454  -0.459                                
  1 N 3px                      0.473                        
  1 N 3py                     -0.197                        
  1 N 3pz      0.354   0.350                                
[-14.523227 -14.523224  -0.736131  -0.735339  -0.286969  -0.286968  -0.26008   -0.227303  -0.192723  -0.192722   0.544882   0.553911]
scan 4.50, -108.613567
#INFO: **** input file is /share/home/srwang/pyAutoMR/examples/guess/N2-RKS.py ****
from pyscf import gto, dft
from automr import guess, dump_mat
import numpy as np
#mf=guess.from_fch_simp("v2.fchk", xc='pbe0')

#mf2.verbose=9
#mf2.stability()
for r in np.arange(3.0, 9.0, 0.25):
    mol = gto.Mole(atom='''N 0.0 0.0 0.0; N 0.0 0.0 %f'''%r, basis='def2-svp', verbose=5).build()
    mf = dft.RKS(mol)
    mf.xc = 'pbe0'
    mf.kernel()
    dump_mat.dump_mo(mol, mf.mo_coeff[:,:12])
    print(mf.mo_energy[:12])
    
    mf2 = guess.check_stab(mf, newton=True, res=True)
    dump_mat.dump_mo(mol, mf2.mo_coeff[:,:12])
    print(mf2.mo_energy[:12])
    print('scan %.2f, %.6f' % (r, mf2.e_tot))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='xc06n05', release='3.10.0-1127.el7.x86_64', version='#1 SMP Tue Feb 18 16:39:12 EST 2020', machine='x86_64', processor='x86_64')  Threads 48
Python 3.7.4 (default, Aug 13 2019, 20:35:49) 
[GCC 7.3.0]
numpy 1.17.2  scipy 1.4.1
Date: Thu Sep 16 17:44:02 2021
PySCF version 1.7.6a1
PySCF path  /share/home/srwang/pyscf/pyscf
GIT ORIG_HEAD 80f71dfe77ac5f9caae26788acf76446987635bd
GIT HEAD      ref: refs/heads/master
GIT master branch  80f71dfe77ac5f9caae26788acf76446987635bd

[ENV] PYSCF_EXT_PATH /share/home/srwang/pyscf_ext/fciqmc:
[CONFIG] conf_file /share/home/srwang/.pyscf_conf.py
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 2
[INPUT] num. electrons = 14
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 N      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 N      0.000000000000   0.000000000000   4.750000000000 AA    0.000000000000   0.000000000000   8.976199091684 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] N
[INPUT] 0    0    [5    /1   ]  1712.8415853      -0.0053934125305
                                257.64812677      -0.040221581118
                                58.458245853      -0.1793114499
                                16.198367905      -0.46376317823
                                5.0052600809      -0.44171422662
[INPUT] 0    0    [1    /1   ]  0.58731856571        1
[INPUT] 0    0    [1    /1   ]  0.18764592253        1
[INPUT] 1    0    [3    /1   ]  13.571470233      -0.040072398852
                                2.9257372874      -0.21807045028
                                0.79927750754     -0.51294466049
[INPUT] 1    0    [1    /1   ]  0.21954348034        1
[INPUT] 2    0    [1    /1   ]  1                    1

nuclear repulsion = 5.45888070212211
number of shells = 12
number of NR pGTOs = 48
number of NR cGTOs = 28
basis = def2-svp
ecp = {}
CPU time:       503.54


******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpiobsvgzf
max_memory 4000 MB (current use 264 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2b8e2e583830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2b8e2e583cb0>
Set gradient conv threshold to 3.16228e-05
atom N rad-grids = 75, ang-grids = [ 50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  86  86  86  86  86  86  86  86  86 266 266 266 266 266 266 266
 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266]
tot grids = 28092
Drop grids 3424
    CPU time for setting up grids      0.27 sec, wall time      0.01 sec
nelec by numeric integration = 13.991783379743747
    CPU time for vxc      0.80 sec, wall time      0.02 sec
E1 = -159.20629067923937  Ecoul = 58.397760423302486  Exc = -13.113106698430379
init E= -108.462756252245
cond(S) = 10.42201752666386
    CPU time for initialize scf      1.74 sec, wall time      0.04 sec

WARN: HOMO -0.198319727091068 == LUMO -0.198202676976156

  mo_energy =
[-14.37913  -14.379128  -0.690232  -0.690026  -0.199076  -0.19832   -0.19832   -0.198203  -0.198203  -0.197461   0.575417   0.579959   0.750118   0.754843
   0.754843   0.755534   0.755534   0.76041    2.154432   2.154432   2.154432   2.154432   2.154443   2.154443   2.154474   2.154474   2.154515   2.154517]
nelec by numeric integration = 14.000046524703526
    CPU time for vxc      0.83 sec, wall time      0.02 sec
E1 = -157.47082147606227  Ecoul = 56.334984668557205  Exc = -12.858912079304579
cycle= 1 E= -108.535868184688  delta_E= -0.0731  |g|= 0.199  |ddm|= 1.66
    CPU time for cycle= 1      1.03 sec, wall time      0.02 sec
  HOMO = -0.299734556409002  LUMO = -0.272203837864338
  mo_energy =
[-14.636476 -14.636472  -0.78272   -0.781743  -0.300767  -0.299735  -0.299735  -0.272204  -0.272204  -0.271046   0.519323   0.524218   0.677484   0.68229
   0.68229    0.683073   0.683073   0.688111   2.065291   2.065291   2.065354   2.065358   2.065389   2.065537   2.065566   2.065566   2.065568   2.06567 ]
nelec by numeric integration = 14.000045790281698
    CPU time for vxc      0.82 sec, wall time      0.02 sec
E1 = -158.6293933883038  Ecoul = 57.681783198951415  Exc = -13.05398998046797
cycle= 2 E= -108.542719467698  delta_E= -0.00685  |g|= 0.123  |ddm|= 0.37
    CPU time for cycle= 2      0.99 sec, wall time      0.02 sec
  HOMO = -0.263149802507907  LUMO = -0.235555479711248
  mo_energy =
[-14.53376  -14.533756  -0.745286  -0.74429   -0.264259  -0.26315   -0.26315   -0.235555  -0.235555  -0.234344   0.541886   0.546751   0.706981   0.711725
   0.711725   0.712467   0.712467   0.717448   2.101966   2.101966   2.102028   2.102036   2.102067   2.102215   2.102243   2.102243   2.102246   2.102345]
nelec by numeric integration = 14.000046122817595
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -158.19063212512594  Ecoul = 57.163617076284886  Exc = -12.9789478309081
cycle= 3 E= -108.547082177627  delta_E= -0.00436  |g|= 0.000392  |ddm|= 0.141
    CPU time for cycle= 3      0.99 sec, wall time      0.02 sec
  HOMO = -0.2630557291246  LUMO = -0.235444054849909
  mo_energy =
[-14.533553 -14.533549  -0.745237  -0.744236  -0.264165  -0.263056  -0.263056  -0.235444  -0.235444  -0.234225   0.541989   0.546859   0.707146   0.711886
   0.711886   0.712612   0.712612   0.717594   2.102112   2.102112   2.102173   2.102183   2.102214   2.102362   2.102389   2.102389   2.102393   2.102491]
nelec by numeric integration = 14.000046128464053
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -158.18995603846332  Ecoul = 57.16285860744572  Exc = -12.978865500757033
cycle= 4 E= -108.547082229653  delta_E= -5.2e-08  |g|= 4.67e-05  |ddm|= 0.000574
    CPU time for cycle= 4      0.98 sec, wall time      0.02 sec
  HOMO = -0.263053677203969  LUMO = -0.235443167819008
  mo_energy =
[-14.533544 -14.533536  -0.745234  -0.744233  -0.264163  -0.263054  -0.263054  -0.235443  -0.235443  -0.234224   0.541985   0.546855   0.707142   0.711882
   0.711882   0.712609   0.712609   0.717591   2.10211    2.10211    2.102171   2.102181   2.102212   2.10236    2.102387   2.102387   2.102391   2.102489]
nelec by numeric integration = 14.000046128116757
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -158.18992666649126  Ecoul = 57.16282491809905  Exc = -12.97886109399058
cycle= 5 E= -108.547082140261  delta_E= 8.94e-08  |g|= 0.000769  |ddm|= 0.000241
    CPU time for cycle= 5      0.99 sec, wall time      0.02 sec
  HOMO = -0.263053659561922  LUMO = -0.235443159460272
  mo_energy =
[-14.533542 -14.533538  -0.745234  -0.744233  -0.264162  -0.263054  -0.263054  -0.235443  -0.235443  -0.234224   0.541985   0.546855   0.707142   0.711882
   0.711882   0.712609   0.712609   0.717591   2.10211    2.10211    2.102171   2.102181   2.102212   2.10236    2.102387   2.102387   2.102391   2.102489]
nelec by numeric integration = 14.000046128115631
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -158.1899264169919  Ecoul = 57.162824528809246  Exc = -12.978861044062466
cycle= 6 E= -108.547082230123  delta_E= -8.99e-08  |g|= 1.74e-05  |ddm|= 0.00024
    CPU time for cycle= 6      0.99 sec, wall time      0.02 sec
  HOMO = -0.263052966079707  LUMO = -0.235442771154913
  mo_energy =
[-14.533538 -14.533534  -0.745234  -0.744233  -0.264162  -0.263053  -0.263053  -0.235443  -0.235443  -0.234223   0.541984   0.546853   0.707141   0.711881
   0.711881   0.712608   0.712608   0.71759    2.102109   2.102109   2.102171   2.10218    2.102211   2.10236    2.102387   2.102387   2.10239    2.102489]
nelec by numeric integration = 14.000046128164962
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -158.18991674631235  Ecoul = 57.16281315687292  Exc = -12.978859342853617
cycle= 7 E= -108.547082230171  delta_E= -4.79e-11  |g|= 1.05e-07  |ddm|= 6.44e-06
    CPU time for cycle= 7      1.00 sec, wall time      0.02 sec
  HOMO = -0.263053004013751  LUMO = -0.235442807081
  mo_energy =
[-14.533538 -14.533534  -0.745234  -0.744233  -0.264162  -0.263053  -0.263053  -0.235443  -0.235443  -0.234223   0.541984   0.546853   0.707141   0.711881
   0.711881   0.712608   0.712608   0.71759    2.102109   2.102109   2.102171   2.10218    2.102211   2.10236    2.102387   2.102387   2.10239    2.102489]
nelec by numeric integration = 14.000046128165117
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -158.18991723058792  Ecoul = 57.16281371853022  Exc = -12.97885942023538
Extra cycle  E= -108.547082230171  delta_E= -4.26e-14  |g|= 6.7e-08  |ddm|= 1.56e-07
    CPU time for scf_cycle      9.68 sec, wall time      0.20 sec
    CPU time for SCF      9.70 sec, wall time      0.20 sec
converged SCF energy = -108.547082230171
             #0      #1      #2      #3      #4      #5     
  0 N 1s       0.700   0.700   0.220   0.221                
  0 N 2s                       0.475   0.476                
  0 N 3s                       0.300   0.299                
  0 N 2px                                              0.383
  0 N 2py                                              0.251
  0 N 2pz                                     -0.457        
  0 N 3px                                             -0.292
  0 N 3py                                             -0.192
  0 N 3pz                                      0.351        
  1 N 1s       0.700  -0.700   0.220  -0.221                
  1 N 2s                       0.475  -0.476                
  1 N 3s                       0.300  -0.299                
  1 N 2px                                              0.383
  1 N 2py                                              0.251
  1 N 2pz                                      0.457        
  1 N 3px                                             -0.292
  1 N 3py                                             -0.192
  1 N 3pz                                     -0.351        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                       0.216   0.216
  0 N 2s                                       1.145   1.146
  0 N 3s                                      -1.143  -1.145
  0 N 2px     -0.251   0.361  -0.283                        
  0 N 2py      0.383   0.283   0.361                        
  0 N 2pz                              0.460                
  0 N 3px      0.192  -0.275   0.216                        
  0 N 3py     -0.292  -0.216  -0.275                        
  0 N 3pz                             -0.349                
  1 N 1s                                       0.216  -0.216
  1 N 2s                                       1.145  -1.146
  1 N 3s                                      -1.143   1.145
  1 N 2px     -0.251  -0.361   0.283                        
  1 N 2py      0.383  -0.283  -0.361                        
  1 N 2pz                              0.460                
  1 N 3px      0.192   0.275  -0.216                        
  1 N 3py     -0.292   0.216   0.275                        
  1 N 3pz                             -0.349                
[-14.533538 -14.533534  -0.745234  -0.744233  -0.264162  -0.263053  -0.263053  -0.235443  -0.235443  -0.234223   0.541984   0.546853]
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 14.000046128165113
    CPU time for vxc      0.79 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 2.67  e= [0.430888]  max|de|= 0.431  lindep=    1
davidson 1 2  |r|= 0.475  e= [-0.11063]  max|de|= -0.542  lindep= 0.982
davidson 2 3  |r|= 0.235  e= [-0.237014]  max|de|= -0.126  lindep= 0.635
davidson 3 4  |r|= 0.0696  e= [-0.247139]  max|de|= -0.0101  lindep= 0.853
davidson 4 5  |r|= 0.01  e= [-0.247762]  max|de|= -0.000624  lindep= 0.897
davidson 5 6  |r|= 0.0138  e= [-0.247819]  max|de|= -5.7e-05  lindep= 0.522
davidson 6 7  |r|= 0.083  e= [-0.249405]  max|de|= -0.00159  lindep= 0.864
davidson 7 8  |r|= 0.0159  e= [-0.250457]  max|de|= -0.00105  lindep= 0.868
root 0 converged  |r|= 0.000631  e= -0.25048511726812334  max|de|= -2.84e-05
converged 8 9  |r|= 0.000631  e= [-0.250485]  max|de|= -2.84e-05
RHF/RKS wavefunction has an internal instability




******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpiobsvgzf
max_memory 4000 MB (current use 264 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2b8e2e583830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2b8e2e583cb0>
******** <class 'pyscf.dft.rks.RKS'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpiobsvgzf
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 264 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.256416433604341  LUMO = -0.226464701791828
Initial guess E= -108.611202327087  |g|= 0.0233638
macro= 0  E= -108.611516146075  delta_E= -0.000313819  |g|= 0.0233638  2 KF 6 JK
macro= 1  E= -108.611528362199  delta_E= -1.22161e-05  |g|= 0.000586285  2 KF 10 JK
macro= 2  E= -108.611528371837  delta_E= -9.63834e-09  |g|= 1.96413e-05  1 KF 5 JK
macro= 3  E= -108.61152839942  delta_E= -2.75826e-08  |g|= 0.000111511  1 KF 5 JK
macro= 4  E= -108.6115283995  delta_E= -8.05755e-11  |g|= 1.46754e-05  1 KF 3 JK
Canonicalize SCF orbitals
macro X = 5  E=-108.6115283995  |g|= 1.46754e-05  total 8 KF 35 JK
converged SCF energy = -108.6115283995
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 14.000045764226586
    CPU time for vxc      0.80 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 2.45  e= [1.590822]  max|de|= 1.59  lindep= 0.996
davidson 1 2  |r|=  2.2  e= [0.750347]  max|de|= -0.84  lindep= 0.184
davidson 2 3  |r|= 0.921  e= [0.142978]  max|de|= -0.607  lindep= 0.387
davidson 3 4  |r|= 0.564  e= [0.050751]  max|de|= -0.0922  lindep= 0.389
davidson 4 5  |r|= 0.0874  e= [0.00481]  max|de|= -0.0459  lindep= 0.671
davidson 5 6  |r|= 0.0143  e= [0.003457]  max|de|= -0.00135  lindep= 0.65
root 0 converged  |r|= 0.00592  e= 0.003408376415060086  max|de|= -4.87e-05
converged 6 7  |r|= 0.00592  e= [0.003408]  max|de|= -4.87e-05
RHF/RKS wavefunction is stable in the internal stability analysis
             #0      #1      #2      #3      #4      #5     
  0 N 1s       0.913  -0.383  -0.220   0.220                
  0 N 2s                      -0.472   0.473                
  0 N 3s                      -0.303   0.302                
  0 N 2px                                             -0.104
  0 N 2py                                             -0.649
  0 N 3py                                              0.478
  1 N 1s       0.383   0.913  -0.220  -0.220                
  1 N 2s                      -0.473  -0.473                
  1 N 3s                      -0.303  -0.302                
  1 N 2px                                     -0.649        
  1 N 2py                                      0.104        
  1 N 3px                                      0.478        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                       0.217  -0.217
  0 N 2s                                       1.146  -1.147
  0 N 3s                                      -1.142   1.144
  0 N 2px                             -0.623                
  0 N 2pz      0.455   0.458                                
  0 N 3px                              0.506                
  0 N 3pz     -0.353  -0.351                                
  1 N 1s                                       0.217   0.217
  1 N 2s                                       1.146   1.147
  1 N 3s                                      -1.143  -1.144
  1 N 2py                     -0.623                        
  1 N 2pz     -0.455   0.458                                
  1 N 3py                      0.506                        
  1 N 3pz      0.353  -0.351                                
[-14.52243  -14.522428  -0.735679  -0.735097  -0.28662   -0.28662   -0.258368  -0.228434  -0.192412  -0.192412   0.547408   0.552119]
scan 4.75, -108.611528
#INFO: **** input file is /share/home/srwang/pyAutoMR/examples/guess/N2-RKS.py ****
from pyscf import gto, dft
from automr import guess, dump_mat
import numpy as np
#mf=guess.from_fch_simp("v2.fchk", xc='pbe0')

#mf2.verbose=9
#mf2.stability()
for r in np.arange(3.0, 9.0, 0.25):
    mol = gto.Mole(atom='''N 0.0 0.0 0.0; N 0.0 0.0 %f'''%r, basis='def2-svp', verbose=5).build()
    mf = dft.RKS(mol)
    mf.xc = 'pbe0'
    mf.kernel()
    dump_mat.dump_mo(mol, mf.mo_coeff[:,:12])
    print(mf.mo_energy[:12])
    
    mf2 = guess.check_stab(mf, newton=True, res=True)
    dump_mat.dump_mo(mol, mf2.mo_coeff[:,:12])
    print(mf2.mo_energy[:12])
    print('scan %.2f, %.6f' % (r, mf2.e_tot))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='xc06n05', release='3.10.0-1127.el7.x86_64', version='#1 SMP Tue Feb 18 16:39:12 EST 2020', machine='x86_64', processor='x86_64')  Threads 48
Python 3.7.4 (default, Aug 13 2019, 20:35:49) 
[GCC 7.3.0]
numpy 1.17.2  scipy 1.4.1
Date: Thu Sep 16 17:44:02 2021
PySCF version 1.7.6a1
PySCF path  /share/home/srwang/pyscf/pyscf
GIT ORIG_HEAD 80f71dfe77ac5f9caae26788acf76446987635bd
GIT HEAD      ref: refs/heads/master
GIT master branch  80f71dfe77ac5f9caae26788acf76446987635bd

[ENV] PYSCF_EXT_PATH /share/home/srwang/pyscf_ext/fciqmc:
[CONFIG] conf_file /share/home/srwang/.pyscf_conf.py
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 2
[INPUT] num. electrons = 14
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 N      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 N      0.000000000000   0.000000000000   5.000000000000 AA    0.000000000000   0.000000000000   9.448630622825 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] N
[INPUT] 0    0    [5    /1   ]  1712.8415853      -0.0053934125305
                                257.64812677      -0.040221581118
                                58.458245853      -0.1793114499
                                16.198367905      -0.46376317823
                                5.0052600809      -0.44171422662
[INPUT] 0    0    [1    /1   ]  0.58731856571        1
[INPUT] 0    0    [1    /1   ]  0.18764592253        1
[INPUT] 1    0    [3    /1   ]  13.571470233      -0.040072398852
                                2.9257372874      -0.21807045028
                                0.79927750754     -0.51294466049
[INPUT] 1    0    [1    /1   ]  0.21954348034        1
[INPUT] 2    0    [1    /1   ]  1                    1

nuclear repulsion = 5.185936667016
number of shells = 12
number of NR pGTOs = 48
number of NR cGTOs = 28
basis = def2-svp
ecp = {}
CPU time:       542.11


******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpv1p5j12c
max_memory 4000 MB (current use 266 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2b8e2e583830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2b8e2e583cb0>
Set gradient conv threshold to 3.16228e-05
atom N rad-grids = 75, ang-grids = [ 50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  86  86  86  86  86  86  86  86  86 266 266 266 266 266 266 266
 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266]
tot grids = 28092
Drop grids 3406
    CPU time for setting up grids      0.29 sec, wall time      0.01 sec
nelec by numeric integration = 13.99175594359502
    CPU time for vxc      0.79 sec, wall time      0.02 sec
E1 = -158.66063013489045  Ecoul = 58.12504419976993  Exc = -13.113093400930904
init E= -108.462742669035
cond(S) = 10.414236366677324
    CPU time for initialize scf      1.84 sec, wall time      0.04 sec

WARN: HOMO -0.198269427876995 == LUMO -0.198216862029026

  mo_energy =
[-14.379116 -14.379115  -0.690165  -0.690057  -0.198653  -0.198269  -0.198269  -0.198217  -0.198217  -0.197838   0.576644   0.57886    0.752766   0.755066
   0.755066   0.755357   0.755357   0.757665   2.154458   2.154458   2.154458   2.154458   2.154464   2.154464   2.154489   2.154489   2.154524   2.154525]
nelec by numeric integration = 14.000033057008329
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -156.93133883493084  Ecoul = 56.070269008568054  Exc = -12.857975813429688
cycle= 1 E= -108.533108972776  delta_E= -0.0704  |g|= 0.198  |ddm|= 1.67
    CPU time for cycle= 1      1.01 sec, wall time      0.02 sec
  HOMO = -0.298646161357454  LUMO = -0.272504181122763
  mo_energy =
[-14.635489 -14.635485  -0.782222  -0.781427  -0.29936   -0.298646  -0.298646  -0.272504  -0.272504  -0.271718   0.520793   0.523329   0.680447   0.682803
   0.682803   0.68317    0.68317    0.685582   2.065715   2.065715   2.065765   2.065765   2.065789   2.065918   2.065943   2.065951   2.065951   2.066034]
nelec by numeric integration = 14.000034209118432
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -158.08480481679226  Ecoul = 57.411167118857264  Exc = -13.052191040731342
cycle= 2 E= -108.53989207165  delta_E= -0.00678  |g|= 0.122  |ddm|= 0.369
    CPU time for cycle= 2      0.98 sec, wall time      0.02 sec
  HOMO = -0.262241430690013  LUMO = -0.236044837332885
  mo_energy =
[-14.533262 -14.533257  -0.744968  -0.744163  -0.262992  -0.262241  -0.262241  -0.236045  -0.236045  -0.235231   0.543251   0.545749   0.70979    0.712101
   0.712101   0.712431   0.712431   0.714804   2.102211   2.102211   2.10226    2.102263   2.102288   2.102417   2.102442   2.102448   2.102448   2.102531]
nelec by numeric integration = 14.00003385322623
    CPU time for vxc      0.80 sec, wall time      0.02 sec
E1 = -157.64786038902344  Ecoul = 56.89517200271674  Exc = -12.977469032707608
cycle= 3 E= -108.544220751998  delta_E= -0.00433  |g|= 0.000381  |ddm|= 0.141
    CPU time for cycle= 3      0.97 sec, wall time      0.02 sec
  HOMO = -0.262142105395277  LUMO = -0.235929324647884
  mo_energy =
[-14.533042 -14.533037  -0.744914  -0.744104  -0.262893  -0.262142  -0.262142  -0.235929  -0.235929  -0.235109   0.543356   0.545858   0.709957   0.712265
   0.712265   0.71258    0.71258    0.714953   2.102361   2.102361   2.10241    2.102414   2.102438   2.102568   2.102592   2.102598   2.102598   2.102681]
nelec by numeric integration = 14.00003385485887
    CPU time for vxc      0.80 sec, wall time      0.02 sec
E1 = -157.6471430824282  Ecoul = 56.89436562606012  Exc = -12.977380011362214
cycle= 4 E= -108.544220800714  delta_E= -4.87e-08  |g|= 0.000111  |ddm|= 0.000563
    CPU time for cycle= 4      0.97 sec, wall time      0.02 sec
  HOMO = -0.262140803620941  LUMO = -0.235928712462688
  mo_energy =
[-14.533055 -14.53301   -0.744913  -0.744103  -0.262891  -0.262141  -0.262141  -0.235929  -0.235929  -0.235109   0.543354   0.545855   0.709954   0.712262
   0.712262   0.712578   0.712578   0.714952   2.102359   2.102359   2.102408   2.102411   2.102436   2.102568   2.102592   2.102598   2.102598   2.10268 ]
nelec by numeric integration = 14.000033854774417
    CPU time for vxc      0.80 sec, wall time      0.02 sec
E1 = -157.6471238765101  Ecoul = 56.89434822812016  Exc = -12.977377520333446
cycle= 5 E= -108.544216501707  delta_E= 4.3e-06  |g|= 0.00534  |ddm|= 0.00165
    CPU time for cycle= 5      0.97 sec, wall time      0.02 sec
  HOMO = -0.262140102537373  LUMO = -0.235928399047866
  mo_energy =
[-14.533031 -14.533026  -0.744912  -0.744102  -0.262891  -0.26214   -0.26214   -0.235928  -0.235928  -0.235108   0.543353   0.545854   0.709953   0.712261
   0.712261   0.712577   0.712577   0.714951   2.102359   2.102359   2.102408   2.102412   2.102436   2.102566   2.10259    2.102596   2.102596   2.102679]
nelec by numeric integration = 14.000033854729924
    CPU time for vxc      0.80 sec, wall time      0.02 sec
E1 = -157.64711355619224  Ecoul = 56.89433155907251  Exc = -12.977375472612367
cycle= 6 E= -108.544220802716  delta_E= -4.3e-06  |g|= 5.51e-06  |ddm|= 0.00162
    CPU time for cycle= 6      0.98 sec, wall time      0.02 sec
  HOMO = -0.262139381560709  LUMO = -0.235927961992485
  mo_energy =
[-14.533027 -14.533022  -0.744911  -0.744102  -0.26289   -0.262139  -0.262139  -0.235928  -0.235928  -0.235108   0.543352   0.545853   0.709952   0.71226
   0.71226    0.712576   0.712576   0.71495    2.102358   2.102358   2.102407   2.102412   2.102436   2.102566   2.10259    2.102596   2.102596   2.102679]
nelec by numeric integration = 14.000033854738692
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -157.6471035937509  Ecoul = 56.89431986951837  Exc = -12.977373745506075
cycle= 7 E= -108.544220802723  delta_E= -6.51e-12  |g|= 9.1e-08  |ddm|= 3.95e-06
    CPU time for cycle= 7      0.98 sec, wall time      0.02 sec
  HOMO = -0.26213941222126  LUMO = -0.235927991863892
  mo_energy =
[-14.533027 -14.533022  -0.744911  -0.744102  -0.26289   -0.262139  -0.262139  -0.235928  -0.235928  -0.235108   0.543352   0.545853   0.709952   0.71226
   0.71226    0.712576   0.712576   0.71495    2.102358   2.102358   2.102407   2.102412   2.102436   2.102566   2.10259    2.102596   2.102596   2.102679]
nelec by numeric integration = 14.000033854739486
    CPU time for vxc      0.81 sec, wall time      0.02 sec
E1 = -157.6471039849718  Ecoul = 56.89432032290714  Exc = -12.97737380767394
Extra cycle  E= -108.544220802723  delta_E=    0  |g|= 8.7e-08  |ddm|= 1.3e-07
    CPU time for scf_cycle      9.68 sec, wall time      0.20 sec
    CPU time for SCF      9.70 sec, wall time      0.20 sec
converged SCF energy = -108.544220802723
             #0      #1      #2      #3      #4      #5     
  0 N 1s       0.700   0.700   0.220   0.220                
  0 N 2s                       0.475   0.476                
  0 N 3s                       0.300   0.300                
  0 N 2px                                              0.230
  0 N 2py                                              0.396
  0 N 2pz                                     -0.458        
  0 N 3px                                             -0.175
  0 N 3py                                             -0.302
  0 N 3pz                                      0.350        
  1 N 1s       0.700  -0.700   0.220  -0.220                
  1 N 2s                       0.475  -0.476                
  1 N 3s                       0.300  -0.300                
  1 N 2px                                              0.230
  1 N 2py                                              0.396
  1 N 2pz                                      0.458        
  1 N 3px                                             -0.175
  1 N 3py                                             -0.302
  1 N 3pz                                     -0.350        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                       0.216   0.216
  0 N 2s                                       1.146   1.146
  0 N 3s                                      -1.144  -1.145
  0 N 2px      0.396   0.231   0.396                        
  0 N 2py     -0.230   0.396  -0.231                        
  0 N 2pz                              0.459                
  0 N 3px     -0.302  -0.176  -0.302                        
  0 N 3py      0.175  -0.302   0.176                        
  0 N 3pz                             -0.349                
  1 N 1s                                       0.216  -0.216
  1 N 2s                                       1.146  -1.146
  1 N 3s                                      -1.144   1.145
  1 N 2px      0.396  -0.231  -0.396                        
  1 N 2py     -0.230  -0.396   0.231                        
  1 N 2pz                              0.459                
  1 N 3px     -0.302   0.176   0.302                        
  1 N 3py      0.175   0.302  -0.176                        
  1 N 3pz                             -0.349                
[-14.533027 -14.533022  -0.744911  -0.744102  -0.26289   -0.262139  -0.262139  -0.235928  -0.235928  -0.235108   0.543352   0.545853]
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 14.000033854739486
    CPU time for vxc      0.78 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 2.65  e= [0.410201]  max|de|= 0.41  lindep=    1
davidson 1 2  |r|= 0.487  e= [-0.114173]  max|de|= -0.524  lindep= 0.984
davidson 2 3  |r|= 0.232  e= [-0.243908]  max|de|= -0.13  lindep= 0.648
davidson 3 4  |r|= 0.0624  e= [-0.253653]  max|de|= -0.00974  lindep= 0.855
davidson 4 5  |r|= 0.00959  e= [-0.254125]  max|de|= -0.000472  lindep= 0.93
root 0 converged  |r|= 0.00627  e= -0.25415068398689766  max|de|= -2.52e-05
converged 5 6  |r|= 0.00627  e= [-0.254151]  max|de|= -2.52e-05
RHF/RKS wavefunction has an internal instability




******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpv1p5j12c
max_memory 4000 MB (current use 266 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2b8e2e583830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2b8e2e583cb0>
******** <class 'pyscf.dft.rks.RKS'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpv1p5j12c
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 266 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.331696149101069  LUMO = -0.144699787911114
Initial guess E= -103.909492621256  |g|= 2.24445
macro= 0  E= -105.093949710634  delta_E= -1.18446  |g|= 0.225178  3 KF 11 JK
macro= 1  E= -105.094592842331  delta_E= -0.000643132  |g|= 0.00753799  3 KF 10 JK
macro= 2  E= -105.09459267741  delta_E= 1.64921e-07  |g|= 6.40921e-05  2 KF 6 JK
macro= 3  E= -105.09459267741  delta_E= 2.84217e-14  |g|= 9.53328e-06  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 4  E=-105.09459267741  |g|= 9.53328e-06  total 10 KF 34 JK

WARN: HOMO 0.6752116243328927 > LUMO -1.6988171907649967 was found in the canonicalized orbitals.

converged SCF energy = -105.09459267741
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 14.000025665527936
    CPU time for vxc      0.80 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 0.314  e= [-0.202567]  max|de|= -0.203  lindep= 0.916
davidson 1 2  |r|= 0.0954  e= [-0.210796]  max|de|= -0.00823  lindep= 0.55
davidson 2 3  |r|= 0.199  e= [-0.215786]  max|de|= -0.00499  lindep= 0.471
davidson 3 4  |r|= 0.0754  e= [-0.222169]  max|de|= -0.00638  lindep= 0.838
davidson 4 5  |r|= 0.0507  e= [-0.223889]  max|de|= -0.00172  lindep= 0.493
davidson 5 6  |r|= 0.33  e= [-0.228029]  max|de|= -0.00414  lindep= 0.518
davidson 6 7  |r|= 4.43  e= [-1.123526]  max|de|= -0.895  lindep= 0.518
Large |r| detected, restore to previous x0
davidson 7 1  |r|= 0.33  e= [-0.228029]  max|de|= 0.895  lindep= 0.944
davidson 8 2  |r|= 4.62  e= [-0.788466]  max|de|= -0.56  lindep= 0.944
Large |r| detected, restore to previous x0
davidson 9 1  |r|= 0.33  e= [-0.228029]  max|de|= 0.56  lindep= 0.944
davidson 10 2  |r|= 4.62  e= [-0.788466]  max|de|= -0.56  lindep= 0.944
Large |r| detected, restore to previous x0
davidson 11 1  |r|= 0.33  e= [-0.228029]  max|de|= 0.56  lindep= 0.944
davidson 12 2  |r|= 4.62  e= [-0.788466]  max|de|= -0.56  lindep= 0.944
Large |r| detected, restore to previous x0
davidson 13 1  |r|= 0.33  e= [-0.228029]  max|de|= 0.56  lindep= 0.944
davidson 14 2  |r|= 4.62  e= [-0.788466]  max|de|= -0.56  lindep= 0.944
Large |r| detected, restore to previous x0
davidson 15 1  |r|= 0.33  e= [-0.228029]  max|de|= 0.56  lindep= 0.944
davidson 16 2  |r|= 4.62  e= [-0.788466]  max|de|= -0.56  lindep= 0.944
Large |r| detected, restore to previous x0
davidson 17 1  |r|= 0.33  e= [-0.228029]  max|de|= 0.56  lindep= 0.944
davidson 18 2  |r|= 4.62  e= [-0.788466]  max|de|= -0.56  lindep= 0.944
Large |r| detected, restore to previous x0
davidson 19 1  |r|= 0.33  e= [-0.228029]  max|de|= 0.56  lindep= 0.944
davidson 20 2  |r|= 4.62  e= [-0.788466]  max|de|= -0.56  lindep= 0.944
Large |r| detected, restore to previous x0
davidson 21 1  |r|= 0.33  e= [-0.228029]  max|de|= 0.56  lindep= 0.944
davidson 22 2  |r|= 4.62  e= [-0.788466]  max|de|= -0.56  lindep= 0.944
Large |r| detected, restore to previous x0
davidson 23 1  |r|= 0.33  e= [-0.228029]  max|de|= 0.56  lindep= 0.944
davidson 24 2  |r|= 4.62  e= [-0.788466]  max|de|= -0.56  lindep= 0.944
Large |r| detected, restore to previous x0
davidson 25 1  |r|= 0.33  e= [-0.228029]  max|de|= 0.56  lindep= 0.944
davidson 26 2  |r|= 4.62  e= [-0.788466]  max|de|= -0.56  lindep= 0.944
Large |r| detected, restore to previous x0
davidson 27 1  |r|= 0.33  e= [-0.228029]  max|de|= 0.56  lindep= 0.944
davidson 28 2  |r|= 4.62  e= [-0.788466]  max|de|= -0.56  lindep= 0.944
Large |r| detected, restore to previous x0
davidson 29 1  |r|= 0.33  e= [-0.228029]  max|de|= 0.56  lindep= 0.944
davidson 30 2  |r|= 4.62  e= [-0.788466]  max|de|= -0.56  lindep= 0.944
Large |r| detected, restore to previous x0
davidson 31 1  |r|= 0.33  e= [-0.228029]  max|de|= 0.56  lindep= 0.944
davidson 32 2  |r|= 4.62  e= [-0.788466]  max|de|= -0.56  lindep= 0.944
Large |r| detected, restore to previous x0
davidson 33 1  |r|= 0.33  e= [-0.228029]  max|de|= 0.56  lindep= 0.944
davidson 34 2  |r|= 4.62  e= [-0.788466]  max|de|= -0.56  lindep= 0.944
Large |r| detected, restore to previous x0
davidson 35 1  |r|= 0.33  e= [-0.228029]  max|de|= 0.56  lindep= 0.944
davidson 36 2  |r|= 4.62  e= [-0.788466]  max|de|= -0.56  lindep= 0.944
Large |r| detected, restore to previous x0
davidson 37 1  |r|= 0.33  e= [-0.228029]  max|de|= 0.56  lindep= 0.944
davidson 38 2  |r|= 4.62  e= [-0.788466]  max|de|= -0.56  lindep= 0.944
Large |r| detected, restore to previous x0
davidson 39 1  |r|= 0.33  e= [-0.228029]  max|de|= 0.56  lindep= 0.944
davidson 40 2  |r|= 4.62  e= [-0.788466]  max|de|= -0.56  lindep= 0.944
Large |r| detected, restore to previous x0
davidson 41 1  |r|= 0.33  e= [-0.228029]  max|de|= 0.56  lindep= 0.944
davidson 42 2  |r|= 4.62  e= [-0.788466]  max|de|= -0.56  lindep= 0.944
Large |r| detected, restore to previous x0
davidson 43 1  |r|= 0.33  e= [-0.228029]  max|de|= 0.56  lindep= 0.944
davidson 44 2  |r|= 4.62  e= [-0.788466]  max|de|= -0.56  lindep= 0.944
Large |r| detected, restore to previous x0
davidson 45 1  |r|= 0.33  e= [-0.228029]  max|de|= 0.56  lindep= 0.944
davidson 46 2  |r|= 4.62  e= [-0.788466]  max|de|= -0.56  lindep= 0.944
Large |r| detected, restore to previous x0
davidson 47 1  |r|= 0.33  e= [-0.228029]  max|de|= 0.56  lindep= 0.944
davidson 48 2  |r|= 4.62  e= [-0.788466]  max|de|= -0.56  lindep= 0.944
Large |r| detected, restore to previous x0
davidson 49 1  |r|= 0.33  e= [-0.228029]  max|de|= 0.56  lindep= 0.944
RHF/RKS wavefunction has an internal instability




******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpv1p5j12c
max_memory 4000 MB (current use 266 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2b8e2e583830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2b8e2e583cb0>
******** <class 'pyscf.dft.rks.RKS'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpv1p5j12c
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 266 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.337804518799224  LUMO = 0.0795846949701542
Initial guess E= -102.600478730692  |g|= 2.97968
macro= 0  E= -105.019179442617  delta_E= -2.4187  |g|= 0.543795  3 KF 16 JK
macro= 1  E= -105.094590139804  delta_E= -0.0754107  |g|= 0.0600921  3 KF 9 JK
macro= 2  E= -105.094592677412  delta_E= -2.53761e-06  |g|= 0.000143407  2 KF 9 JK
macro= 3  E= -105.094592677412  delta_E= 0  |g|= 1.75507e-06  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 4  E=-105.094592677412  |g|= 1.75507e-06  total 10 KF 41 JK

WARN: HOMO 0.6752120382516067 > LUMO -1.6988171346331284 was found in the canonicalized orbitals.

converged SCF energy = -105.094592677412
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 14.000025665557283
    CPU time for vxc      0.79 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 0.304  e= [-0.202767]  max|de|= -0.203  lindep= 0.92
davidson 1 2  |r|= 0.108  e= [-0.211527]  max|de|= -0.00876  lindep= 0.598
davidson 2 3  |r|= 0.174  e= [-0.218584]  max|de|= -0.00706  lindep= 0.632
davidson 3 4  |r|= 0.0754  e= [-0.222686]  max|de|= -0.0041  lindep= 0.722
davidson 4 5  |r|= 0.0523  e= [-0.223892]  max|de|= -0.00121  lindep= 0.426
davidson 5 6  |r|= 0.374  e= [-0.228339]  max|de|= -0.00445  lindep= 0.491
davidson 6 7  |r|= 4.61  e= [-1.167511]  max|de|= -0.939  lindep= 0.491
Large |r| detected, restore to previous x0
davidson 7 1  |r|= 0.374  e= [-0.228339]  max|de|= 0.939  lindep= 0.931
davidson 8 2  |r|= 4.68  e= [-0.789896]  max|de|= -0.562  lindep= 0.931
Large |r| detected, restore to previous x0
davidson 9 1  |r|= 0.374  e= [-0.228339]  max|de|= 0.562  lindep= 0.931
davidson 10 2  |r|= 4.68  e= [-0.789896]  max|de|= -0.562  lindep= 0.931
Large |r| detected, restore to previous x0
davidson 11 1  |r|= 0.374  e= [-0.228339]  max|de|= 0.562  lindep= 0.931
davidson 12 2  |r|= 4.68  e= [-0.789896]  max|de|= -0.562  lindep= 0.931
Large |r| detected, restore to previous x0
davidson 13 1  |r|= 0.374  e= [-0.228339]  max|de|= 0.562  lindep= 0.931
davidson 14 2  |r|= 4.68  e= [-0.789896]  max|de|= -0.562  lindep= 0.931
Large |r| detected, restore to previous x0
davidson 15 1  |r|= 0.374  e= [-0.228339]  max|de|= 0.562  lindep= 0.931
davidson 16 2  |r|= 4.68  e= [-0.789896]  max|de|= -0.562  lindep= 0.931
Large |r| detected, restore to previous x0
davidson 17 1  |r|= 0.374  e= [-0.228339]  max|de|= 0.562  lindep= 0.931
davidson 18 2  |r|= 4.68  e= [-0.789896]  max|de|= -0.562  lindep= 0.931
Large |r| detected, restore to previous x0
davidson 19 1  |r|= 0.374  e= [-0.228339]  max|de|= 0.562  lindep= 0.931
davidson 20 2  |r|= 4.68  e= [-0.789896]  max|de|= -0.562  lindep= 0.931
Large |r| detected, restore to previous x0
davidson 21 1  |r|= 0.374  e= [-0.228339]  max|de|= 0.562  lindep= 0.931
davidson 22 2  |r|= 4.68  e= [-0.789896]  max|de|= -0.562  lindep= 0.931
Large |r| detected, restore to previous x0
davidson 23 1  |r|= 0.374  e= [-0.228339]  max|de|= 0.562  lindep= 0.931
davidson 24 2  |r|= 4.68  e= [-0.789896]  max|de|= -0.562  lindep= 0.931
Large |r| detected, restore to previous x0
davidson 25 1  |r|= 0.374  e= [-0.228339]  max|de|= 0.562  lindep= 0.931
davidson 26 2  |r|= 4.68  e= [-0.789896]  max|de|= -0.562  lindep= 0.931
Large |r| detected, restore to previous x0
davidson 27 1  |r|= 0.374  e= [-0.228339]  max|de|= 0.562  lindep= 0.931
davidson 28 2  |r|= 4.68  e= [-0.789896]  max|de|= -0.562  lindep= 0.931
Large |r| detected, restore to previous x0
davidson 29 1  |r|= 0.374  e= [-0.228339]  max|de|= 0.562  lindep= 0.931
davidson 30 2  |r|= 4.68  e= [-0.789896]  max|de|= -0.562  lindep= 0.931
Large |r| detected, restore to previous x0
davidson 31 1  |r|= 0.374  e= [-0.228339]  max|de|= 0.562  lindep= 0.931
davidson 32 2  |r|= 4.68  e= [-0.789896]  max|de|= -0.562  lindep= 0.931
Large |r| detected, restore to previous x0
davidson 33 1  |r|= 0.374  e= [-0.228339]  max|de|= 0.562  lindep= 0.931
davidson 34 2  |r|= 4.68  e= [-0.789896]  max|de|= -0.562  lindep= 0.931
Large |r| detected, restore to previous x0
davidson 35 1  |r|= 0.374  e= [-0.228339]  max|de|= 0.562  lindep= 0.931
davidson 36 2  |r|= 4.68  e= [-0.789896]  max|de|= -0.562  lindep= 0.931
Large |r| detected, restore to previous x0
davidson 37 1  |r|= 0.374  e= [-0.228339]  max|de|= 0.562  lindep= 0.931
davidson 38 2  |r|= 4.68  e= [-0.789896]  max|de|= -0.562  lindep= 0.931
Large |r| detected, restore to previous x0
davidson 39 1  |r|= 0.374  e= [-0.228339]  max|de|= 0.562  lindep= 0.931
davidson 40 2  |r|= 4.68  e= [-0.789896]  max|de|= -0.562  lindep= 0.931
Large |r| detected, restore to previous x0
davidson 41 1  |r|= 0.374  e= [-0.228339]  max|de|= 0.562  lindep= 0.931
davidson 42 2  |r|= 4.68  e= [-0.789896]  max|de|= -0.562  lindep= 0.931
Large |r| detected, restore to previous x0
davidson 43 1  |r|= 0.374  e= [-0.228339]  max|de|= 0.562  lindep= 0.931
davidson 44 2  |r|= 4.68  e= [-0.789896]  max|de|= -0.562  lindep= 0.931
Large |r| detected, restore to previous x0
davidson 45 1  |r|= 0.374  e= [-0.228339]  max|de|= 0.562  lindep= 0.931
davidson 46 2  |r|= 4.68  e= [-0.789896]  max|de|= -0.562  lindep= 0.931
Large |r| detected, restore to previous x0
davidson 47 1  |r|= 0.374  e= [-0.228339]  max|de|= 0.562  lindep= 0.931
davidson 48 2  |r|= 4.68  e= [-0.789896]  max|de|= -0.562  lindep= 0.931
Large |r| detected, restore to previous x0
davidson 49 1  |r|= 0.374  e= [-0.228339]  max|de|= 0.562  lindep= 0.931
RHF/RKS wavefunction has an internal instability




******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpv1p5j12c
max_memory 4000 MB (current use 266 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2b8e2e583830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2b8e2e583cb0>
******** <class 'pyscf.dft.rks.RKS'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpv1p5j12c
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 266 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.337805510611158  LUMO = 0.0802330713923491
Initial guess E= -102.604801571024  |g|= 2.978
macro= 0  E= -105.016256384115  delta_E= -2.41145  |g|= 0.546713  3 KF 17 JK
macro= 1  E= -105.094587070569  delta_E= -0.0783307  |g|= 0.0792086  3 KF 9 JK
macro= 2  E= -105.094592677412  delta_E= -5.60684e-06  |g|= 1.47509e-05  3 KF 10 JK
macro= 3  E= -105.094592677412  delta_E= 2.84217e-14  |g|= 8.054e-06  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 4  E=-105.094592677412  |g|= 8.054e-06  total 11 KF 43 JK

WARN: HOMO 0.6752118519058553 > LUMO -1.6988170453956364 was found in the canonicalized orbitals.

converged SCF energy = -105.094592677412
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 14.000025665533203
    CPU time for vxc      0.79 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 0.308  e= [-0.202787]  max|de|= -0.203  lindep= 0.92
davidson 1 2  |r|= 0.114  e= [-0.211528]  max|de|= -0.00874  lindep= 0.602
davidson 2 3  |r|= 0.165  e= [-0.21856]  max|de|= -0.00703  lindep= 0.632
davidson 3 4  |r|= 0.0769  e= [-0.222691]  max|de|= -0.00413  lindep= 0.724
davidson 4 5  |r|= 0.0504  e= [-0.22389]  max|de|= -0.0012  lindep= 0.426
davidson 5 6  |r|= 0.403  e= [-0.228716]  max|de|= -0.00483  lindep= 0.464
davidson 6 7  |r|= 4.45  e= [-1.245147]  max|de|= -1.02  lindep= 0.464
Large |r| detected, restore to previous x0
davidson 7 1  |r|= 0.403  e= [-0.228716]  max|de|= 1.02  lindep= 0.915
davidson 8 2  |r|= 4.57  e= [-0.806459]  max|de|= -0.578  lindep= 0.915
Large |r| detected, restore to previous x0
davidson 9 1  |r|= 0.403  e= [-0.228716]  max|de|= 0.578  lindep= 0.915
davidson 10 2  |r|= 4.57  e= [-0.806459]  max|de|= -0.578  lindep= 0.915
Large |r| detected, restore to previous x0
davidson 11 1  |r|= 0.403  e= [-0.228716]  max|de|= 0.578  lindep= 0.915
davidson 12 2  |r|= 4.57  e= [-0.806459]  max|de|= -0.578  lindep= 0.915
Large |r| detected, restore to previous x0
davidson 13 1  |r|= 0.403  e= [-0.228716]  max|de|= 0.578  lindep= 0.915
davidson 14 2  |r|= 4.57  e= [-0.806459]  max|de|= -0.578  lindep= 0.915
Large |r| detected, restore to previous x0
davidson 15 1  |r|= 0.403  e= [-0.228716]  max|de|= 0.578  lindep= 0.915
davidson 16 2  |r|= 4.57  e= [-0.806459]  max|de|= -0.578  lindep= 0.915
Large |r| detected, restore to previous x0
davidson 17 1  |r|= 0.403  e= [-0.228716]  max|de|= 0.578  lindep= 0.915
davidson 18 2  |r|= 4.57  e= [-0.806459]  max|de|= -0.578  lindep= 0.915
Large |r| detected, restore to previous x0
davidson 19 1  |r|= 0.403  e= [-0.228716]  max|de|= 0.578  lindep= 0.915
davidson 20 2  |r|= 4.57  e= [-0.806459]  max|de|= -0.578  lindep= 0.915
Large |r| detected, restore to previous x0
davidson 21 1  |r|= 0.403  e= [-0.228716]  max|de|= 0.578  lindep= 0.915
davidson 22 2  |r|= 4.57  e= [-0.806459]  max|de|= -0.578  lindep= 0.915
Large |r| detected, restore to previous x0
davidson 23 1  |r|= 0.403  e= [-0.228716]  max|de|= 0.578  lindep= 0.915
davidson 24 2  |r|= 4.57  e= [-0.806459]  max|de|= -0.578  lindep= 0.915
Large |r| detected, restore to previous x0
davidson 25 1  |r|= 0.403  e= [-0.228716]  max|de|= 0.578  lindep= 0.915
davidson 26 2  |r|= 4.57  e= [-0.806459]  max|de|= -0.578  lindep= 0.915
Large |r| detected, restore to previous x0
davidson 27 1  |r|= 0.403  e= [-0.228716]  max|de|= 0.578  lindep= 0.915
davidson 28 2  |r|= 4.57  e= [-0.806459]  max|de|= -0.578  lindep= 0.915
Large |r| detected, restore to previous x0
davidson 29 1  |r|= 0.403  e= [-0.228716]  max|de|= 0.578  lindep= 0.915
davidson 30 2  |r|= 4.57  e= [-0.806459]  max|de|= -0.578  lindep= 0.915
Large |r| detected, restore to previous x0
davidson 31 1  |r|= 0.403  e= [-0.228716]  max|de|= 0.578  lindep= 0.915
davidson 32 2  |r|= 4.57  e= [-0.806459]  max|de|= -0.578  lindep= 0.915
Large |r| detected, restore to previous x0
davidson 33 1  |r|= 0.403  e= [-0.228716]  max|de|= 0.578  lindep= 0.915
davidson 34 2  |r|= 4.57  e= [-0.806459]  max|de|= -0.578  lindep= 0.915
Large |r| detected, restore to previous x0
davidson 35 1  |r|= 0.403  e= [-0.228716]  max|de|= 0.578  lindep= 0.915
davidson 36 2  |r|= 4.57  e= [-0.806459]  max|de|= -0.578  lindep= 0.915
Large |r| detected, restore to previous x0
davidson 37 1  |r|= 0.403  e= [-0.228716]  max|de|= 0.578  lindep= 0.915
davidson 38 2  |r|= 4.57  e= [-0.806459]  max|de|= -0.578  lindep= 0.915
Large |r| detected, restore to previous x0
davidson 39 1  |r|= 0.403  e= [-0.228716]  max|de|= 0.578  lindep= 0.915
davidson 40 2  |r|= 4.57  e= [-0.806459]  max|de|= -0.578  lindep= 0.915
Large |r| detected, restore to previous x0
davidson 41 1  |r|= 0.403  e= [-0.228716]  max|de|= 0.578  lindep= 0.915
davidson 42 2  |r|= 4.57  e= [-0.806459]  max|de|= -0.578  lindep= 0.915
Large |r| detected, restore to previous x0
davidson 43 1  |r|= 0.403  e= [-0.228716]  max|de|= 0.578  lindep= 0.915
davidson 44 2  |r|= 4.57  e= [-0.806459]  max|de|= -0.578  lindep= 0.915
Large |r| detected, restore to previous x0
davidson 45 1  |r|= 0.403  e= [-0.228716]  max|de|= 0.578  lindep= 0.915
davidson 46 2  |r|= 4.57  e= [-0.806459]  max|de|= -0.578  lindep= 0.915
Large |r| detected, restore to previous x0
davidson 47 1  |r|= 0.403  e= [-0.228716]  max|de|= 0.578  lindep= 0.915
davidson 48 2  |r|= 4.57  e= [-0.806459]  max|de|= -0.578  lindep= 0.915
Large |r| detected, restore to previous x0
davidson 49 1  |r|= 0.403  e= [-0.228716]  max|de|= 0.578  lindep= 0.915
RHF/RKS wavefunction has an internal instability




******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpv1p5j12c
max_memory 4000 MB (current use 266 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2b8e2e583830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2b8e2e583cb0>
******** <class 'pyscf.dft.rks.RKS'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpv1p5j12c
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 266 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.338962112799883  LUMO = 0.0831616142440663
Initial guess E= -102.617557938158  |g|= 2.97288
macro= 0  E= -105.011217849194  delta_E= -2.39366  |g|= 0.551688  3 KF 16 JK
macro= 1  E= -105.090832086611  delta_E= -0.0796142  |g|= 0.459287  2 KF 6 JK
macro= 2  E= -105.09459267758  delta_E= -0.00376059  |g|= 3.90536e-05  3 KF 12 JK
macro= 3  E= -105.094592677457  delta_E= 1.22355e-10  |g|= 4.29339e-06  1 KF 6 JK
Canonicalize SCF orbitals
macro X = 4  E=-105.094592677457  |g|= 4.29339e-06  total 10 KF 45 JK

WARN: HOMO 0.6752121105958528 > LUMO -1.698817258398254 was found in the canonicalized orbitals.

converged SCF energy = -105.094592677457
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 14.000025665601642
    CPU time for vxc      0.79 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 0.303  e= [-0.202818]  max|de|= -0.203  lindep= 0.921
davidson 1 2  |r|= 0.114  e= [-0.211638]  max|de|= -0.00882  lindep= 0.613
davidson 2 3  |r|= 0.162  e= [-0.21883]  max|de|= -0.00719  lindep= 0.662
davidson 3 4  |r|= 0.0736  e= [-0.222911]  max|de|= -0.00408  lindep= 0.711
davidson 4 5  |r|= 0.0487  e= [-0.223884]  max|de|= -0.000973  lindep= 0.395
davidson 5 6  |r|= 0.364  e= [-0.228462]  max|de|= -0.00458  lindep= 0.474
davidson 6 7  |r|= 4.28  e= [-1.282476]  max|de|= -1.05  lindep= 0.474
Large |r| detected, restore to previous x0
davidson 7 1  |r|= 0.364  e= [-0.228462]  max|de|= 1.05  lindep= 0.924
davidson 8 2  |r|= 4.45  e= [-0.821136]  max|de|= -0.593  lindep= 0.924
Large |r| detected, restore to previous x0
davidson 9 1  |r|= 0.364  e= [-0.228462]  max|de|= 0.593  lindep= 0.924
davidson 10 2  |r|= 4.45  e= [-0.821136]  max|de|= -0.593  lindep= 0.924
Large |r| detected, restore to previous x0
davidson 11 1  |r|= 0.364  e= [-0.228462]  max|de|= 0.593  lindep= 0.924
davidson 12 2  |r|= 4.45  e= [-0.821136]  max|de|= -0.593  lindep= 0.924
Large |r| detected, restore to previous x0
davidson 13 1  |r|= 0.364  e= [-0.228462]  max|de|= 0.593  lindep= 0.924
davidson 14 2  |r|= 4.45  e= [-0.821136]  max|de|= -0.593  lindep= 0.924
Large |r| detected, restore to previous x0
davidson 15 1  |r|= 0.364  e= [-0.228462]  max|de|= 0.593  lindep= 0.924
davidson 16 2  |r|= 4.45  e= [-0.821136]  max|de|= -0.593  lindep= 0.924
Large |r| detected, restore to previous x0
davidson 17 1  |r|= 0.364  e= [-0.228462]  max|de|= 0.593  lindep= 0.924
davidson 18 2  |r|= 4.45  e= [-0.821136]  max|de|= -0.593  lindep= 0.924
Large |r| detected, restore to previous x0
davidson 19 1  |r|= 0.364  e= [-0.228462]  max|de|= 0.593  lindep= 0.924
davidson 20 2  |r|= 4.45  e= [-0.821136]  max|de|= -0.593  lindep= 0.924
Large |r| detected, restore to previous x0
davidson 21 1  |r|= 0.364  e= [-0.228462]  max|de|= 0.593  lindep= 0.924
davidson 22 2  |r|= 4.45  e= [-0.821136]  max|de|= -0.593  lindep= 0.924
Large |r| detected, restore to previous x0
davidson 23 1  |r|= 0.364  e= [-0.228462]  max|de|= 0.593  lindep= 0.924
davidson 24 2  |r|= 4.45  e= [-0.821136]  max|de|= -0.593  lindep= 0.924
Large |r| detected, restore to previous x0
davidson 25 1  |r|= 0.364  e= [-0.228462]  max|de|= 0.593  lindep= 0.924
davidson 26 2  |r|= 4.45  e= [-0.821136]  max|de|= -0.593  lindep= 0.924
Large |r| detected, restore to previous x0
davidson 27 1  |r|= 0.364  e= [-0.228462]  max|de|= 0.593  lindep= 0.924
davidson 28 2  |r|= 4.45  e= [-0.821136]  max|de|= -0.593  lindep= 0.924
Large |r| detected, restore to previous x0
davidson 29 1  |r|= 0.364  e= [-0.228462]  max|de|= 0.593  lindep= 0.924
davidson 30 2  |r|= 4.45  e= [-0.821136]  max|de|= -0.593  lindep= 0.924
Large |r| detected, restore to previous x0
davidson 31 1  |r|= 0.364  e= [-0.228462]  max|de|= 0.593  lindep= 0.924
davidson 32 2  |r|= 4.45  e= [-0.821136]  max|de|= -0.593  lindep= 0.924
Large |r| detected, restore to previous x0
davidson 33 1  |r|= 0.364  e= [-0.228462]  max|de|= 0.593  lindep= 0.924
davidson 34 2  |r|= 4.45  e= [-0.821136]  max|de|= -0.593  lindep= 0.924
Large |r| detected, restore to previous x0
davidson 35 1  |r|= 0.364  e= [-0.228462]  max|de|= 0.593  lindep= 0.924
davidson 36 2  |r|= 4.45  e= [-0.821136]  max|de|= -0.593  lindep= 0.924
Large |r| detected, restore to previous x0
davidson 37 1  |r|= 0.364  e= [-0.228462]  max|de|= 0.593  lindep= 0.924
davidson 38 2  |r|= 4.45  e= [-0.821136]  max|de|= -0.593  lindep= 0.924
Large |r| detected, restore to previous x0
davidson 39 1  |r|= 0.364  e= [-0.228462]  max|de|= 0.593  lindep= 0.924
davidson 40 2  |r|= 4.45  e= [-0.821136]  max|de|= -0.593  lindep= 0.924
Large |r| detected, restore to previous x0
davidson 41 1  |r|= 0.364  e= [-0.228462]  max|de|= 0.593  lindep= 0.924
davidson 42 2  |r|= 4.45  e= [-0.821136]  max|de|= -0.593  lindep= 0.924
Large |r| detected, restore to previous x0
davidson 43 1  |r|= 0.364  e= [-0.228462]  max|de|= 0.593  lindep= 0.924
davidson 44 2  |r|= 4.45  e= [-0.821136]  max|de|= -0.593  lindep= 0.924
Large |r| detected, restore to previous x0
davidson 45 1  |r|= 0.364  e= [-0.228462]  max|de|= 0.593  lindep= 0.924
davidson 46 2  |r|= 4.45  e= [-0.821136]  max|de|= -0.593  lindep= 0.924
Large |r| detected, restore to previous x0
davidson 47 1  |r|= 0.364  e= [-0.228462]  max|de|= 0.593  lindep= 0.924
davidson 48 2  |r|= 4.45  e= [-0.821136]  max|de|= -0.593  lindep= 0.924
Large |r| detected, restore to previous x0
davidson 49 1  |r|= 0.364  e= [-0.228462]  max|de|= 0.593  lindep= 0.924
RHF/RKS wavefunction has an internal instability




******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpv1p5j12c
max_memory 4000 MB (current use 266 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2b8e2e583830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2b8e2e583cb0>
******** <class 'pyscf.dft.rks.RKS'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpv1p5j12c
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 266 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.337315933130507  LUMO = 0.0808535451644817
Initial guess E= -102.602113024852  |g|= 2.97908
macro= 0  E= -105.04878547014  delta_E= -2.44667  |g|= 0.482544  3 KF 16 JK
macro= 1  E= -105.094572906467  delta_E= -0.0457874  |g|= 0.0255072  3 KF 9 JK
macro= 2  E= -105.094592677488  delta_E= -1.9771e-05  |g|= 0.000319822  2 KF 9 JK
macro= 3  E= -105.094592677422  delta_E= 6.59952e-11  |g|= 1.17294e-05  1 KF 3 JK
Canonicalize SCF orbitals
macro X = 4  E=-105.094592677422  |g|= 1.17294e-05  total 10 KF 42 JK

WARN: HOMO 0.6752122826004102 > LUMO -1.698816650267124 was found in the canonicalized orbitals.

converged SCF energy = -105.094592677422
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 14.000025665584952
    CPU time for vxc      0.79 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 0.312  e= [-0.202505]  max|de|= -0.203  lindep= 0.916
davidson 1 2  |r|= 0.0963  e= [-0.210806]  max|de|= -0.0083  lindep= 0.552
davidson 2 3  |r|= 0.198  e= [-0.215824]  max|de|= -0.00502  lindep= 0.471
davidson 3 4  |r|= 0.0765  e= [-0.22214]  max|de|= -0.00632  lindep= 0.834
davidson 4 5  |r|= 0.0514  e= [-0.223899]  max|de|= -0.00176  lindep= 0.496
davidson 5 6  |r|= 0.354  e= [-0.228211]  max|de|= -0.00431  lindep= 0.501
davidson 6 7  |r|= 4.49  e= [-1.153158]  max|de|= -0.925  lindep= 0.501
Large |r| detected, restore to previous x0
davidson 7 1  |r|= 0.354  e= [-0.228211]  max|de|= 0.925  lindep= 0.936
davidson 8 2  |r|= 4.62  e= [-0.791605]  max|de|= -0.563  lindep= 0.936
Large |r| detected, restore to previous x0
davidson 9 1  |r|= 0.354  e= [-0.228211]  max|de|= 0.563  lindep= 0.936
davidson 10 2  |r|= 4.62  e= [-0.791605]  max|de|= -0.563  lindep= 0.936
Large |r| detected, restore to previous x0
davidson 11 1  |r|= 0.354  e= [-0.228211]  max|de|= 0.563  lindep= 0.936
davidson 12 2  |r|= 4.62  e= [-0.791605]  max|de|= -0.563  lindep= 0.936
Large |r| detected, restore to previous x0
davidson 13 1  |r|= 0.354  e= [-0.228211]  max|de|= 0.563  lindep= 0.936
davidson 14 2  |r|= 4.62  e= [-0.791605]  max|de|= -0.563  lindep= 0.936
Large |r| detected, restore to previous x0
davidson 15 1  |r|= 0.354  e= [-0.228211]  max|de|= 0.563  lindep= 0.936
davidson 16 2  |r|= 4.62  e= [-0.791605]  max|de|= -0.563  lindep= 0.936
Large |r| detected, restore to previous x0
davidson 17 1  |r|= 0.354  e= [-0.228211]  max|de|= 0.563  lindep= 0.936
davidson 18 2  |r|= 4.62  e= [-0.791605]  max|de|= -0.563  lindep= 0.936
Large |r| detected, restore to previous x0
davidson 19 1  |r|= 0.354  e= [-0.228211]  max|de|= 0.563  lindep= 0.936
davidson 20 2  |r|= 4.62  e= [-0.791605]  max|de|= -0.563  lindep= 0.936
Large |r| detected, restore to previous x0
davidson 21 1  |r|= 0.354  e= [-0.228211]  max|de|= 0.563  lindep= 0.936
davidson 22 2  |r|= 4.62  e= [-0.791605]  max|de|= -0.563  lindep= 0.936
Large |r| detected, restore to previous x0
davidson 23 1  |r|= 0.354  e= [-0.228211]  max|de|= 0.563  lindep= 0.936
davidson 24 2  |r|= 4.62  e= [-0.791605]  max|de|= -0.563  lindep= 0.936
Large |r| detected, restore to previous x0
davidson 25 1  |r|= 0.354  e= [-0.228211]  max|de|= 0.563  lindep= 0.936
davidson 26 2  |r|= 4.62  e= [-0.791605]  max|de|= -0.563  lindep= 0.936
Large |r| detected, restore to previous x0
davidson 27 1  |r|= 0.354  e= [-0.228211]  max|de|= 0.563  lindep= 0.936
davidson 28 2  |r|= 4.62  e= [-0.791605]  max|de|= -0.563  lindep= 0.936
Large |r| detected, restore to previous x0
davidson 29 1  |r|= 0.354  e= [-0.228211]  max|de|= 0.563  lindep= 0.936
davidson 30 2  |r|= 4.62  e= [-0.791605]  max|de|= -0.563  lindep= 0.936
Large |r| detected, restore to previous x0
davidson 31 1  |r|= 0.354  e= [-0.228211]  max|de|= 0.563  lindep= 0.936
davidson 32 2  |r|= 4.62  e= [-0.791605]  max|de|= -0.563  lindep= 0.936
Large |r| detected, restore to previous x0
davidson 33 1  |r|= 0.354  e= [-0.228211]  max|de|= 0.563  lindep= 0.936
davidson 34 2  |r|= 4.62  e= [-0.791605]  max|de|= -0.563  lindep= 0.936
Large |r| detected, restore to previous x0
davidson 35 1  |r|= 0.354  e= [-0.228211]  max|de|= 0.563  lindep= 0.936
davidson 36 2  |r|= 4.62  e= [-0.791605]  max|de|= -0.563  lindep= 0.936
Large |r| detected, restore to previous x0
davidson 37 1  |r|= 0.354  e= [-0.228211]  max|de|= 0.563  lindep= 0.936
davidson 38 2  |r|= 4.62  e= [-0.791605]  max|de|= -0.563  lindep= 0.936
Large |r| detected, restore to previous x0
davidson 39 1  |r|= 0.354  e= [-0.228211]  max|de|= 0.563  lindep= 0.936
davidson 40 2  |r|= 4.62  e= [-0.791605]  max|de|= -0.563  lindep= 0.936
Large |r| detected, restore to previous x0
davidson 41 1  |r|= 0.354  e= [-0.228211]  max|de|= 0.563  lindep= 0.936
davidson 42 2  |r|= 4.62  e= [-0.791605]  max|de|= -0.563  lindep= 0.936
Large |r| detected, restore to previous x0
davidson 43 1  |r|= 0.354  e= [-0.228211]  max|de|= 0.563  lindep= 0.936
davidson 44 2  |r|= 4.62  e= [-0.791605]  max|de|= -0.563  lindep= 0.936
Large |r| detected, restore to previous x0
davidson 45 1  |r|= 0.354  e= [-0.228211]  max|de|= 0.563  lindep= 0.936
davidson 46 2  |r|= 4.62  e= [-0.791605]  max|de|= -0.563  lindep= 0.936
Large |r| detected, restore to previous x0
davidson 47 1  |r|= 0.354  e= [-0.228211]  max|de|= 0.563  lindep= 0.936
davidson 48 2  |r|= 4.62  e= [-0.791605]  max|de|= -0.563  lindep= 0.936
Large |r| detected, restore to previous x0
davidson 49 1  |r|= 0.354  e= [-0.228211]  max|de|= 0.563  lindep= 0.936
RHF/RKS wavefunction has an internal instability




******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpv1p5j12c
max_memory 4000 MB (current use 266 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2b8e2e583830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2b8e2e583cb0>
******** <class 'pyscf.dft.rks.RKS'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpv1p5j12c
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 266 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.339120185536208  LUMO = 0.0818216035258448
Initial guess E= -102.610994020979  |g|= 2.97532
macro= 0  E= -105.015755479576  delta_E= -2.40476  |g|= 0.547083  3 KF 16 JK
macro= 1  E= -105.094586525004  delta_E= -0.078831  |g|= 0.0822587  3 KF 9 JK
macro= 2  E= -105.094592677411  delta_E= -6.15241e-06  |g|= 3.82995e-05  3 KF 11 JK
macro= 3  E= -105.094592677411  delta_E= -5.68434e-14  |g|= 1.48169e-06  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 4  E=-105.094592677411  |g|= 1.48169e-06  total 11 KF 43 JK

WARN: HOMO 0.6752119228357639 > LUMO -1.6988171270580714 was found in the canonicalized orbitals.

converged SCF energy = -105.094592677411
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 14.00002566555113
    CPU time for vxc      0.81 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 0.33  e= [-0.201581]  max|de|= -0.202  lindep= 0.899
davidson 1 2  |r|= 0.105  e= [-0.209603]  max|de|= -0.00802  lindep= 0.476
davidson 2 3  |r|= 0.208  e= [-0.215069]  max|de|= -0.00547  lindep= 0.517
davidson 3 4  |r|= 0.0926  e= [-0.222177]  max|de|= -0.00711  lindep= 0.838
davidson 4 5  |r|= 0.0637  e= [-0.223933]  max|de|= -0.00176  lindep=  0.5
davidson 5 6  |r|=  0.3  e= [-0.227397]  max|de|= -0.00346  lindep= 0.573
davidson 6 7  |r|=    5  e= [-0.754308]  max|de|= -0.527  lindep= 0.573
Large |r| detected, restore to previous x0
davidson 7 1  |r|=  0.3  e= [-0.227397]  max|de|= 0.527  lindep= 0.972
davidson 8 2  |r|=  5.1  e= [-0.617454]  max|de|= -0.39  lindep= 0.972
Large |r| detected, restore to previous x0
davidson 9 1  |r|=  0.3  e= [-0.227397]  max|de|= 0.39  lindep= 0.972
davidson 10 2  |r|=  5.1  e= [-0.617454]  max|de|= -0.39  lindep= 0.972
Large |r| detected, restore to previous x0
davidson 11 1  |r|=  0.3  e= [-0.227397]  max|de|= 0.39  lindep= 0.972
davidson 12 2  |r|=  5.1  e= [-0.617454]  max|de|= -0.39  lindep= 0.972
Large |r| detected, restore to previous x0
davidson 13 1  |r|=  0.3  e= [-0.227397]  max|de|= 0.39  lindep= 0.972
davidson 14 2  |r|=  5.1  e= [-0.617454]  max|de|= -0.39  lindep= 0.972
Large |r| detected, restore to previous x0
davidson 15 1  |r|=  0.3  e= [-0.227397]  max|de|= 0.39  lindep= 0.972
davidson 16 2  |r|=  5.1  e= [-0.617454]  max|de|= -0.39  lindep= 0.972
Large |r| detected, restore to previous x0
davidson 17 1  |r|=  0.3  e= [-0.227397]  max|de|= 0.39  lindep= 0.972
davidson 18 2  |r|=  5.1  e= [-0.617454]  max|de|= -0.39  lindep= 0.972
Large |r| detected, restore to previous x0
davidson 19 1  |r|=  0.3  e= [-0.227397]  max|de|= 0.39  lindep= 0.972
davidson 20 2  |r|=  5.1  e= [-0.617454]  max|de|= -0.39  lindep= 0.972
Large |r| detected, restore to previous x0
davidson 21 1  |r|=  0.3  e= [-0.227397]  max|de|= 0.39  lindep= 0.972
davidson 22 2  |r|=  5.1  e= [-0.617454]  max|de|= -0.39  lindep= 0.972
Large |r| detected, restore to previous x0
davidson 23 1  |r|=  0.3  e= [-0.227397]  max|de|= 0.39  lindep= 0.972
davidson 24 2  |r|=  5.1  e= [-0.617454]  max|de|= -0.39  lindep= 0.972
Large |r| detected, restore to previous x0
davidson 25 1  |r|=  0.3  e= [-0.227397]  max|de|= 0.39  lindep= 0.972
davidson 26 2  |r|=  5.1  e= [-0.617454]  max|de|= -0.39  lindep= 0.972
Large |r| detected, restore to previous x0
davidson 27 1  |r|=  0.3  e= [-0.227397]  max|de|= 0.39  lindep= 0.972
davidson 28 2  |r|=  5.1  e= [-0.617454]  max|de|= -0.39  lindep= 0.972
Large |r| detected, restore to previous x0
davidson 29 1  |r|=  0.3  e= [-0.227397]  max|de|= 0.39  lindep= 0.972
davidson 30 2  |r|=  5.1  e= [-0.617454]  max|de|= -0.39  lindep= 0.972
Large |r| detected, restore to previous x0
davidson 31 1  |r|=  0.3  e= [-0.227397]  max|de|= 0.39  lindep= 0.972
davidson 32 2  |r|=  5.1  e= [-0.617454]  max|de|= -0.39  lindep= 0.972
Large |r| detected, restore to previous x0
davidson 33 1  |r|=  0.3  e= [-0.227397]  max|de|= 0.39  lindep= 0.972
davidson 34 2  |r|=  5.1  e= [-0.617454]  max|de|= -0.39  lindep= 0.972
Large |r| detected, restore to previous x0
davidson 35 1  |r|=  0.3  e= [-0.227397]  max|de|= 0.39  lindep= 0.972
davidson 36 2  |r|=  5.1  e= [-0.617454]  max|de|= -0.39  lindep= 0.972
Large |r| detected, restore to previous x0
davidson 37 1  |r|=  0.3  e= [-0.227397]  max|de|= 0.39  lindep= 0.972
davidson 38 2  |r|=  5.1  e= [-0.617454]  max|de|= -0.39  lindep= 0.972
Large |r| detected, restore to previous x0
davidson 39 1  |r|=  0.3  e= [-0.227397]  max|de|= 0.39  lindep= 0.972
davidson 40 2  |r|=  5.1  e= [-0.617454]  max|de|= -0.39  lindep= 0.972
Large |r| detected, restore to previous x0
davidson 41 1  |r|=  0.3  e= [-0.227397]  max|de|= 0.39  lindep= 0.972
davidson 42 2  |r|=  5.1  e= [-0.617454]  max|de|= -0.39  lindep= 0.972
Large |r| detected, restore to previous x0
davidson 43 1  |r|=  0.3  e= [-0.227397]  max|de|= 0.39  lindep= 0.972
davidson 44 2  |r|=  5.1  e= [-0.617454]  max|de|= -0.39  lindep= 0.972
Large |r| detected, restore to previous x0
davidson 45 1  |r|=  0.3  e= [-0.227397]  max|de|= 0.39  lindep= 0.972
davidson 46 2  |r|=  5.1  e= [-0.617454]  max|de|= -0.39  lindep= 0.972
Large |r| detected, restore to previous x0
davidson 47 1  |r|=  0.3  e= [-0.227397]  max|de|= 0.39  lindep= 0.972
davidson 48 2  |r|=  5.1  e= [-0.617454]  max|de|= -0.39  lindep= 0.972
Large |r| detected, restore to previous x0
davidson 49 1  |r|=  0.3  e= [-0.227397]  max|de|= 0.39  lindep= 0.972
RHF/RKS wavefunction has an internal instability




******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpv1p5j12c
max_memory 4000 MB (current use 266 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2b8e2e583830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2b8e2e583cb0>
******** <class 'pyscf.dft.rks.RKS'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpv1p5j12c
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 266 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.335470195184421  LUMO = 0.0798651897239329
Initial guess E= -102.601147432795  |g|= 2.97957
macro= 0  E= -105.017303201265  delta_E= -2.41616  |g|= 0.551286  3 KF 16 JK
macro= 1  E= -105.094588446058  delta_E= -0.0772852  |g|= 0.0734952  3 KF 9 JK
macro= 2  E= -105.09459267741  delta_E= -4.23135e-06  |g|= 0.000173136  2 KF 8 JK
macro= 3  E= -105.09459267741  delta_E= -8.52651e-14  |g|= 8.39424e-06  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 4  E=-105.09459267741  |g|= 8.39424e-06  total 10 KF 40 JK

WARN: HOMO 0.6752123456947358 > LUMO -1.6988172374399626 was found in the canonicalized orbitals.

converged SCF energy = -105.09459267741
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 14.000025665584683
    CPU time for vxc      0.79 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 0.309  e= [-0.202684]  max|de|= -0.203  lindep= 0.919
davidson 1 2  |r|= 0.11  e= [-0.211453]  max|de|= -0.00877  lindep= 0.592
davidson 2 3  |r|= 0.168  e= [-0.218525]  max|de|= -0.00707  lindep= 0.627
davidson 3 4  |r|= 0.0768  e= [-0.222632]  max|de|= -0.00411  lindep= 0.725
davidson 4 5  |r|= 0.051  e= [-0.223899]  max|de|= -0.00127  lindep= 0.435
davidson 5 6  |r|= 0.388  e= [-0.228514]  max|de|= -0.00461  lindep= 0.482
davidson 6 7  |r|= 4.54  e= [-1.166444]  max|de|= -0.938  lindep= 0.482
Large |r| detected, restore to previous x0
davidson 7 1  |r|= 0.388  e= [-0.228514]  max|de|= 0.938  lindep= 0.923
davidson 8 2  |r|= 4.63  e= [-0.786363]  max|de|= -0.558  lindep= 0.923
Large |r| detected, restore to previous x0
davidson 9 1  |r|= 0.388  e= [-0.228514]  max|de|= 0.558  lindep= 0.923
davidson 10 2  |r|= 4.63  e= [-0.786363]  max|de|= -0.558  lindep= 0.923
Large |r| detected, restore to previous x0
davidson 11 1  |r|= 0.388  e= [-0.228514]  max|de|= 0.558  lindep= 0.923
davidson 12 2  |r|= 4.63  e= [-0.786363]  max|de|= -0.558  lindep= 0.923
Large |r| detected, restore to previous x0
davidson 13 1  |r|= 0.388  e= [-0.228514]  max|de|= 0.558  lindep= 0.923
davidson 14 2  |r|= 4.63  e= [-0.786363]  max|de|= -0.558  lindep= 0.923
Large |r| detected, restore to previous x0
davidson 15 1  |r|= 0.388  e= [-0.228514]  max|de|= 0.558  lindep= 0.923
davidson 16 2  |r|= 4.63  e= [-0.786363]  max|de|= -0.558  lindep= 0.923
Large |r| detected, restore to previous x0
davidson 17 1  |r|= 0.388  e= [-0.228514]  max|de|= 0.558  lindep= 0.923
davidson 18 2  |r|= 4.63  e= [-0.786363]  max|de|= -0.558  lindep= 0.923
Large |r| detected, restore to previous x0
davidson 19 1  |r|= 0.388  e= [-0.228514]  max|de|= 0.558  lindep= 0.923
davidson 20 2  |r|= 4.63  e= [-0.786363]  max|de|= -0.558  lindep= 0.923
Large |r| detected, restore to previous x0
davidson 21 1  |r|= 0.388  e= [-0.228514]  max|de|= 0.558  lindep= 0.923
davidson 22 2  |r|= 4.63  e= [-0.786363]  max|de|= -0.558  lindep= 0.923
Large |r| detected, restore to previous x0
davidson 23 1  |r|= 0.388  e= [-0.228514]  max|de|= 0.558  lindep= 0.923
davidson 24 2  |r|= 4.63  e= [-0.786363]  max|de|= -0.558  lindep= 0.923
Large |r| detected, restore to previous x0
davidson 25 1  |r|= 0.388  e= [-0.228514]  max|de|= 0.558  lindep= 0.923
davidson 26 2  |r|= 4.63  e= [-0.786363]  max|de|= -0.558  lindep= 0.923
Large |r| detected, restore to previous x0
davidson 27 1  |r|= 0.388  e= [-0.228514]  max|de|= 0.558  lindep= 0.923
davidson 28 2  |r|= 4.63  e= [-0.786363]  max|de|= -0.558  lindep= 0.923
Large |r| detected, restore to previous x0
davidson 29 1  |r|= 0.388  e= [-0.228514]  max|de|= 0.558  lindep= 0.923
davidson 30 2  |r|= 4.63  e= [-0.786363]  max|de|= -0.558  lindep= 0.923
Large |r| detected, restore to previous x0
davidson 31 1  |r|= 0.388  e= [-0.228514]  max|de|= 0.558  lindep= 0.923
davidson 32 2  |r|= 4.63  e= [-0.786363]  max|de|= -0.558  lindep= 0.923
Large |r| detected, restore to previous x0
davidson 33 1  |r|= 0.388  e= [-0.228514]  max|de|= 0.558  lindep= 0.923
davidson 34 2  |r|= 4.63  e= [-0.786363]  max|de|= -0.558  lindep= 0.923
Large |r| detected, restore to previous x0
davidson 35 1  |r|= 0.388  e= [-0.228514]  max|de|= 0.558  lindep= 0.923
davidson 36 2  |r|= 4.63  e= [-0.786363]  max|de|= -0.558  lindep= 0.923
Large |r| detected, restore to previous x0
davidson 37 1  |r|= 0.388  e= [-0.228514]  max|de|= 0.558  lindep= 0.923
davidson 38 2  |r|= 4.63  e= [-0.786363]  max|de|= -0.558  lindep= 0.923
Large |r| detected, restore to previous x0
davidson 39 1  |r|= 0.388  e= [-0.228514]  max|de|= 0.558  lindep= 0.923
davidson 40 2  |r|= 4.63  e= [-0.786363]  max|de|= -0.558  lindep= 0.923
Large |r| detected, restore to previous x0
davidson 41 1  |r|= 0.388  e= [-0.228514]  max|de|= 0.558  lindep= 0.923
davidson 42 2  |r|= 4.63  e= [-0.786363]  max|de|= -0.558  lindep= 0.923
Large |r| detected, restore to previous x0
davidson 43 1  |r|= 0.388  e= [-0.228514]  max|de|= 0.558  lindep= 0.923
davidson 44 2  |r|= 4.63  e= [-0.786363]  max|de|= -0.558  lindep= 0.923
Large |r| detected, restore to previous x0
davidson 45 1  |r|= 0.388  e= [-0.228514]  max|de|= 0.558  lindep= 0.923
davidson 46 2  |r|= 4.63  e= [-0.786363]  max|de|= -0.558  lindep= 0.923
Large |r| detected, restore to previous x0
davidson 47 1  |r|= 0.388  e= [-0.228514]  max|de|= 0.558  lindep= 0.923
davidson 48 2  |r|= 4.63  e= [-0.786363]  max|de|= -0.558  lindep= 0.923
Large |r| detected, restore to previous x0
davidson 49 1  |r|= 0.388  e= [-0.228514]  max|de|= 0.558  lindep= 0.923
RHF/RKS wavefunction has an internal instability




******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpv1p5j12c
max_memory 4000 MB (current use 266 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2b8e2e583830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2b8e2e583cb0>
******** <class 'pyscf.dft.rks.RKS'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpv1p5j12c
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 266 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.338195042152583  LUMO = 0.0797270494910701
Initial guess E= -102.601837309483  |g|= 2.97917
macro= 0  E= -105.017239353193  delta_E= -2.4154  |g|= 0.545706  3 KF 16 JK
macro= 1  E= -105.09458840659  delta_E= -0.0773491  |g|= 0.0733387  3 KF 9 JK
macro= 2  E= -105.09459267744  delta_E= -4.27085e-06  |g|= 0.000209273  2 KF 8 JK
macro= 3  E= -105.09459267744  delta_E= -8.52651e-14  |g|= 1.20114e-05  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 4  E=-105.09459267744  |g|= 1.20114e-05  total 10 KF 40 JK

WARN: HOMO 0.6752122427079454 > LUMO -1.6988172220856992 was found in the canonicalized orbitals.

converged SCF energy = -105.09459267744
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 14.000025665600337
    CPU time for vxc      0.80 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 0.308  e= [-0.20246]  max|de|= -0.202  lindep= 0.915
davidson 1 2  |r|= 0.0948  e= [-0.210785]  max|de|= -0.00832  lindep= 0.551
davidson 2 3  |r|= 0.197  e= [-0.21573]  max|de|= -0.00495  lindep= 0.466
davidson 3 4  |r|= 0.0783  e= [-0.222214]  max|de|= -0.00648  lindep= 0.846
davidson 4 5  |r|= 0.0514  e= [-0.223894]  max|de|= -0.00168  lindep= 0.481
davidson 5 6  |r|= 0.314  e= [-0.227893]  max|de|= -0.004  lindep= 0.535
davidson 6 7  |r|=  4.5  e= [-1.119872]  max|de|= -0.892  lindep= 0.535
Large |r| detected, restore to previous x0
davidson 7 1  |r|= 0.314  e= [-0.227893]  max|de|= 0.892  lindep= 0.949
davidson 8 2  |r|= 4.65  e= [-0.794715]  max|de|= -0.567  lindep= 0.949
Large |r| detected, restore to previous x0
davidson 9 1  |r|= 0.314  e= [-0.227893]  max|de|= 0.567  lindep= 0.949
davidson 10 2  |r|= 4.65  e= [-0.794715]  max|de|= -0.567  lindep= 0.949
Large |r| detected, restore to previous x0
davidson 11 1  |r|= 0.314  e= [-0.227893]  max|de|= 0.567  lindep= 0.949
davidson 12 2  |r|= 4.65  e= [-0.794715]  max|de|= -0.567  lindep= 0.949
Large |r| detected, restore to previous x0
davidson 13 1  |r|= 0.314  e= [-0.227893]  max|de|= 0.567  lindep= 0.949
davidson 14 2  |r|= 4.65  e= [-0.794715]  max|de|= -0.567  lindep= 0.949
Large |r| detected, restore to previous x0
davidson 15 1  |r|= 0.314  e= [-0.227893]  max|de|= 0.567  lindep= 0.949
davidson 16 2  |r|= 4.65  e= [-0.794715]  max|de|= -0.567  lindep= 0.949
Large |r| detected, restore to previous x0
davidson 17 1  |r|= 0.314  e= [-0.227893]  max|de|= 0.567  lindep= 0.949
davidson 18 2  |r|= 4.65  e= [-0.794715]  max|de|= -0.567  lindep= 0.949
Large |r| detected, restore to previous x0
davidson 19 1  |r|= 0.314  e= [-0.227893]  max|de|= 0.567  lindep= 0.949
davidson 20 2  |r|= 4.65  e= [-0.794715]  max|de|= -0.567  lindep= 0.949
Large |r| detected, restore to previous x0
davidson 21 1  |r|= 0.314  e= [-0.227893]  max|de|= 0.567  lindep= 0.949
davidson 22 2  |r|= 4.65  e= [-0.794715]  max|de|= -0.567  lindep= 0.949
Large |r| detected, restore to previous x0
davidson 23 1  |r|= 0.314  e= [-0.227893]  max|de|= 0.567  lindep= 0.949
davidson 24 2  |r|= 4.65  e= [-0.794715]  max|de|= -0.567  lindep= 0.949
Large |r| detected, restore to previous x0
davidson 25 1  |r|= 0.314  e= [-0.227893]  max|de|= 0.567  lindep= 0.949
davidson 26 2  |r|= 4.65  e= [-0.794715]  max|de|= -0.567  lindep= 0.949
Large |r| detected, restore to previous x0
davidson 27 1  |r|= 0.314  e= [-0.227893]  max|de|= 0.567  lindep= 0.949
davidson 28 2  |r|= 4.65  e= [-0.794715]  max|de|= -0.567  lindep= 0.949
Large |r| detected, restore to previous x0
davidson 29 1  |r|= 0.314  e= [-0.227893]  max|de|= 0.567  lindep= 0.949
davidson 30 2  |r|= 4.65  e= [-0.794715]  max|de|= -0.567  lindep= 0.949
Large |r| detected, restore to previous x0
davidson 31 1  |r|= 0.314  e= [-0.227893]  max|de|= 0.567  lindep= 0.949
davidson 32 2  |r|= 4.65  e= [-0.794715]  max|de|= -0.567  lindep= 0.949
Large |r| detected, restore to previous x0
davidson 33 1  |r|= 0.314  e= [-0.227893]  max|de|= 0.567  lindep= 0.949
davidson 34 2  |r|= 4.65  e= [-0.794715]  max|de|= -0.567  lindep= 0.949
Large |r| detected, restore to previous x0
davidson 35 1  |r|= 0.314  e= [-0.227893]  max|de|= 0.567  lindep= 0.949
davidson 36 2  |r|= 4.65  e= [-0.794715]  max|de|= -0.567  lindep= 0.949
Large |r| detected, restore to previous x0
davidson 37 1  |r|= 0.314  e= [-0.227893]  max|de|= 0.567  lindep= 0.949
davidson 38 2  |r|= 4.65  e= [-0.794715]  max|de|= -0.567  lindep= 0.949
Large |r| detected, restore to previous x0
davidson 39 1  |r|= 0.314  e= [-0.227893]  max|de|= 0.567  lindep= 0.949
davidson 40 2  |r|= 4.65  e= [-0.794715]  max|de|= -0.567  lindep= 0.949
Large |r| detected, restore to previous x0
davidson 41 1  |r|= 0.314  e= [-0.227893]  max|de|= 0.567  lindep= 0.949
davidson 42 2  |r|= 4.65  e= [-0.794715]  max|de|= -0.567  lindep= 0.949
Large |r| detected, restore to previous x0
davidson 43 1  |r|= 0.314  e= [-0.227893]  max|de|= 0.567  lindep= 0.949
davidson 44 2  |r|= 4.65  e= [-0.794715]  max|de|= -0.567  lindep= 0.949
Large |r| detected, restore to previous x0
davidson 45 1  |r|= 0.314  e= [-0.227893]  max|de|= 0.567  lindep= 0.949
davidson 46 2  |r|= 4.65  e= [-0.794715]  max|de|= -0.567  lindep= 0.949
Large |r| detected, restore to previous x0
davidson 47 1  |r|= 0.314  e= [-0.227893]  max|de|= 0.567  lindep= 0.949
davidson 48 2  |r|= 4.65  e= [-0.794715]  max|de|= -0.567  lindep= 0.949
Large |r| detected, restore to previous x0
davidson 49 1  |r|= 0.314  e= [-0.227893]  max|de|= 0.567  lindep= 0.949
RHF/RKS wavefunction has an internal instability




******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpv1p5j12c
max_memory 4000 MB (current use 266 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2b8e2e583830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2b8e2e583cb0>
******** <class 'pyscf.dft.rks.RKS'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpv1p5j12c
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 266 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.3372555002431  LUMO = 0.0791938650732187
Initial guess E= -102.597222590099  |g|= 2.98097
macro= 0  E= -105.038868136023  delta_E= -2.44165  |g|= 0.464262  3 KF 16 JK
macro= 1  E= -105.094598867754  delta_E= -0.0557307  |g|= 0.0256807  3 KF 9 JK
macro= 2  E= -105.09459267742  delta_E= 6.19033e-06  |g|= 6.03604e-05  3 KF 11 JK
macro= 3  E= -105.09459267742  delta_E= -5.68434e-14  |g|= 1.14762e-05  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 4  E=-105.09459267742  |g|= 1.14762e-05  total 11 KF 43 JK

WARN: HOMO 0.6752124633986766 > LUMO -1.698817284736542 was found in the canonicalized orbitals.

converged SCF energy = -105.09459267742
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 14.000025665639132
    CPU time for vxc      0.79 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 0.308  e= [-0.202579]  max|de|= -0.203  lindep= 0.916
davidson 1 2  |r|= 0.0959  e= [-0.210836]  max|de|= -0.00826  lindep= 0.554
davidson 2 3  |r|= 0.197  e= [-0.215753]  max|de|= -0.00492  lindep= 0.464
davidson 3 4  |r|= 0.0753  e= [-0.222248]  max|de|= -0.00649  lindep= 0.853
davidson 4 5  |r|= 0.0509  e= [-0.223891]  max|de|= -0.00164  lindep= 0.478
davidson 5 6  |r|= 0.317  e= [-0.227935]  max|de|= -0.00404  lindep= 0.525
davidson 6 7  |r|= 4.45  e= [-1.140208]  max|de|= -0.912  lindep= 0.525
Large |r| detected, restore to previous x0
davidson 7 1  |r|= 0.317  e= [-0.227935]  max|de|= 0.912  lindep= 0.947
davidson 8 2  |r|= 4.61  e= [-0.797107]  max|de|= -0.569  lindep= 0.947
Large |r| detected, restore to previous x0
davidson 9 1  |r|= 0.317  e= [-0.227935]  max|de|= 0.569  lindep= 0.947
davidson 10 2  |r|= 4.61  e= [-0.797107]  max|de|= -0.569  lindep= 0.947
Large |r| detected, restore to previous x0
davidson 11 1  |r|= 0.317  e= [-0.227935]  max|de|= 0.569  lindep= 0.947
davidson 12 2  |r|= 4.61  e= [-0.797107]  max|de|= -0.569  lindep= 0.947
Large |r| detected, restore to previous x0
davidson 13 1  |r|= 0.317  e= [-0.227935]  max|de|= 0.569  lindep= 0.947
davidson 14 2  |r|= 4.61  e= [-0.797107]  max|de|= -0.569  lindep= 0.947
Large |r| detected, restore to previous x0
davidson 15 1  |r|= 0.317  e= [-0.227935]  max|de|= 0.569  lindep= 0.947
davidson 16 2  |r|= 4.61  e= [-0.797107]  max|de|= -0.569  lindep= 0.947
Large |r| detected, restore to previous x0
davidson 17 1  |r|= 0.317  e= [-0.227935]  max|de|= 0.569  lindep= 0.947
davidson 18 2  |r|= 4.61  e= [-0.797107]  max|de|= -0.569  lindep= 0.947
Large |r| detected, restore to previous x0
davidson 19 1  |r|= 0.317  e= [-0.227935]  max|de|= 0.569  lindep= 0.947
davidson 20 2  |r|= 4.61  e= [-0.797107]  max|de|= -0.569  lindep= 0.947
Large |r| detected, restore to previous x0
davidson 21 1  |r|= 0.317  e= [-0.227935]  max|de|= 0.569  lindep= 0.947
davidson 22 2  |r|= 4.61  e= [-0.797107]  max|de|= -0.569  lindep= 0.947
Large |r| detected, restore to previous x0
davidson 23 1  |r|= 0.317  e= [-0.227935]  max|de|= 0.569  lindep= 0.947
davidson 24 2  |r|= 4.61  e= [-0.797107]  max|de|= -0.569  lindep= 0.947
Large |r| detected, restore to previous x0
davidson 25 1  |r|= 0.317  e= [-0.227935]  max|de|= 0.569  lindep= 0.947
davidson 26 2  |r|= 4.61  e= [-0.797107]  max|de|= -0.569  lindep= 0.947
Large |r| detected, restore to previous x0
davidson 27 1  |r|= 0.317  e= [-0.227935]  max|de|= 0.569  lindep= 0.947
davidson 28 2  |r|= 4.61  e= [-0.797107]  max|de|= -0.569  lindep= 0.947
Large |r| detected, restore to previous x0
davidson 29 1  |r|= 0.317  e= [-0.227935]  max|de|= 0.569  lindep= 0.947
davidson 30 2  |r|= 4.61  e= [-0.797107]  max|de|= -0.569  lindep= 0.947
Large |r| detected, restore to previous x0
davidson 31 1  |r|= 0.317  e= [-0.227935]  max|de|= 0.569  lindep= 0.947
davidson 32 2  |r|= 4.61  e= [-0.797107]  max|de|= -0.569  lindep= 0.947
Large |r| detected, restore to previous x0
davidson 33 1  |r|= 0.317  e= [-0.227935]  max|de|= 0.569  lindep= 0.947
davidson 34 2  |r|= 4.61  e= [-0.797107]  max|de|= -0.569  lindep= 0.947
Large |r| detected, restore to previous x0
davidson 35 1  |r|= 0.317  e= [-0.227935]  max|de|= 0.569  lindep= 0.947
davidson 36 2  |r|= 4.61  e= [-0.797107]  max|de|= -0.569  lindep= 0.947
Large |r| detected, restore to previous x0
davidson 37 1  |r|= 0.317  e= [-0.227935]  max|de|= 0.569  lindep= 0.947
davidson 38 2  |r|= 4.61  e= [-0.797107]  max|de|= -0.569  lindep= 0.947
Large |r| detected, restore to previous x0
davidson 39 1  |r|= 0.317  e= [-0.227935]  max|de|= 0.569  lindep= 0.947
davidson 40 2  |r|= 4.61  e= [-0.797107]  max|de|= -0.569  lindep= 0.947
Large |r| detected, restore to previous x0
davidson 41 1  |r|= 0.317  e= [-0.227935]  max|de|= 0.569  lindep= 0.947
davidson 42 2  |r|= 4.61  e= [-0.797107]  max|de|= -0.569  lindep= 0.947
Large |r| detected, restore to previous x0
davidson 43 1  |r|= 0.317  e= [-0.227935]  max|de|= 0.569  lindep= 0.947
davidson 44 2  |r|= 4.61  e= [-0.797107]  max|de|= -0.569  lindep= 0.947
Large |r| detected, restore to previous x0
davidson 45 1  |r|= 0.317  e= [-0.227935]  max|de|= 0.569  lindep= 0.947
davidson 46 2  |r|= 4.61  e= [-0.797107]  max|de|= -0.569  lindep= 0.947
Large |r| detected, restore to previous x0
davidson 47 1  |r|= 0.317  e= [-0.227935]  max|de|= 0.569  lindep= 0.947
davidson 48 2  |r|= 4.61  e= [-0.797107]  max|de|= -0.569  lindep= 0.947
Large |r| detected, restore to previous x0
davidson 49 1  |r|= 0.317  e= [-0.227935]  max|de|= 0.569  lindep= 0.947
RHF/RKS wavefunction has an internal instability




******** <class 'pyscf.dft.rks.RKS'> ********
method = RKS-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpv1p5j12c
max_memory 4000 MB (current use 266 MB)
XC functionals = pbe0
small_rho_cutoff = 1e-07
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x2b8e2e583830>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x2b8e2e583cb0>
******** <class 'pyscf.dft.rks.RKS'> Newton solver flags ********
SCF tol = 1e-09
conv_tol_grad = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/guess/tmpv1p5j12c
max_cycle_inner = 12
max_stepsize = 0.05
ah_start_tol = 1e+09
ah_level_shift = 0
ah_conv_tol = 1e-12
ah_lindep = 1e-14
ah_start_cycle = 1
ah_max_cycle = 40
ah_grad_trust_region = 2.5
kf_interval = 4
kf_trust_region = 5
canonicalization = True
max_memory 4000 MB (current use 266 MB)
Set conv_tol_grad to 3.16228e-05
  HOMO = -0.337536911306502  LUMO = 0.0811699959306587
Initial guess E= -102.607516416584  |g|= 2.97695
macro= 0  E= -105.017673566067  delta_E= -2.41016  |g|= 0.547808  3 KF 16 JK
macro= 1  E= -105.094589497886  delta_E= -0.0769159  |g|= 0.0743919  3 KF 9 JK
macro= 2  E= -105.09459267741  delta_E= -3.17952e-06  |g|= 0.000270074  2 KF 9 JK
macro= 3  E= -105.09459267741  delta_E= 0  |g|= 4.13385e-06  1 KF 2 JK
Canonicalize SCF orbitals
macro X = 4  E=-105.09459267741  |g|= 4.13385e-06  total 10 KF 41 JK

WARN: HOMO 0.6752122866802887 > LUMO -1.6988171310799627 was found in the canonicalized orbitals.

converged SCF energy = -105.09459267741
**** checking RHF/RKS internal stability ...
nelec by numeric integration = 14.000025665578544
    CPU time for vxc      0.79 sec, wall time      0.02 sec
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 0.305  e= [-0.202608]  max|de|= -0.203  lindep= 0.917
davidson 1 2  |r|= 0.0959  e= [-0.210808]  max|de|= -0.0082  lindep= 0.557
davidson 2 3  |r|= 0.197  e= [-0.215697]  max|de|= -0.00489  lindep= 0.459
davidson 3 4  |r|= 0.0728  e= [-0.2223]  max|de|= -0.0066  lindep= 0.869
davidson 4 5  |r|= 0.051  e= [-0.22389]  max|de|= -0.00159  lindep= 0.475
davidson 5 6  |r|= 0.339  e= [-0.228244]  max|de|= -0.00435  lindep= 0.49
davidson 6 7  |r|= 4.19  e= [-1.284961]  max|de|= -1.06  lindep= 0.49
Large |r| detected, restore to previous x0
davidson 7 1  |r|= 0.339  e= [-0.228244]  max|de|= 1.06  lindep= 0.933
davidson 8 2  |r|=  4.4  e= [-0.835585]  max|de|= -0.607  lindep= 0.933
Large |r| detected, restore to previous x0
davidson 9 1  |r|= 0.339  e= [-0.228244]  max|de|= 0.607  lindep= 0.933
davidson 10 2  |r|=  4.4  e= [-0.835585]  max|de|= -0.607  lindep= 0.933
Large |r| detected, restore to previous x0
davidson 11 1  |r|= 0.339  e= [-0.228244]  max|de|= 0.607  lindep= 0.933
davidson 12 2  |r|=  4.4  e= [-0.835585]  max|de|= -0.607  lindep= 0.933
Large |r| detected, restore to previous x0
davidson 13 1  |r|= 0.339  e= [-0.228244]  max|de|= 0.607  lindep= 0.933
davidson 14 2  |r|=  4.4  e= [-0.835585]  max|de|= -0.607  lindep= 0.933
Large |r| detected, restore to previous x0
davidson 15 1  |r|= 0.339  e= [-0.228244]  max|de|= 0.607  lindep= 0.933
davidson 16 2  |r|=  4.4  e= [-0.835585]  max|de|= -0.607  lindep= 0.933
Large |r| detected, restore to previous x0
davidson 17 1  |r|= 0.339  e= [-0.228244]  max|de|= 0.607  lindep= 0.933
davidson 18 2  |r|=  4.4  e= [-0.835585]  max|de|= -0.607  lindep= 0.933
Large |r| detected, restore to previous x0
davidson 19 1  |r|= 0.339  e= [-0.228244]  max|de|= 0.607  lindep= 0.933
davidson 20 2  |r|=  4.4  e= [-0.835585]  max|de|= -0.607  lindep= 0.933
Large |r| detected, restore to previous x0
davidson 21 1  |r|= 0.339  e= [-0.228244]  max|de|= 0.607  lindep= 0.933
davidson 22 2  |r|=  4.4  e= [-0.835585]  max|de|= -0.607  lindep= 0.933
Large |r| detected, restore to previous x0
davidson 23 1  |r|= 0.339  e= [-0.228244]  max|de|= 0.607  lindep= 0.933
davidson 24 2  |r|=  4.4  e= [-0.835585]  max|de|= -0.607  lindep= 0.933
Large |r| detected, restore to previous x0
davidson 25 1  |r|= 0.339  e= [-0.228244]  max|de|= 0.607  lindep= 0.933
davidson 26 2  |r|=  4.4  e= [-0.835585]  max|de|= -0.607  lindep= 0.933
Large |r| detected, restore to previous x0
davidson 27 1  |r|= 0.339  e= [-0.228244]  max|de|= 0.607  lindep= 0.933
davidson 28 2  |r|=  4.4  e= [-0.835585]  max|de|= -0.607  lindep= 0.933
Large |r| detected, restore to previous x0
davidson 29 1  |r|= 0.339  e= [-0.228244]  max|de|= 0.607  lindep= 0.933
davidson 30 2  |r|=  4.4  e= [-0.835585]  max|de|= -0.607  lindep= 0.933
Large |r| detected, restore to previous x0
davidson 31 1  |r|= 0.339  e= [-0.228244]  max|de|= 0.607  lindep= 0.933
davidson 32 2  |r|=  4.4  e= [-0.835585]  max|de|= -0.607  lindep= 0.933
Large |r| detected, restore to previous x0
davidson 33 1  |r|= 0.339  e= [-0.228244]  max|de|= 0.607  lindep= 0.933
davidson 34 2  |r|=  4.4  e= [-0.835585]  max|de|= -0.607  lindep= 0.933
Large |r| detected, restore to previous x0
davidson 35 1  |r|= 0.339  e= [-0.228244]  max|de|= 0.607  lindep= 0.933
davidson 36 2  |r|=  4.4  e= [-0.835585]  max|de|= -0.607  lindep= 0.933
Large |r| detected, restore to previous x0
davidson 37 1  |r|= 0.339  e= [-0.228244]  max|de|= 0.607  lindep= 0.933
davidson 38 2  |r|=  4.4  e= [-0.835585]  max|de|= -0.607  lindep= 0.933
Large |r| detected, restore to previous x0
davidson 39 1  |r|= 0.339  e= [-0.228244]  max|de|= 0.607  lindep= 0.933
davidson 40 2  |r|=  4.4  e= [-0.835585]  max|de|= -0.607  lindep= 0.933
Large |r| detected, restore to previous x0
davidson 41 1  |r|= 0.339  e= [-0.228244]  max|de|= 0.607  lindep= 0.933
davidson 42 2  |r|=  4.4  e= [-0.835585]  max|de|= -0.607  lindep= 0.933
Large |r| detected, restore to previous x0
davidson 43 1  |r|= 0.339  e= [-0.228244]  max|de|= 0.607  lindep= 0.933
davidson 44 2  |r|=  4.4  e= [-0.835585]  max|de|= -0.607  lindep= 0.933
Large |r| detected, restore to previous x0
davidson 45 1  |r|= 0.339  e= [-0.228244]  max|de|= 0.607  lindep= 0.933
davidson 46 2  |r|=  4.4  e= [-0.835585]  max|de|= -0.607  lindep= 0.933
Large |r| detected, restore to previous x0
davidson 47 1  |r|= 0.339  e= [-0.228244]  max|de|= 0.607  lindep= 0.933
davidson 48 2  |r|=  4.4  e= [-0.835585]  max|de|= -0.607  lindep= 0.933
Large |r| detected, restore to previous x0
davidson 49 1  |r|= 0.339  e= [-0.228244]  max|de|= 0.607  lindep= 0.933
RHF/RKS wavefunction has an internal instability
