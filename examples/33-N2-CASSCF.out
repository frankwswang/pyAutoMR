#INFO: **** input file is /share/home/srwang/pyAutoMR/examples/33-N2-CASSCF.py ****
from pyscf import lib
#from pyphf import util, guess
import guess, autocas, cidump

lib.num_threads(4)

xyz = 'N 0.0 0.0 0.0; N  0.0 0.0 1.9' #sys.argv[1]
#fch = 'n2.fchk' #sys.argv[2]
bas = 'cc-pvdz'

mf = guess.from_frag(xyz, bas, [[0],[1]], [0,0], [3,-3], cycle=50)
guess.check_stab(mf)

mf2 = autocas.cas(mf)
cidump.dump(mf2)

#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='xn01', release='3.10.0-1127.el7.x86_64', version='#1 SMP Tue Feb 18 16:39:12 EST 2020', machine='x86_64', processor='x86_64')  Threads 4
Python 3.7.4 (default, Aug 13 2019, 20:35:49) 
[GCC 7.3.0]
numpy 1.17.2  scipy 1.4.1
Date: Mon Jun 28 21:18:10 2021
PySCF version 1.7.6a1
PySCF path  /share/home/srwang/pyscf/pyscf
GIT HEAD      ref: refs/heads/master
GIT master branch  80f71dfe77ac5f9caae26788acf76446987635bd

[CONFIG] conf_file /share/home/srwang/.pyscf_conf.py
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 14
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 N      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 N      0.000000000000   0.000000000000   1.900000000000 AA    0.000000000000   0.000000000000   3.590479636674 Bohr

nuclear repulsion = 13.6472017553053
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:         0.44
**** generating fragment guess ****
fragments: [('N', [0.0, 0.0, 0.0])] [('N', [0.0, 0.0, 1.9])]
converged SCF energy = -54.3911145621998  <S^2> = 3.7540306  2S+1 = 4.0020148
converged SCF energy = -54.3911145621998  <S^2> = 3.7540306  2S+1 = 4.0020148
       na   nb
atom1   5    2
atom2   2    5


******** <class 'pyscf.scf.uhf.UHF'> ********
method = UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/tmptkhnrxt2
max_memory 4000 MB (current use 95 MB)
number electrons alpha = 7  beta = 7
Set gradient conv threshold to 3.16228e-05
init E= -108.900143275272
  alpha nocc = 7  HOMO = -0.476464499402218  LUMO = 0.166732176142524
  beta  nocc = 7  HOMO = -0.476464499402213  LUMO = 0.166732176142524
cycle= 1 E= -108.762288631731  delta_E= 0.138  |g|= 0.0527  |ddm|= 0.373
  alpha nocc = 7  HOMO = -0.530330642057187  LUMO = 0.162348570448284
  beta  nocc = 7  HOMO = -0.530330642057184  LUMO = 0.162348570448286
cycle= 2 E= -108.765642733546  delta_E= -0.00335  |g|= 0.0253  |ddm|= 0.0587
  alpha nocc = 7  HOMO = -0.52904967191286  LUMO = 0.159261512802591
  beta  nocc = 7  HOMO = -0.529049671912859  LUMO = 0.159261512802594
cycle= 3 E= -108.767085606679  delta_E= -0.00144  |g|= 0.0126  |ddm|= 0.0548
  alpha nocc = 7  HOMO = -0.528710372834677  LUMO = 0.156378931797926
  beta  nocc = 7  HOMO = -0.528710372834678  LUMO = 0.156378931797935
cycle= 4 E= -108.767469881852  delta_E= -0.000384  |g|= 0.00324  |ddm|= 0.0393
  alpha nocc = 7  HOMO = -0.527321353128726  LUMO = 0.156905650680729
  beta  nocc = 7  HOMO = -0.527321353128723  LUMO = 0.156905650680726
cycle= 5 E= -108.767488344339  delta_E= -1.85e-05  |g|= 0.000626  |ddm|= 0.0078
  alpha nocc = 7  HOMO = -0.527670443529372  LUMO = 0.156831110667578
  beta  nocc = 7  HOMO = -0.527670443529376  LUMO = 0.156831110667583
cycle= 6 E= -108.767488867958  delta_E= -5.24e-07  |g|= 0.000143  |ddm|= 0.00108
  alpha nocc = 7  HOMO = -0.527603375860147  LUMO = 0.156896336092539
  beta  nocc = 7  HOMO = -0.527603375860145  LUMO = 0.156896336092542
cycle= 7 E= -108.767488893983  delta_E= -2.6e-08  |g|= 4.93e-05  |ddm|= 0.000239
  alpha nocc = 7  HOMO = -0.527650705153183  LUMO = 0.156872500788264
  beta  nocc = 7  HOMO = -0.527650705153183  LUMO = 0.156872500788265
cycle= 8 E= -108.767488898007  delta_E= -4.02e-09  |g|= 1.06e-05  |ddm|= 9.2e-05
  alpha nocc = 7  HOMO = -0.527658756971648  LUMO = 0.156874706934984
  beta  nocc = 7  HOMO = -0.52765875697165  LUMO = 0.156874706934989
cycle= 9 E= -108.76748889822  delta_E= -2.13e-10  |g|= 1.78e-06  |ddm|= 2.85e-05
  alpha nocc = 7  HOMO = -0.527658437248201  LUMO = 0.156874663133344
  beta  nocc = 7  HOMO = -0.5276584372482  LUMO = 0.156874663133347
Extra cycle  E= -108.767488898223  delta_E= -2.46e-12  |g|= 6.81e-07  |ddm|= 2.47e-06
converged SCF energy = -108.767488898223  <S^2> = 2.6423741  2S+1 = 3.4013963
time for guess: 0.180
**** checking UHF/UKS internal stability ...
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 2.37  e= [2.267249]  max|de|= 2.27  lindep= 0.686
davidson 1 2  |r|= 1.24  e= [1.362578]  max|de|= -0.905  lindep= 0.917
davidson 2 3  |r|= 0.36  e= [0.74681]  max|de|= -0.616  lindep= 0.997
davidson 3 4  |r|= 0.315  e= [0.598133]  max|de|= -0.149  lindep= 0.934
davidson 4 5  |r|= 0.114  e= [0.540249]  max|de|= -0.0579  lindep= 0.964
davidson 5 6  |r|= 0.0321  e= [0.535936]  max|de|= -0.00431  lindep= 0.979
davidson 6 7  |r|= 0.0206  e= [0.535222]  max|de|= -0.000714  lindep= 0.943
davidson 7 8  |r|= 0.0106  e= [0.534939]  max|de|= -0.000283  lindep= 0.962
davidson 8 9  |r|= 0.0294  e= [0.5347]  max|de|= -0.00024  lindep= 0.927
davidson 9 10  |r|= 0.0226  e= [0.534032]  max|de|= -0.000668  lindep= 0.977
davidson 10 11  |r|= 0.0194  e= [0.533686]  max|de|= -0.000346  lindep= 0.898
davidson 11 12  |r|= 0.0123  e= [0.533535]  max|de|= -0.000151  lindep= 0.895
davidson 12 1  |r|= 0.0123  e= [0.533535]  max|de|= 4.44e-16  lindep=    1
davidson 13 2  |r|= 0.0103  e= [0.533482]  max|de|= -5.23e-05  lindep= 0.883
root 0 converged  |r|= 0.00643  e= 0.5334287785731947  max|de|= -5.36e-05
converged 14 3  |r|= 0.00643  e= [0.533429]  max|de|= -5.36e-05
UHF/UKS wavefunction is stable in the internal stability analysis
UNO ON: [ 2.        2.        1.999103  1.997838  1.550306  1.174501  1.174501  0.825499  0.825499  0.449694  0.002162  0.000897  0.        0.        0.
  0.        0.        0.        0.        0.       -0.       -0.       -0.       -0.       -0.       -0.       -0.       -0.      ]
nacto, nacta, nactb: 6 3 3
Converting <class 'pyscf.scf.uhf.UHF'> to RHF
UNO in active space
             #0      #1      #2      #3      #4      #5     
  0 N 3s                                               0.184
  0 N 2px              0.154  -0.432  -0.487  -0.139        
  0 N 2py              0.432   0.154  -0.139   0.487        
  0 N 2pz     -0.442                                   0.565
  0 N 3px              0.106  -0.295  -0.323                
  0 N 3py              0.295   0.106           0.323        
  0 N 3pz     -0.295                                   0.390
  1 N 3s                                              -0.184
  1 N 2px              0.154  -0.432   0.487   0.139        
  1 N 2py              0.432   0.154   0.139  -0.487        
  1 N 2pz      0.442                                   0.565
  1 N 3px              0.106  -0.295   0.323                
  1 N 3py              0.295   0.106          -0.323        
  1 N 3pz      0.295                                   0.390

******** <class 'pyscf.mcscf.mc1step.CASSCF'> ********
CAS (3e+3e, 6o), ncore = 4, nvir = 18
max_cycle_macro = 200
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 0
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /share/home/srwang/pyAutoMR/examples/tmptkhnrxt2
max_memory 1000 MB (current use 97 MB)
internal_rotation = False
******** <class 'pyscf.fci.direct_spin1.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-08
davidson only = False
linear dependence = 1e-10
level shift = 0.001
max iter space = 12
max_memory 1000 MB
nroots = 1
pspace_size = 400
spin = 0
CASCI E = -108.799475961089  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter 1 (12 JK  4 micro), CASSCF E = -108.80082450819  dE = -0.0013485471  S^2 = 0.0000000
               |grad[o]|=0.0392  |grad[c]|= 0.0016609806671384786  |ddm|=0.0463
macro iter 2 (6 JK  2 micro), CASSCF E = -108.800824782724  dE = -2.745342e-07  S^2 = 0.0000000
               |grad[o]|=0.000655  |grad[c]|= 1.7902445130129156e-05  |ddm|=0.000253
macro iter 3 (3 JK  1 micro), CASSCF E = -108.800824783023  dE = -2.9899638e-10  S^2 = 0.0000000
               |grad[o]|=2.93e-05  |grad[c]|= 6.983843124417784e-06  |ddm|=1.73e-05
1-step CASSCF converged in 3 macro (21 JK 7 micro) steps
CASSCF canonicalization
Natural occ [1.733008 1.391516 1.391515 0.608478 0.608478 0.267005]
Natural orbital (expansion on AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 N 1s      -0.00069   0.00000  -0.00000   0.00000  -0.00000
  0 N 2s      -0.00511   0.00000   0.00000   0.00000  -0.00000
  0 N 3s       0.05372   0.00000  -0.00000  -0.00000   0.00000
  0 N 2px      0.00000  -0.45109  -0.00541  -0.00616  -0.51450
  0 N 2py      0.00000  -0.00541   0.45109   0.51450  -0.00616
  0 N 2pz     -0.43997  -0.00000   0.00000   0.00000  -0.00000
  0 N 3px      0.00000  -0.32055  -0.00384  -0.00389  -0.32548
  0 N 3py      0.00000  -0.00384   0.32055   0.32548  -0.00389
  0 N 3pz     -0.29468  -0.00000   0.00000  -0.00000   0.00000
  0 N 3dxy     0.00000   0.00000  -0.00000   0.00000   0.00000
  0 N 3dyz    -0.00000  -0.00014   0.01193   0.00571  -0.00007
  0 N 3dz^2   -0.02028  -0.00000  -0.00000  -0.00000   0.00000
  0 N 3dxz    -0.00000  -0.01193  -0.00014  -0.00007  -0.00571
 0 N 3dx2-y2   0.00000  -0.00000  -0.00000   0.00000   0.00000
  1 N 1s      -0.00069   0.00000  -0.00000  -0.00000   0.00000
  1 N 2s      -0.00511  -0.00000  -0.00000  -0.00000   0.00000
  1 N 3s       0.05372  -0.00000   0.00000   0.00000  -0.00000
  1 N 2px      0.00000  -0.45109  -0.00541   0.00616   0.51450
  1 N 2py      0.00000  -0.00541   0.45109  -0.51450   0.00616
  1 N 2pz      0.43997   0.00000  -0.00000   0.00000  -0.00000
  1 N 3px      0.00000  -0.32055  -0.00384   0.00389   0.32548
  1 N 3py      0.00000  -0.00384   0.32055  -0.32548   0.00389
  1 N 3pz      0.29468   0.00000  -0.00000  -0.00000   0.00000
  1 N 3dxy    -0.00000  -0.00000   0.00000  -0.00000   0.00000
  1 N 3dyz    -0.00000   0.00014  -0.01193   0.00571  -0.00007
  1 N 3dz^2   -0.02028  -0.00000   0.00000   0.00000  -0.00000
  1 N 3dxz     0.00000   0.01193   0.00014  -0.00007  -0.00571
 1 N 3dx2-y2   0.00000  -0.00000  -0.00000   0.00000   0.00000
               #6       
  0 N 1s       0.00449
  0 N 2s       0.09823
  0 N 3s       0.17697
  0 N 2px     -0.00000
  0 N 2py     -0.00000
  0 N 2pz      0.57925
  0 N 3px     -0.00000
  0 N 3py      0.00000
  0 N 3pz      0.35815
  0 N 3dxy    -0.00000
  0 N 3dyz     0.00000
  0 N 3dz^2    0.00398
  0 N 3dxz     0.00000
 0 N 3dx2-y2   0.00000
  1 N 1s      -0.00449
  1 N 2s      -0.09823
  1 N 3s      -0.17697
  1 N 2px      0.00000
  1 N 2py      0.00000
  1 N 2pz      0.57925
  1 N 3px      0.00000
  1 N 3py      0.00000
  1 N 3pz      0.35815
  1 N 3dxy     0.00000
  1 N 3dyz    -0.00000
  1 N 3dz^2   -0.00398
  1 N 3dxz    -0.00000
 1 N 3dx2-y2  -0.00000
<CAS-nat-orb|mo-hf>  5  5    0.99930106
<CAS-nat-orb|mo-hf>  6  7    0.93741879
<CAS-nat-orb|mo-hf>  7  6    0.93741877
<CAS-nat-orb|mo-hf>  8  9    0.96479773
<CAS-nat-orb|mo-hf>  9  8    0.96479773
<CAS-nat-orb|mo-hf>  10  10    0.99954899
CASSCF energy = -108.800824783023
CASCI E = -108.800824783023  E(CI) = -9.66805646781476  S^2 = 0.0000000
Natrual Orbs
             #0      #1      #2      #3      #4      #5     
  0 N 3s                                               0.184
  0 N 2px              0.154  -0.432  -0.487  -0.139        
  0 N 2py              0.432   0.154  -0.139   0.487        
  0 N 2pz     -0.442                                   0.565
  0 N 3px              0.106  -0.295  -0.323                
  0 N 3py              0.295   0.106           0.323        
  0 N 3pz     -0.295                                   0.390
  1 N 3s                                              -0.184
  1 N 2px              0.154  -0.432   0.487   0.139        
  1 N 2py              0.432   0.154   0.139  -0.487        
  1 N 2pz      0.442                                   0.565
  1 N 3px              0.106  -0.295   0.323                
  1 N 3py              0.295   0.106          -0.323        
  1 N 3pz      0.295                                   0.390
***** CI components ******
 c**2   Gaussian-type vector
 0.406420  111000 
 0.117313  110100 
 0.117313  101010 
 0.047997  100110 
 0.040420  1abba0 
 0.040420  1baab0 
 0.025726  011001 
 0.016042  1baba0 
 0.016042  1abab0 
 0.014109  010101 
 0.014109  001011 
 0.011759  000111 
 0.010350  ba10ab 
 0.010350  ab10ba 
 0.010350  b1aa0b 
 0.010350  a1bb0a 
 c**2     ORCA-type vector
 0.406420  222000 
 0.117313  220200 
 0.117313  202020 
 0.112923  211110 
 0.047997  200220 
 0.025726  022002 
 0.020700  112011 
 0.020700  121101 
 0.014109  020202 
 0.014109  002022 
 0.011759  000222 
