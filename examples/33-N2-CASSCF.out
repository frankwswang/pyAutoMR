#INFO: **** input file is /share/home/srwang/pyAutoMR/examples/33-N2-CASSCF.py ****
from pyscf import lib
#from pyphf import util, guess
import guess, autocas, cidump

lib.num_threads(4)

xyz = 'N 0.0 0.0 0.0; N  0.0 0.0 1.9' #sys.argv[1]
#fch = 'n2.fchk' #sys.argv[2]
bas = 'cc-pvdz'

mf = guess.from_frag(xyz, bas, [[0],[1]], [0,0], [3,-3], cycle=50)
mf = guess.check_stab(mf)

mf2 = autocas.cas(mf)
cidump.dump(mf2)

#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='xn01', release='3.10.0-1127.el7.x86_64', version='#1 SMP Tue Feb 18 16:39:12 EST 2020', machine='x86_64', processor='x86_64')  Threads 4
Python 3.7.4 (default, Aug 13 2019, 20:35:49) 
[GCC 7.3.0]
numpy 1.17.2  scipy 1.4.1
Date: Sun Jul  4 21:26:50 2021
PySCF version 1.7.6a1
PySCF path  /share/home/srwang/pyscf/pyscf
GIT HEAD      ref: refs/heads/master
GIT master branch  80f71dfe77ac5f9caae26788acf76446987635bd

[CONFIG] conf_file /share/home/srwang/.pyscf_conf.py
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 14
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 N      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 N      0.000000000000   0.000000000000   1.900000000000 AA    0.000000000000   0.000000000000   3.590479636674 Bohr

nuclear repulsion = 13.6472017553053
number of shells = 10
number of NR pGTOs = 52
number of NR cGTOs = 28
basis = cc-pvdz
ecp = {}
CPU time:         1.08
**** generating fragment guess ****
fragments: [('N', [0.0, 0.0, 0.0])] [('N', [0.0, 0.0, 1.9])]
converged SCF energy = -54.3911145621998  <S^2> = 3.7540306  2S+1 = 4.0020148
converged SCF energy = -54.3911145621998  <S^2> = 3.7540306  2S+1 = 4.0020148
       na   nb
atom1   5    2
atom2   2    5


******** <class 'pyscf.scf.uhf.UHF'> ********
method = UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyAutoMR/examples/tmplgxc6xk3
max_memory 4000 MB (current use 118 MB)
number electrons alpha = 7  beta = 7
Set gradient conv threshold to 3.16228e-05
init E= -108.900143275272
  alpha nocc = 7  HOMO = -0.47646449940222  LUMO = 0.166732176142528
  beta  nocc = 7  HOMO = -0.476464499402211  LUMO = 0.166732176142526
cycle= 1 E= -108.762288631731  delta_E= 0.138  |g|= 0.0527  |ddm|= 0.373
  alpha nocc = 7  HOMO = -0.530330642057187  LUMO = 0.162348570448281
  beta  nocc = 7  HOMO = -0.530330642057185  LUMO = 0.162348570448283
cycle= 2 E= -108.765642733546  delta_E= -0.00335  |g|= 0.0253  |ddm|= 0.0587
  alpha nocc = 7  HOMO = -0.529049671912856  LUMO = 0.159261512802593
  beta  nocc = 7  HOMO = -0.52904967191286  LUMO = 0.159261512802599
cycle= 3 E= -108.767085606679  delta_E= -0.00144  |g|= 0.0126  |ddm|= 0.0548
  alpha nocc = 7  HOMO = -0.52871037283468  LUMO = 0.156378931797927
  beta  nocc = 7  HOMO = -0.528710372834678  LUMO = 0.156378931797927
cycle= 4 E= -108.767469881852  delta_E= -0.000384  |g|= 0.00324  |ddm|= 0.0393
  alpha nocc = 7  HOMO = -0.52732135312872  LUMO = 0.156905650680728
  beta  nocc = 7  HOMO = -0.527321353128721  LUMO = 0.156905650680736
cycle= 5 E= -108.767488344339  delta_E= -1.85e-05  |g|= 0.000626  |ddm|= 0.0078
  alpha nocc = 7  HOMO = -0.527670443529384  LUMO = 0.15683111066757
  beta  nocc = 7  HOMO = -0.527670443529386  LUMO = 0.156831110667574
cycle= 6 E= -108.767488867958  delta_E= -5.24e-07  |g|= 0.000143  |ddm|= 0.00108
  alpha nocc = 7  HOMO = -0.527603375860143  LUMO = 0.156896336092545
  beta  nocc = 7  HOMO = -0.527603375860141  LUMO = 0.156896336092546
cycle= 7 E= -108.767488893983  delta_E= -2.6e-08  |g|= 4.93e-05  |ddm|= 0.000239
  alpha nocc = 7  HOMO = -0.52765070515318  LUMO = 0.156872500788263
  beta  nocc = 7  HOMO = -0.527650705153182  LUMO = 0.156872500788271
cycle= 8 E= -108.767488898007  delta_E= -4.02e-09  |g|= 1.06e-05  |ddm|= 9.2e-05
  alpha nocc = 7  HOMO = -0.527658756971658  LUMO = 0.156874706934985
  beta  nocc = 7  HOMO = -0.527658756971654  LUMO = 0.156874706934988
cycle= 9 E= -108.76748889822  delta_E= -2.13e-10  |g|= 1.78e-06  |ddm|= 2.85e-05
  alpha nocc = 7  HOMO = -0.527658437248201  LUMO = 0.156874663133346
  beta  nocc = 7  HOMO = -0.527658437248201  LUMO = 0.156874663133352
Extra cycle  E= -108.767488898223  delta_E= -2.44e-12  |g|= 6.81e-07  |ddm|= 2.47e-06
converged SCF energy = -108.767488898223  <S^2> = 2.6423741  2S+1 = 3.4013963
time for guess: 0.232
**** checking UHF/UKS internal stability ...
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 2.36  e= [2.260759]  max|de|= 2.26  lindep= 0.687
davidson 1 2  |r|= 1.21  e= [1.33899]  max|de|= -0.922  lindep= 0.869
davidson 2 3  |r|= 0.349  e= [0.74339]  max|de|= -0.596  lindep= 0.993
davidson 3 4  |r|= 0.307  e= [0.60085]  max|de|= -0.143  lindep= 0.956
davidson 4 5  |r|= 0.128  e= [0.54915]  max|de|= -0.0517  lindep= 0.99
davidson 5 6  |r|= 0.0497  e= [0.54198]  max|de|= -0.00717  lindep= 0.947
davidson 6 7  |r|= 0.0323  e= [0.540371]  max|de|= -0.00161  lindep= 0.912
davidson 7 8  |r|= 0.0251  e= [0.539389]  max|de|= -0.000982  lindep= 0.947
davidson 8 9  |r|= 0.0466  e= [0.538215]  max|de|= -0.00117  lindep= 0.946
davidson 9 10  |r|= 0.0304  e= [0.536704]  max|de|= -0.00151  lindep= 0.948
davidson 10 11  |r|= 0.032  e= [0.535809]  max|de|= -0.000896  lindep= 0.941
davidson 11 12  |r|= 0.0458  e= [0.534898]  max|de|= -0.000911  lindep= 0.858
davidson 12 1  |r|= 0.0458  e= [0.534898]  max|de|= -2.22e-16  lindep= 0.998
davidson 13 2  |r|= 0.0262  e= [0.534441]  max|de|= -0.000457  lindep= 0.808
davidson 14 3  |r|= 0.0157  e= [0.534147]  max|de|= -0.000294  lindep= 0.95
davidson 15 4  |r|= 0.0157  e= [0.53393]  max|de|= -0.000217  lindep= 0.91
davidson 16 5  |r|= 0.0119  e= [0.533788]  max|de|= -0.000142  lindep= 0.924
root 0 converged  |r|= 0.00845  e= 0.5337111863526393  max|de|= -7.68e-05
converged 17 6  |r|= 0.00845  e= [0.533711]  max|de|= -7.68e-05
UHF/UKS wavefunction is stable in the internal stability analysis
UNO ON: [ 2.        2.        1.999103  1.997838  1.550306  1.174501  1.174501  0.825499  0.825499  0.449694  0.002162  0.000897  0.        0.        0.
  0.        0.        0.        0.        0.        0.       -0.       -0.       -0.       -0.       -0.       -0.       -0.      ]
nacto, nacta, nactb: 6 3 3
Converting <class 'pyscf.scf.uhf.UHF'> to RHF
UNO in active space
             #0      #1      #2      #3      #4      #5     
  0 N 3s                                               0.184
  0 N 2px              0.458                   0.505        
  0 N 2py                     -0.458  -0.505                
  0 N 2pz     -0.442                                   0.565
  0 N 3px              0.313                   0.334        
  0 N 3py                     -0.313  -0.334                
  0 N 3pz     -0.295                                   0.390
  1 N 3s                                              -0.184
  1 N 2px              0.458                  -0.505        
  1 N 2py                     -0.458   0.505                
  1 N 2pz      0.442                                   0.565
  1 N 3px              0.313                  -0.334        
  1 N 3py                     -0.313   0.334                
  1 N 3pz      0.295                                   0.390

******** <class 'pyscf.mcscf.mc1step.CASSCF'> ********
CAS (3e+3e, 6o), ncore = 4, nvir = 18
max_cycle_macro = 200
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 0
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = True
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /share/home/srwang/pyAutoMR/examples/tmplgxc6xk3
max_memory 1000 MB (current use 119 MB)
internal_rotation = False
******** <class 'pyscf.fci.direct_spin1.FCISolver'> ********
max. cycles = 100
conv_tol = 1e-08
davidson only = False
linear dependence = 1e-10
level shift = 0.001
max iter space = 12
max_memory 1000 MB
nroots = 1
pspace_size = 400
spin = 0
CASCI E = -108.799475961089  S^2 = 0.0000000
Set conv_tol_grad to 0.000316228
macro iter 1 (12 JK  4 micro), CASSCF E = -108.800824500873  dE = -0.0013485398  S^2 = 0.0000001
               |grad[o]|=0.0392  |grad[c]|= 0.0016639979777087854  |ddm|=0.0463
macro iter 2 (6 JK  2 micro), CASSCF E = -108.800824782637  dE = -2.8176403e-07  S^2 = 0.0000000
               |grad[o]|=0.000664  |grad[c]|= 1.952430924247553e-05  |ddm|=0.000258
macro iter 3 (1 JK  1 micro), CASSCF E = -108.800824782819  dE = -1.8212631e-10  S^2 = 0.0000000
               |grad[o]|=2.59e-05  |grad[c]|= 8.120035030199519e-06  |ddm|=1.85e-05
1-step CASSCF converged in 3 macro (19 JK 7 micro) steps
CASSCF canonicalization
Natural occ [1.733014 1.391519 1.391518 0.608475 0.608475 0.266999]
Natural orbital (expansion on AOs) in CAS space
               #1        #2        #3        #4        #5       
  0 N 1s      -0.00068   0.00000   0.00000  -0.00000  -0.00000
  0 N 2s      -0.00511   0.00000   0.00000  -0.00000  -0.00000
  0 N 3s       0.05371   0.00000  -0.00000   0.00000  -0.00000
  0 N 2px      0.00000   0.39622  -0.21569  -0.23985   0.45521
  0 N 2py      0.00000  -0.21569  -0.39622  -0.45521  -0.23985
  0 N 2pz     -0.43997   0.00000   0.00000   0.00000   0.00000
  0 N 3px      0.00000   0.28155  -0.15327  -0.15173   0.28797
  0 N 3py      0.00000  -0.15327  -0.28155  -0.28798  -0.15173
  0 N 3pz     -0.29468  -0.00000  -0.00000  -0.00000  -0.00000
  0 N 3dxy     0.00000   0.00000   0.00000   0.00000  -0.00000
  0 N 3dyz     0.00000  -0.00571  -0.01048  -0.00506  -0.00266
  0 N 3dz^2   -0.02028  -0.00000  -0.00000  -0.00000   0.00000
  0 N 3dxz     0.00000   0.01048  -0.00571  -0.00266   0.00506
 0 N 3dx2-y2  -0.00000  -0.00000   0.00000   0.00000   0.00000
  1 N 1s      -0.00068   0.00000  -0.00000  -0.00000   0.00000
  1 N 2s      -0.00512   0.00000  -0.00000  -0.00000   0.00000
  1 N 3s       0.05371   0.00000   0.00000   0.00000   0.00000
  1 N 2px      0.00000   0.39622  -0.21569   0.23985  -0.45521
  1 N 2py     -0.00000  -0.21569  -0.39622   0.45521   0.23985
  1 N 2pz      0.43997   0.00000   0.00000  -0.00000   0.00000
  1 N 3px     -0.00000   0.28155  -0.15327   0.15173  -0.28797
  1 N 3py     -0.00000  -0.15327  -0.28155   0.28798   0.15173
  1 N 3pz      0.29468  -0.00000  -0.00000   0.00000  -0.00000
  1 N 3dxy     0.00000  -0.00000   0.00000   0.00000  -0.00000
  1 N 3dyz     0.00000   0.00571   0.01048  -0.00506  -0.00266
  1 N 3dz^2   -0.02028  -0.00000   0.00000   0.00000  -0.00000
  1 N 3dxz     0.00000  -0.01048   0.00571  -0.00266   0.00506
 1 N 3dx2-y2   0.00000   0.00000   0.00000  -0.00000  -0.00000
               #6       
  0 N 1s       0.00450
  0 N 2s       0.09824
  0 N 3s       0.17696
  0 N 2px     -0.00000
  0 N 2py     -0.00000
  0 N 2pz      0.57925
  0 N 3px      0.00000
  0 N 3py      0.00000
  0 N 3pz      0.35815
  0 N 3dxy     0.00000
  0 N 3dyz    -0.00000
  0 N 3dz^2    0.00398
  0 N 3dxz     0.00000
 0 N 3dx2-y2   0.00000
  1 N 1s      -0.00450
  1 N 2s      -0.09824
  1 N 3s      -0.17696
  1 N 2px      0.00000
  1 N 2py     -0.00000
  1 N 2pz      0.57925
  1 N 3px     -0.00000
  1 N 3py     -0.00000
  1 N 3pz      0.35815
  1 N 3dxy     0.00000
  1 N 3dyz    -0.00000
  1 N 3dz^2   -0.00398
  1 N 3dxz     0.00000
 1 N 3dx2-y2  -0.00000
<CAS-nat-orb|mo-hf>  5  5    0.99930048
<CAS-nat-orb|mo-hf>  6  6    0.89904547
<CAS-nat-orb|mo-hf>  6  7    0.43772472
<CAS-nat-orb|mo-hf>  7  6   -0.43772473
<CAS-nat-orb|mo-hf>  7  7    0.89904547
<CAS-nat-orb|mo-hf>  8  8    0.83599165
<CAS-nat-orb|mo-hf>  8  9   -0.54861913
<CAS-nat-orb|mo-hf>  9  8    0.54861913
<CAS-nat-orb|mo-hf>  9  9    0.83599163
<CAS-nat-orb|mo-hf>  10  10    0.99954895
CASSCF energy = -108.800824782819
CASCI E = -108.800824782819  E(CI) = -9.66807552984044  S^2 = 0.0000000
Natrual Orbs
             #0      #1      #2      #3      #4      #5     
  0 N 3s                                               0.184
  0 N 2px              0.458                   0.505        
  0 N 2py                     -0.458  -0.505                
  0 N 2pz     -0.442                                   0.565
  0 N 3px              0.313                   0.334        
  0 N 3py                     -0.313  -0.334                
  0 N 3pz     -0.295                                   0.390
  1 N 3s                                              -0.184
  1 N 2px              0.458                  -0.505        
  1 N 2py                     -0.458   0.505                
  1 N 2pz      0.442                                   0.565
  1 N 3px              0.313                  -0.334        
  1 N 3py                     -0.313   0.334                
  1 N 3pz      0.295                                   0.390
***** CI components ******
 c**2   Gaussian-type vector
 0.406424  111000 
 0.117272  110100 
 0.117272  101010 
 0.047998  100110 
 0.040393  1abba0 
 0.040393  1baab0 
 0.025726  011001 
 0.016028  1baba0 
 0.016028  1abab0 
 0.014104  001011 
 0.014104  010101 
 0.011759  000111 
 0.010347  ab10ba 
 0.010347  ba10ab 
 0.010347  a1bb0a 
 0.010347  b1aa0b 
 c**2     ORCA-type vector
 0.406424  222000 
 0.117272  220200 
 0.117272  202020 
 0.112842  211110 
 0.047998  200220 
 0.025726  022002 
 0.020695  112011 
 0.020695  121101 
 0.014104  002022 
 0.014104  020202 
 0.011759  000222 
